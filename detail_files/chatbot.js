!function(){var e={748:function(e){"use strict";var t={randobet:function(e){for(var t="123456789".split(""),n="",i=0;i<e;i++)n+=t[Math.floor(Math.random()*t.length)];return n},getuid:function(e,t,n,i,o){if(void 0===o&&(o=!1),1==e||2==e&&-1==navigator.userAgent.toLowerCase().indexOf("safari"))return"";if(document.cookie){var s=this.getCookieValue(t);if(s)return s}var a=this.createFpValue();if(-1!==navigator.userAgent.toLowerCase().indexOf("safari")&&o&&(this.isiOs12(navigator.userAgent)||this.isMacOs1013(navigator.userAgent))){var r=localStorage.getItem(t);r&&(a=r)}return this.setCookie(t,a,n,i),a},setCookie:function(e,t,n,i,o){void 0===n&&(n=63072e3);var s=new Date,a=s.getTime();s.setTime(a+1e3*n),void 0===i&&(i=[]),void 0===o&&(o=!1);var r=o?"; SameSite=None; Secure":"",l=location.hostname;this.checkIPAddress(l)||l.match(/^www\./)&&(l=l.replace(/^www\./,""));for(var c=0;c<i.length;c++)if(-1!==(l+" ").indexOf(i[c]+" ")){l=i[c];break}document.cookie=e+"="+t+"; expires="+new Date(s).toUTCString()+"; path=/; domain="+l+r},updateCookieExpires:function(e,t,n,i){var o=this.getCookieValue(e);if(o){void 0===n&&(n=[]),void 0===i&&(i=!1);var s=i?"; SameSite=None; Secure":"",a=new Date,r=a.getTime();t?a.setTime(r+1e3*t):a.setTime(r+63072e6);var l=location.hostname;this.checkIPAddress(l)||l.match(/^www\./)&&(l=l.replace(/^www\./,""));for(var c=0;c<n.length;c++)if(-1!==(l+" ").indexOf(n[c]+" ")){l=n[c];break}document.cookie=e+"="+o+"; expires="+new Date(a).toUTCString()+"; path=/; domain="+l+s}},getCookieValue:function(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var i=t[n].replace(/^\s+|\s+$/g,""),o=i.indexOf("=");if(i.substring(0,o)==e)return unescape(i.slice(o+1))}return!1},createFpValue:function(){var e=new Date,t=this.randobet(4),n=e.getMonth()+1,i=e.getDate(),o=e.getHours(),s=e.getMinutes(),a=e.getSeconds();return String(e.getFullYear())+(1==String(n).length?"0":"")+String(n)+(1==String(i).length?"0":"")+String(i)+(1==String(o).length?"0":"")+String(o)+(1==String(s).length?"0":"")+String(s)+(1==String(a).length?"0":"")+String(a)+String(t)},isiOs12:function(e){var t=e.toLowerCase();if(-1===t.indexOf("ipad")&&-1===t.indexOf("iphone"))return!1;if(-1!==t.indexOf("crios")||-1!==t.indexOf("edgios")||-1!==t.indexOf("fxios"))return!1;var n=t.match(/os ([0-9_]+) like/g)[0].split(" ")[1].split("_"),i=n[0],o=n[1];return parseInt(i+"."+o)>=12},isMacOs1013:function(e){var t=e.toLowerCase();if(-1!==t.indexOf("ipad")||-1!==t.indexOf("iphone"))return!1;if(-1!==t.indexOf("firefox")||-1!==t.indexOf("chrome")||-1!==t.indexOf("edge")||-1!==t.indexOf("crios")||-1!==t.indexOf("edgios")||-1!==t.indexOf("fxios"))return!1;if(-1===t.indexOf("mac"))return!1;var n=t.match(/os x ([0-9_.]+)/g);if(!n)return!1;var i=(n=n[0].split(" ")[2]).split("_"),o=i[0],s=i[1];return parseInt(o)>=10&&parseInt(s)>=13||parseInt(o)>10}};e.exports=t},451:function(e){"use strict";e.exports=function(e,t){for(var n in t||(t={}),t)t.hasOwnProperty(n)&&(e[n]=t[n])}},606:function(e,t,n){"use strict";var i={document:void 0,activeTapEvent:!1,g:n(973),isPassiveEvent:null,checkPassiveEventListener:function(){if(null!==this.isPassiveEvent)return this.isPassiveEvent;var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});this.g.addEventListener("test",null,t)}catch(e){}return this.isPassiveEvent=e,e},addEventListener:function(e,t,n){if(this.listeners||(this.listeners=new Array),this.listeners.push({elem:e,event:t,func:n}),this.g.addEventListener&&!this.Browser.Opera){var i=!1;this.checkPassiveEventListener()&&(i={passive:!0,capture:!1}),e.addEventListener(t,n,i)}else this.g.attachEvent&&(t=this.convertEvent(t),e.attachEvent("on"+t,n))},removeEventListener:function(e){if(this.listeners)for(var t=0;t<this.listeners.length;t++){var n=this.listeners[t];if(e==n.elem){var i=n.event,o=n.func;this.g.addEventListener?(e.removeEventListener(i,o,!1),this.listeners.splice(t,1)):this.g.attachEvent&&(i=this.convertEvent(i),e.detachEvent("on"+i,o),this.listeners.splice(t,1))}}},removeAllEventListeners:function(){if(this.listeners)for(var e=0;e<this.listeners.length;e++){var t=this.listeners[e],n=t.elem,i=t.event,o=t.func;this.g.addEventListener?(n.removeEventListener(i,o,!1),this.listeners.splice(e,1)):this.g.attachEvent&&(i=this.convertEvent(i),n.detachEvent("on"+i,o),this.listeners.splice(e,1))}},convertEvent:function(e){return"DOMMouseScroll"==e&&(e="mousewheel"),e},checkIEVersion:function(e){var t=this.g.navigator.userAgent.toLowerCase(),n=this.g.navigator.appVersion.toLowerCase();return t.indexOf("msie"),-1!=n.indexOf(e)},checkBrowser:function(){var e=this.g.navigator.userAgent.toLowerCase(),t=this.g.navigator.appVersion.toLowerCase();return i.getBrowser(e,t)},getBrowser:function(e,t){var n="unknown";if(-1!==e.indexOf("msie"))n=-1!==t.indexOf("msie 6.")?"ie6":-1!==t.indexOf("msie 7.")?"ie7":-1!==t.indexOf("msie 8.")?"ie8":-1!==t.indexOf("msie 9.")?"ie9":-1!==t.indexOf("msie 10.")?"ie10":"ie";else if(-1!==e.indexOf("trident/7"))n="ie11";else if(-1!==e.indexOf("edge")||-1!==e.indexOf("edgios")||-1!==e.indexOf("edga"))n="edge";else{if(-1!==e.indexOf("android")&&-1!==e.indexOf("linux; u;")&&-1===e.indexOf("chrome"))return"browser";if(-1!==e.indexOf("android")&&-1!==e.indexOf("chrome")&&-1!==e.indexOf("version"))return"andappbrowser";-1!==e.indexOf("safari")?(n="safari",-1===e.indexOf("chrome")&&-1===e.indexOf("crios")||(n="chrome")):-1!==e.indexOf("opera")?n="opera":-1!==e.indexOf("firefox")&&(n="firefox")}return n}};i.Browser={IE:-1!==i.checkBrowser().indexOf("ie"),IE5:i.checkIEVersion("msie 5."),IE6:i.checkIEVersion("msie 6."),IE7:i.checkIEVersion("msie 7."),IE8:i.checkIEVersion("msie 8."),IE9:i.checkIEVersion("msie 9."),IE10:i.checkIEVersion("msie 10."),IE11:i.checkIEVersion("trident/7."),Edge:"edge"===i.checkBrowser(),Chrome:"chrome"===i.checkBrowser(),Opera:"opera"===i.checkBrowser(),Gecko:navigator.userAgent.indexOf("Gecko")>-1&&-1===navigator.userAgent.indexOf("KHTML"),Firefox:"firefox"===i.checkBrowser(),Safari:"safari"===i.checkBrowser(),MobileAndroid:navigator.userAgent.indexOf("Android")>-1,DefaultBrowser:"browser"===i.checkBrowser(),AndroidAppBrowser:"andappbrowser"===i.checkBrowser(),ModeStd:document.compatMode&&"BackCompat"!==document.compatMode},i.checkDesktopOs=function(){return-1!==navigator.platform.indexOf("Win")?"windows":-1!==navigator.platform.indexOf("Mac")?"Mac":"Linux"},i.indexOf=function(e,t){if(null==this)throw new TypeError;var n=Object(t),i=n.length>>>0;if(0===i)return-1;var o=0;if(arguments.length>0&&((o=Number(arguments[1]))!=o?o=0:0!=o&&o!=1/0&&o!=-1/0&&(o=(o>0||-1)*Math.floor(Math.abs(o)))),o>=i)return-1;for(var s=o>=0?o:Math.max(i-Math.abs(o),0);s<i;s++)if(s in n&&n[s]===e)return s;return-1},i.getClass=function(e){var t=e.getAttribute("class")||e.getAttribute("className");return null===t?"":t},i.hasClass=function(e,t){return-1!==(" "+this.getClass(e)+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")},i.addClass=function(e,t){var n=this.getClass(e).split(" ");for(var i in n)if(n[i]==t)return;var o=n.join(" ");e.setAttribute("class",o+" "+t)},i.removeClass=function(e,t){var n=this.getClass(e).split(" "),i=this.indexOf(t,n);if(i>=0){n.splice(i,1);var o=n.join(" ");e.setAttribute("class",o)}},i.toggleClass=function(e,t){this.hasClass(e,t)?this.removeClass(e,t):this.addClass(e,t)},i.createHttpRequest=function(){var e=null,t=null;if(this.Browser.IE8||this.Browser.IE9||this.Browser.IE10)t="jsonp";else if(this.g.XMLHttpRequest){e=new XMLHttpRequest,t="xmlHttp";try{e.withCredentials=!0}catch(e){}}else if(this.g.ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP"),t="Msxml2"}catch(n){try{e=new ActiveXObject("Microsoft.XMLHTTP"),t="MXML"}catch(e){}}return[e,t]},i.canXhr=function(){var e=new XMLHttpRequest;try{return e.withCredentials=!0,!0}catch(e){return!1}},i.sendRequest=function(e,t,n,i,o,s,a,r,l){var c=this.createHttpRequest(),d=c[0],u=c[1];if("jsonp"==u){var p=document.createElement("script");-1!=t.indexOf("?")?t+="&callback="+s+"&functionName="+a:t+="/?callback="+s+"&functionName="+a,n&&(t+="&"+n),p.setAttribute("src",t),p.type="text/javascript",p.onerror=function(e){r(l)},document.getElementsByTagName("head").item(0).appendChild(p)}else if("xDomain"!=u)d.onreadystatechange=function(e){4==d.readyState&&200==d.status?o(d):4==d.readyState&&r&&"function"==typeof r&&(0==d.status||500!=d.status&&501!=d.status&&502!=d.status&&503!=d.status&&504!=d.status&&505!=d.status&&506!=d.status&&507!=d.status&&508!=d.status&&509!=d.status&&510!=d.status||r(l))},d.open(e,t,i),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),d.send(n);else{var h=(document.location.protocol,"https://");t=t.replace(/https?:\/\//,h),d.open(e,t),n?d.send(n):d.send(),d.onload=function(){o(d)}}},i.getElementsByClassName=function(e,t,n){if(void 0===n&&(n=!0),t||(t=document),"getElementsByClassName"in t&&n)return t.getElementsByClassName(e);var i,o=new Array,s=null;s=t.all?t.all:t.getElementsByTagName("*");for(var a=0,r=0;a<s.length;a++)if(s[a].className.split){i=s[a].className.split(/\s/);for(var l=0;l<i.length;l++)i[l]==e&&(o[r]=s[a],r++)}return o},i.getWindowSize=function(){var e=null,t=null;return this.Browser.ModeStd?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):document.body&&(e=document.body.clientWidth,t=document.body.clientHeight),{width:e,height:t}},i.getScreenSize=function(){var e=screen.width,t=screen.height;if(this.Os.Android&&0!==Math.abs(this.g.orientation)){var n=e;e=t,t=n}return{width:e,height:t}},i.Os={iOs:-1!=navigator.userAgent.indexOf("iPad")||-1!=navigator.userAgent.indexOf("iPhone")||-1!=navigator.userAgent.indexOf("iPod"),Android:navigator.userAgent.indexOf("Android")>-1},i.clickOrSimilarEvent=function(e,t,n,i){"ontouchstart"in this.g&&this.tapEvent(e,t,n,i),this.clickEvent(e,t,n,i)},i.tapEvent=function(e,t,n,i){var o=this;e.dataset.tap=!1,this.addEventListener(e,"touchstart",(function(t){n&&!1===n(this,t)&&(o.checkPassiveEventListener()||t.preventDefault(),t.stopPropagation()),o.activeTapEvent=e.dataset.tap=!0})),this.addEventListener(i,"touchmove",(function(){o.activeTapEvent=e.dataset.tap=!1})),this.addEventListener(e,"touchend",(function(n){"true"==e.dataset.tap&&(e.dataset.tap=!1,!1===t(this,n)&&(o.checkPassiveEventListener()||n.preventDefault(),n.stopPropagation()))}))},i.clickEvent=function(e,t,n,i){var o=this;this.setData(e,"click",!1),this.addEventListener(e,"mousedown",(function(t){o.activeTapEvent||(n&&!1===n(this,t)&&(o.checkPassiveEventListener()||t.preventDefault(),t.stopPropagation()),o.setData(e,"click",!0))})),this.addEventListener(i,"mousemove",(function(){o.activeTapEvent||(o.setData(e,"click",!1),o.activeTapEvent=!1)})),this.addEventListener(e,"mouseup",(function(n){o.activeTapEvent?o.activeTapEvent=!1:"true"==o.getData(e,"click")&&(o.setData(e,"click",!1),!1===t(this,n)&&(o.checkPassiveEventListener()||n.preventDefault(),n.stopPropagation()))}))},i.setParentBody=function(e){return this.document=e,this.document},i.setData=function(e,t,n){if(t&&n)return e.setAttribute("data-"+t,n)},i.getData=function(e,t){if(t)return e.getAttribute("data-"+t)},i.data=function(e,t,n){return n?this.setData(e,t,n):this.getData(e,t)},e.exports=i},600:function(e){"use strict";var t={isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)},encodeHTMLForm:function(e){var t=[];for(var n in e){var i=e[n],o=encodeURIComponent(n).replace(/%20/g,"+")+"="+encodeURIComponent(i).replace(/%20/g,"+");t.push(o)}return t.join("&")},checkIPAddress:function(e){return null!==e.match(/^(([1-9]?[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([1-9]?[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/)}};e.exports=t},429:function(e,t,n){"use strict";var i=n(748),o=n(451),s=n(606),a=n(600),r={};o(r,i),o(r,a),o(r,s),e.exports=r},300:function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function e(){this.extend=n(110).X,this.JSON3=n(972),this.twitterText=n(102),this.extend(e,n(429)),this.AnalyticsTagCommon=n(429),this.Utils=n(9),this.ULAITextEncoder=n(445),this.InputBox=n(571),this.NewLineInputBox=n(337),this.Header=n(647),this.BackToBottomBtn=n(871),this.CookieBanner=n(986),this.LanguageMenu=n(291),this.LanguageHeader=n(613),this.ModalHeader=n(980),this.Menu=n(709),this.QuickSearchMenu=n(332),this.DefaultPopupIcon=n(666),this.PopupIcon=n(791),this.currentUrl=this.current("https://support-widget.userlocal.jp/chatbot.js").replace(/\/chatbot.js$/,""),this.cssTimestamp="20250611120000",this.callFunctionName=window.ULObject,this.renderedIframe=!1,this.renderWidget=!1,this.rand=e.randobet(7),this.sb=document.title,this.url=document.URL,this.ref=document.referrer,this.fp_name="__ulfpc",this.fp_period=3456e4,this.fp_domains=[],this.msg_cnt=0,this.windowSize=e.getWindowSize(),this.screenSize=e.getScreenSize(),this.mobileFlag=this.screenSize.width<=600,this.styleHideBottom=0,this.parentBodyStyle=!1,this.poweredBy={url:"https://chatbot.userlocal.jp",text:"Powered by"},this.xmlHttpRequestTimeout=30500,this.requestAnimationFrame=function(e){return(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame)(e)},this.isRequestAnimationFrame=function(){return void 0!==(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame)},this.cancelAnimationFrame=function(e){return(window.cancelAnimationFrame||window.mozcancelAnimationFrame||window.webkitcancelAnimationFrame||window.mscancelAnimationFrame)(e)},this.isCancelAnimationFrame=function(){return void 0!==(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame)},this.config={id:null,hid:null,lang:"ja",preview_widget_lang:null,no_cookie:!1,cross_domain:!1,anonymize_ip:!1,lg_id:null,user_name:null,pf:"web",mode_spa:!1,mobilePreview:!1,preview_url:"",fullscreen:!1,z_index:2147483647,widget_version:1,google_id:null,title:"",translate_status:2,translate_lang_select_message:"",translate_lang_list:[],translate_target_lang:null,translated:{},log:{talk:!0,form:!0},target_id:"ulAiWidget",color:"black",chat_bg_color:"grey",popup_open_type:"side",position:"right",hash:null,uls:!1,bot_img:{0:"",1:"",2:"",3:""},bot_icon:{circle:!1},no_viewport:!1,no_viewport_scale:2.5,auto_focus:!1,reload_btn:!1,reload_btn_icon:"home",powered_by:!1,icon_id:0,first_talk:"",first_list:"",disable_category_ids:[],enable_category_ids:[],input_bg_color:"#FFFFFF",submit_bg_color:"#26C6DA",lamp_color:"#76ff03",bot_url:"https://support-beacon.nakanohito.jp/widget/",gpt_url:"https://support-beacon.nakanohito.jp/gpt/",ws_url:"wss://supportbot-admin.userlocal.jp/cable",openY:1500,closeY:1e3,default_open:!1,display_input_box:!0,input_box_type:"text",quick_search_keywords:[],carousel_panel_size:"large",send_icon:!1,scroll_event:!1,response_time:600,site_in:!1,widget_button_size:0,close_icon:{sp_size:36,display:"×",use:!1,redisplay_flag:!0},inner:{width:"600px",height:"500px"},out:{width:"320px",height:"384px",sp_height_pct:100},formTag:{action:"https://support-widget.nakanohito.jp/error.html",method:"GET"},form:[{name:{type:"text",placeholder:"",label:{style:""}}},{email:{type:"email",required:"required",placeholder:"example@example.com"}},{message:{type:"textarea",required:"required"}}],testMode:{use:!1,before:"",after:"_test"},suggest:[],suggestConf:{displayMax:5,autoSend:!0},recommend_split:{flag:!1,num:5,message:""},maintenance:{image:!1},list_layout:{before_icon_display:!0},animation:!0,remove_space:!1,backlog:{view:!1,display_count:10,backlog_click:0,displayed_time:new Date},popup:{default_icon:!0,icon_url:!1,pc_icon_url:!1,icon:{pc:{size_custom:!1,width:100,height:100,balloon:{status:!1,message:"",position:"top"}},sp:{size_custom:!1,width:100,height:100}},pc_open_animation:!0,sp_wait_image_origin_size:!1,space:{pc:{width:"16px",height:0},sp:{width:"16px",height:"16px"}},pc_widget_space_custom:!1,pc_widget_space:{width:"20px",height:"20px"},display_delay_time:0,open_delay_flag:!1,open_delay_time:0,pc_header_height:"32px",pc_header_border_radius:"0px",message:"どのようなことにお困りでしょうか？"},operator_mode:!1,operator:{feedback_form:!0,custom_feedback_form:[],custom_feedback_form_message:null,connect_confirm:!1,connect_display_waiting:!1,header_bg_color:"#ffffff",header_text_color:"#666666",send_img_flag:!0,timeKeyInterval:1e3},error:!1,timeCheckerUserInput:1e3,openlink_newtab:!0,openlink_noreferrer:!1,chat_bot_loading:!1,chat_bot_inside_img:!1,chat_display_send_time:!1,display_cookie_consent:!1,pre_chat:{use:!1,required:!0,message:"",custom_flag:!1,custom_message:"",custom_required:!1},chat_bg_img_url:!1,confirm_text:!1,confirm_yes_text:!1,confirm_no_text:!1,gpt_mode:0,gpt_doc_mode:0,sharepoint:!1,menu_items:[],recommend_funnel_flag:!1},this.flag={init:!1,open:!1,check_open:!1,first_open:!0,check_close:!1,check_scroll_open:!1,maintenance:!1,send_maintenance:!1,use_reload_btn:!1,completed_pre_chat:!1,backlog_no_scroll:!1,carousel_slide:!1,used_cookie:!1,send_survey_log:!0,funnel_init:!1,gpt_mode:!1,gpt_doc_mode:!1,popup_modal:!1,popup_modal_opened:!1,import_marked:!1},this.stash={afterScrollTop:0,parentScroll:{x:!1,y:!1},pushEvent:[],pushBeforeEvent:[],pushAfterEvent:[],replaceText:[],imgPopupSp:{width:0,height:0},imgPopupPc:{width:0,height:0},selectedCid:null,funnelQuestion:"",operator:{ws:!1,channelId:!1,botId:!1,activeWS:!1,welcome:!1,imgSrc:!1,active:!1,reconnect:!1,connecting:!1,connectType:"connect",talk:!1,exit:!1,unread:0,titleText:!1,timeLastKeypress:0,flagTyping:!1,writingAnimation:!1,operatorCount:0,mobilePopupActiveAnnounce:!1,lastMessageId:"",lastMessageTime:0,lastVisibleTime:0,customFeedbackForm:{},waitingCntLog:null,displayWaitingInterval:0,reconnectRetryCnt:0,checkIntervalFlag:!1},gpt_doc_file_hs:[],custom_chat_id:null,children:{},popupModalParent:null,popupModalWidgetId:null,popupFullScreen:{iframeStyle:"",documentBodyStyle:"",ulWidgetStyle:""},suggest:!1,ieVersion:!1},this.text={input_placeholder:"質問を入力してください。",input_button_value:"送信",yes_text:"はい",no_text:"いいえ",form_send:"送信",exit:"終了",pre_chat_send:"チャットを開始",answer_check:"問題は解決しましたか？",maintenance:"現在メンテナンス作業中です。再開までしばらくお待ちください。",error_talk_backlog:"過去の会話ログを取得できませんでした。",error_talk_view:"現在アクセスが集中しているため、時間をおいてから再度接続してください。",error_talk_talk:"送信に失敗しました。ネットワーク接続をご確認いただくか、時間をあけて再度お試しください。",error_talk_form:"送信に失敗しました。ネットワーク接続をご確認いただくか、時間をあけて再度お試しください。",un_support_android:"お使いのブラウザはサポートされていないため、機能をご利用いただけません。",un_support_operator:"お使いのブラウザはオペレーターチャットに対応しておりません。最新のChromeブラウザをご利用ください。",un_operator_message:"現在、対応可能なオペレーターが不在のため、質問は以下のフォームに入力してください。確認次第、メールにてご連絡さしあげます。",un_operator_placeholder:"現在オペレーターが不在です",backlog:"過去の会話履歴を表示",operator_connect_confirm:"オペレーターにお繋ぎしますか？",operator_connect_button:"オペレーターに繋ぐ",operator_connect_cancel_button:"質問を続ける",operator_connect_text:"オペレーターと接続しています",operator_response_text:"オペレーターが対応中です",operator_close_text:"オペレーターが退出しました",operator_session_close_text:"セッションが切れました。<br>ページをリロードし、再接続してください。",operator_disconnect_button_text:"退出する",operator_exit_confirm:"オペレーターとのチャットを終了しますか？",operator_exit_button:"チャット終了",operator_exit_cancel_button:"キャンセル",user_close_text:"オペレーターとの会話を終了しました",operator_connect_error:"オペレーターとの接続に失敗しました。ネットワーク接続をご確認いただくか、時間をあけて再度お試しください。",operator_network_error:"接続が中断されました。<br>ネットワークを確認して再度お試しください。",operator_reconnect:"再接続",operator_feedback_message:"対応はいかがでしたか？",operator_feedback_comment_placeholder:"ご意見をお聞かせください",operator_feedback_good:"とても良い",operator_feedback_bad:"とても悪い",operator_feedback_rating_required:"いずれかの評価を選択してください",operator_cancel_chat_text:"このメッセージは送信が取り消されました",form_name_label:"名前",form_email_label:"メールアドレス",form_message_label:"質問内容",form_message_placeholder:"解決できなかった質問を入力してください。",form_select_default:"選択してください",form_checkbox_required:"いずれかの選択肢から1つ以上選択してください",form_field_required:"このフィールドを入力してください",form_email_validation:"正しいメールアドレスを入力してください",form_select_required:"リスト内の項目を選択してください",form_file_required:"ファイルを選択してください",form_select_file:"ファイルを追加",form_file_size_over:"ファイルのサイズは10MB以下にしてください",form_file_not_support_browser:"ご利用のブラウザはファイルの送信に対応していません",form_not_support_file:"対応していないファイル拡張子です",file_list_title:"質問に関連するファイル",file_preview:"プレビュー",file_gpt_doc:"生成AIに質問",tooltip_restart_button:"はじめから",tooltip_minimize_button:"最小化",tooltip_close_button:"閉じる",tooltip_attach_image_button:"画像を添付",tooltip_fullscreen_button:"全画面表示",tooltip_exit_fullscreen_button:"全画面解除",back_to_bottom:"一番下に移動",open_new_tab:"新しいウィンドウで開く",line_break_placeholder:"Shift + Enterで改行",gpt_mode:"生成AIモード",gpt_doc_mode:"生成AIモード（ファイル）",gpt_switch:"生成AIモードに切り替え",gpt_doc_switch:"生成AIモード (ファイル) に切り替え",gpt_mode_first_talk:"生成AIが回答します。",gpt_doc_mode_first_talk:"アップロードされているドキュメントの内容について生成AIが回答します。",gpt_custom_mode_first_talk:"生成AIが回答します。",gpt_doc_mode_file_first_talk:"について生成AIが回答します。",gpt_doc_mode_reference_file:"参照元",gpt_response_label:"生成AIが回答",translate_select:"言語選択",recommend_split_message:"もっと見る",funnel_question_message:"で絞り込み中",cookie_banner:"本サービスでは、サービスの利便向上のため、Cookieを利用します。サービスを利用することで、Cookieの使用に同意するものとします。"},this.customEvent={onInitialized:function(){},onChat:function(){},onPopupOpen:function(){},onPopupClose:function(){},onPopupRemove:function(){},onInitError:function(){}},this.textEncoder=null,this.v2Header=null,this.v2InputBox=null,this.v2OperatorInputBox=null,this.cookieBanner=null,this._config=this.Utils.copyObject(this.config),this._flag=this.Utils.copyObject(this.flag),this._stash=this.Utils.copyObject(this.stash),this._text=this.Utils.copyObject(this.text),this.mobilePopupSvg='<svg height="100%" style="enable-background:new 0 0 110 110;" version="1.0" viewBox="0 0 110 110" width="100%" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Artboard"/><g id="Multicolor"><circle cx="55" cy="55" r="55" style="fill:#25B7D3;"/><g><path d="M39,67c0,2.209,1.791,4,4,4h24l12,12V71h4c2.209,0,4-1.791,4-4V35c0-2.209-1.791-4-4-4H43    c-2.209,0-4,1.791-4,4V67z" style="fill:#6FDAF1;"/><path d="M71,59c0,2.209-1.791,4-4,4H43L31,75V63h-4c-2.209,0-4-1.791-4-4V27c0-2.209,1.791-4,4-4h40    c2.209,0,4,1.791,4,4V59z" style="fill:#F0F1F1;"/><path d="M70.335,24.798C69.62,23.716,68.395,23,67,23H27c-2.209,0-4,1.791-4,4v32c0,2.209,1.791,4,4,4h4    v1.134L70.335,24.798z" style="fill:#FFFFFF;"/><circle cx="35" cy="43" r="4" style="fill:#21B2D1;"/><circle cx="47" cy="43" r="4" style="fill:#21B2D1;"/><circle cx="59" cy="43" r="4" style="fill:#21B2D1;"/></g></g></svg>',this.iconHomeSvg='<svg class="home" contentScriptType="text/ecmascript" contentStyleType="text/css" height="30px" preserveAspectRatio="xMidYMid meet" version="1.0" viewBox="0 0 60.000000 60.000000" width="30px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" zoomAndPan="magnify"  stroke="#000000" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"><g><polyline fill="none" points="9.0,35.0 9.0,59.0 23.0,59.0 23.0,41.0 37.0,41.0 37.0,59.0 51.0,59.0 51.0,35.0"/><polyline fill="none" points="1.0,34.0 30.0,5.0 59.0,34.0"/><polyline fill="none" points="39.0,7.0 49.0,7.0 49.0,17.0"/></g></svg>',this.iconReloadSvg='<svg class="reload" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 45 45"><path d="M23.85 41.25Q16.7 41.25 11.65 36.2Q6.6 31.15 6.6 24Q6.6 16.85 11.65 11.775Q16.7 6.7 23.85 6.7Q28.4 6.7 31.875 8.525Q35.35 10.35 37.85 13.65V6.7H41.45V21.25H26.85V17.7H35.05Q33.1 14.9 30.35 13.175Q27.6 11.45 23.85 11.45Q18.6 11.45 14.95 15.1Q11.3 18.75 11.3 24Q11.3 29.25 14.95 32.9Q18.6 36.55 23.85 36.55Q27.75 36.55 31.075 34.3Q34.4 32.05 35.8 28.35H40.65Q39.15 34.1 34.475 37.675Q29.8 41.25 23.85 41.25Z"/></svg>',this.iconCloseSvg='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',this.iconImageSvg='<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>',this.iconFileSvg='<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20"><path d="M5.5 18q-.625 0-1.062-.438Q4 17.125 4 16.5v-13q0-.625.438-1.062Q4.875 2 5.5 2H12l4 4v10.5q0 .625-.438 1.062Q15.125 18 14.5 18ZM11 7h3.5L11 3.5Z"/></svg>',this.iconSendSvg='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" width="18px" height="18px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3.4 20.4l17.45-7.48c.81-.35.81-1.49 0-1.84L3.4 3.6c-.66-.29-1.39.2-1.39.91L2 9.12c0 .5.37.93.87.99L17 12 2.87 13.88c-.5.07-.87.5-.87 1l.01 4.61c0 .71.73 1.2 1.39.91z"/></svg>',this.iconNewTab='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M5 21q-.825 0-1.413-.587Q3 19.825 3 19V5q0-.825.587-1.413Q4.175 3 5 3h7v2H5v14h14v-7h2v7q0 .825-.587 1.413Q19.825 21 19 21Zm4.7-5.3-1.4-1.4L17.6 5H14V3h7v7h-2V6.4Z"/></svg>',this.badBtnClickSvg='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#333333" width="30px" height="30px"><path d="M24 24H0V0h24v24z" fill="none"/><path d="M22 4h-2c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h2V4zM2.17 11.12c-.11.25-.17.52-.17.8V13c0 1.1.9 2 2 2h5.5l-.92 4.65c-.05.22-.02.46.08.66.23.45.52.86.88 1.22L10 22l6.41-6.41c.38-.38.59-.89.59-1.42V6.34C17 5.05 15.95 4 14.66 4h-8.1c-.71 0-1.36.37-1.72.97l-2.67 6.15z"/></svg>',this.starOnBtnSvg='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#F5C246" width="36px" height="36px"><path d="M0 0h24v24H0z" fill="none"/><path d="M0 0h24v24H0z" fill="none"/><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>',this.starOffBtnSvg='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="36px" height="36px"><path d="M0 0h24v24H0z" fill="none"/><path d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"/></svg>',this.iconCalendarSvg='<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0z" fill="none"/><path d="M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"/></svg>',this.fileUploadIconSvg='<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><path d="M5.5 16q-.625 0-1.062-.438Q4 15.125 4 14.5V13h1.5v1.5h9V13H16v1.5q0 .625-.438 1.062Q15.125 16 14.5 16Zm3.75-3V5.875L7.062 8.062 6 7l4-4 4 4-1.062 1.062-2.188-2.187V13Z"/></svg>',this.answerFileSvg='<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M720-330q0 104-73 177T470-80q-104 0-177-73t-73-177v-370q0-75 52.5-127.5T400-880q75 0 127.5 52.5T580-700v350q0 46-32 78t-78 32q-46 0-78-32t-32-78v-370h80v370q0 13 8.5 21.5T470-320q13 0 21.5-8.5T500-350v-350q-1-42-29.5-71T400-800q-42 0-71 29t-29 71v370q-1 71 49 120.5T470-160q70 0 119-49.5T640-330v-390h80v390Z"/></svg>',this.aiSparkleSvg='<svg version="1.1" class="ai-sparkle" height="24" width="24" fill="#6495ED"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve"><g><path d="M494.696,155.436l-75.664-19.918c-24.946-6.56-44.421-26.036-50.982-50.963L348.142,8.892 C346.769,3.647,342.032,0,336.618,0c-5.424,0-10.161,3.647-11.542,8.892l-19.908,75.664c-6.56,24.927-26.036,44.402-50.982,50.963 l-75.664,19.918c-5.245,1.381-8.892,6.109-8.892,11.533c0,5.424,3.647,10.151,8.892,11.534l75.664,19.917 c24.946,6.552,44.422,26.036,50.982,50.963l19.908,75.665c1.381,5.245,6.119,8.892,11.542,8.892c5.414,0,10.151-3.647,11.524-8.892 l19.907-75.665c6.561-24.927,26.036-44.411,50.982-50.963l75.664-19.917c5.244-1.382,8.892-6.11,8.892-11.534 C503.587,161.546,499.94,156.818,494.696,155.436z"></path> <path d="M207.001,402.949l-46.226-12.163c-15.236-4.004-27.136-15.904-31.14-31.13l-12.172-46.226 c-0.837-3.215-3.723-5.432-7.041-5.432c-3.308,0-6.203,2.218-7.04,5.432l-12.163,46.226c-4.014,15.226-15.913,27.126-31.149,31.13 l-46.226,12.163c-3.196,0.846-5.432,3.741-5.432,7.049c0,3.309,2.237,6.204,5.432,7.049l46.226,12.163 c15.236,4.004,27.136,15.904,31.149,31.131l12.163,46.226c0.836,3.215,3.732,5.433,7.04,5.433c3.318,0,6.204-2.218,7.041-5.433 l12.172-46.226c4.004-15.227,15.904-27.127,31.14-31.131l46.226-12.163c3.196-0.845,5.432-3.74,5.432-7.049 C212.434,406.69,210.197,403.795,207.001,402.949z"></path></g></svg>',this.dpr=void 0!==window.devicePixelRatio?window.devicePixelRatio:0,this.lastSessionUpdateTime=(new Date).getTime(),this.params={},this.langParams={},this.originParams={},this.chatBody=this.getChatBody(),this.checkListSetAttribute="",this.animationFPS=60,this.renderFrame=30,this.version="1.0.5.1",this.sendCustomFormGptBeaconBotId=[648,1407,1992,2599,2959,3557,3631,3781,4530,4710,4741]};o.prototype.push=function(e,t){if(-1!==e[0].indexOf("."))return this.childPush(e);if("init"===e[0])return"target_id"in e[1]&&e[1].target_id&&!t?(this.stash.children[e[1].target_id]&&this.sendSurveyLog({event_type:"error",error_message:"target_id and duplicated init "+e[1].id}),this.stash.children[e[1].target_id]&&1416!=e[1].id&&1528!=e[1].id&&"40b2820915877f518740"!=e[1].id||(this.stash.children[e[1].target_id]=new o),this.stash.children[e[1].target_id].push(e,!0),!1):(this.init(e[1]),!1);if("set"===e[0]){if(e[3]&&e[3].target_id&&this.stash.children[e[3].target_id])return this.stash.children[e[3].target_id].push(e),!1;this.stash.pushEvent.push({execute:"setParam",params:e,useParam:2})}if("sendUserText"===e[0]&&this.stash.pushEvent.push({execute:"sendUserChatLog",params:e}),"sendBotText"===e[0]&&this.stash.pushEvent.push({execute:"sendBotChatLog",params:e}),"restart"===e[0]&&((!e.hasOwnProperty(1)||e[1]<0)&&(e[1]=500),this.stash.pushEvent.push({execute:"restartTalk",params:e})),"lang"===e[0]){if(e[1]&&e[1].target_id&&this.stash.children[e[1].target_id])return this.stash.children[e[1].target_id].push(e),!1;this.stash.pushEvent.push({execute:"changeTranslateLang",params:e})}if("show"===e[0]){if(e[1]&&e[1].target_id&&this.stash.children[e[1].target_id])return this.stash.children[e[1].target_id].push(e),!1;this.stash.pushBeforeEvent.push({execute:"showChatWidget",params:e})}if("hide"===e[0]){if(e[1]&&e[1].target_id&&this.stash.children[e[1].target_id])return this.stash.children[e[1].target_id].push(e),!1;this.stash.pushBeforeEvent.push({execute:"hideChatWidget",params:e})}if("event"===e[0]){if(e[3]&&e[3].target_id&&this.stash.children[e[3].target_id])return this.stash.children[e[3].target_id].push(e),!1;if("init_error"===e[1])return this.setCustomEvent(e[1],e[2]),!1;this.stash.pushBeforeEvent.push({execute:"setCustomEvent",params:e,useParam:2})}if("popup_open"===e[0]){if(e[1]&&e[1].target_id&&this.stash.children[e[1].target_id])return this.stash.children[e[1].target_id].push(e),!1;this.stash.pushAfterEvent.push({execute:"popupOpen",params:e})}if("popup_close"===e[0]){if(e[1]&&e[1].target_id&&this.stash.children[e[1].target_id])return this.stash.children[e[1].target_id].push(e),!1;this.stash.pushAfterEvent.push({execute:"popupClose",params:e})}return this.renderedIframe&&(this.runPushBeforeEvent(),this.runPushAfterEvent()),this.renderWidget&&!this.flag.maintenance?this.runPushEvent():void 0},o.prototype.childPush=function(e){var t=e[0].split(".",2),n=t[0];return e[0]=t[1],this.stash.children[n].push(e)},o.prototype.runPushBeforeEvent=function(){for(var e=[],t="",n=!1,i=0;i<this.stash.pushBeforeEvent.length;i++)t=2===(n=this.stash.pushBeforeEvent[i]).useParam?this[n.execute](n.params[1],n.params[2]):this[n.execute](n.params[1]),e.push(t);return this.stash.pushBeforeEvent=[],1===e.length?e[0]:e},o.prototype.runPushAfterEvent=function(){for(var e=[],t="",n=!1,i=0;i<this.stash.pushAfterEvent.length;i++)t=2===(n=this.stash.pushAfterEvent[i]).useParam?this[n.execute](n.params[1],n.params[2]):this[n.execute](n.params[1]),e.push(t);return this.stash.pushAfterEvent=[],1===e.length?e[0]:e},o.prototype.runPushEvent=function(){for(var e=[],t="",n=!1,i=this.stash.pushEvent.map((function(e){return e.execute})),o=0;o<this.stash.pushEvent.length;o++)t=2===(n=this.stash.pushEvent[o]).useParam?this[n.execute](n.params[1],n.params[2]):this[n.execute](n.params[1]),e.push(t);return this.stash.pushEvent=[],-1===i.indexOf("sendPreChatData")&&(1===e.length?e[0]:e)},o.prototype.getChatBody=function(){var e="",t=this.createElementSendBox();if(this.config.site_in)if(this.mobileFlag){var n="chatbot_sp_in";this.config.no_viewport&&(n="chatbot_sp_big_in"),e='<link rel="stylesheet" href="'+this.currentUrl+"/"+n+".css?t="+this.cssTimestamp+'0">',e+='<div id="_ul-widget"><div id="_ul-chat-widget-chat-log"></div>',this.config.display_input_box&&(e+=t.outerHTML),e+="</div>"}else e='<link rel="stylesheet" href="'+this.currentUrl+"/chatbot_pc_in.css?t="+this.cssTimestamp+'"><div id="_ul-widget"><div id="_ul-chat-widget-chat-log"></div>',this.config.display_input_box&&(e+=t.outerHTML),e+="</div>";else this.mobileFlag?(n="chatbot_sp",this.config.no_viewport&&(n="chatbot_sp_big"),e='<link rel="stylesheet" href="'+this.currentUrl+"/"+n+".css?t="+this.cssTimestamp+'">',e+='<div id="_ul-widget-btn" style="text-align: center;">',!this.config.popup.default_icon&&this.config.popup.icon_url?this.config.popup.sp_wait_image_origin_size?e+='<img id="_ul-img-popup-icon" src="'+this.config.popup.icon_url+'" style="height: auto; width: auto;">':e+='<img id="_ul-img-popup-icon" src="'+this.config.popup.icon_url+'" style="height: 100%; width: auto;">':e+=this.mobilePopupSvg,e+="</div>",this.config.close_icon.use&&(e+='<div id="closeBtn" class="'+(""===this.config.popup.icon_url||36!=this.config.close_icon.sp_size?"default-icon":"")+'">'+this.iconCloseSvg+"</div>"),e+='<div id="_ul-main-window" class="hidden"><div id="_ul-widget"><div id="ul-widget-header" class="ul-widget-header"><div class="ul-widget-lamp"><div></div></div><div id="_ul-widget-head-title" class="ul-widget-title"></div>',e+='<div class="ul-widget-close-btn"><svg height="100%" id="Capa_1" style="enable-background:new 0 0 306 306; fill: currentColor;" version="1.1" viewBox="0 0 306 306" width="100%" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><g id="keyboard-arrow-down"><polygon points="35.7,58.65 153,175.951 270.3,58.65 306,94.351 153,247.35 0,94.351   "/></g></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg></div>',this.config.reload_btn&&(e+='<div id="_ul-chat-restart-btn"></div>'),e+="</div>",this.config.display_input_box?e+='<div id="_ul-chat-widget">':e+='<div id="_ul-chat-widget" class="hidden-input">',e+='<div id="_ul-chat-widget-chat-log"></div>',this.config.display_input_box&&(e+=t.outerHTML),e+="</div></div></div>"):(e='<link rel="stylesheet" href="'+this.currentUrl+"/chatbot_pc.css?t="+this.cssTimestamp+'"><div id="_ul-widget"><div id="ul-widget-header" class="ul-widget-header"><div class="ul-widget-lamp"><div></div></div><div id="_ul-widget-head-title" class="ul-widget-title"></div>',!this.config.popup.pc_icon_url&&this.config.close_icon.use&&(e+='<div id="closeBtn" class="default-icon"><p>'+this.config.close_icon.display+"</p></div>"),e+='<div class="ul-widget-close-btn '+(this.config.close_icon.use?"hidden":"")+'"><div></div></div>',this.config.reload_btn&&(e+='<div id="_ul-chat-restart-btn"></div>'),e+='</div><div id="_ul-chat-widget"><div id="_ul-chat-widget-chat-log"></div>',this.config.display_input_box&&(e+=t.outerHTML),e+="</div></div>",this.config.popup.pc_icon_url&&(e+='<img id="popupIcon" src="'+this.config.popup.pc_icon_url+'"/>',this.config.close_icon.use&&(e+='<div id="closeBtn" class="use-popup-icon">'+this.iconCloseSvg+"</div>")));return e},o.prototype.createElementSendBox=function(){var e=this,t=document.createElement("div");if(t.setAttribute("id","_ul-chat-widget-chat-send"),e.config.reload_btn&&e.config.site_in){var n=document.createElement("div");n.setAttribute("id","_ul-chat-restart-btn"),t.appendChild(n)}var i=document.createElement("div");i.setAttribute("class","sendBox");var o=document.createElement("div");o.setAttribute("id","suggest"),o.style.display="none";var s=document.createElement("input");s.setAttribute("id","send"),s.setAttribute("type","text"),s.setAttribute("autocomplete","off");var a=document.createElement("input");a.setAttribute("type","text"),a.setAttribute("name","dummy1"),a.setAttribute("value",""),a.style.display="none",a.disabled=!0;var r=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("name","dummy2"),r.setAttribute("value",""),r.style.display="none",r.disabled=!0,i.appendChild(o),i.appendChild(s),i.appendChild(a),i.appendChild(r),t.appendChild(i);var l=document.createElement("div");l.setAttribute("class","submitBox");var c=document.createElement("input");return e.config.send_icon&&(c=document.createElement("button")).appendChild(e.html2dom(e.iconSendSvg)),c.setAttribute("id","submit"),c.setAttribute("type","button"),c.setAttribute("value",e.text.input_button_value),l.appendChild(c),t.appendChild(l),t},o.prototype.setCssStyle=function(e,t){this.customStyle||(this.customStyle=document.createElement("style"),this.customStyle.setAttribute("type","text/css"),this.elementIframe.contentWindow.document.getElementsByTagName("head").item(0).appendChild(this.customStyle));try{this.customStyle.sheet.insertRule(e+"{"+t+"}",0)}catch(e){}},o.prototype.init=function(e){if(!(this.flag.init||o.Browser.IE5||o.Browser.IE6||o.Browser.IE7||o.Browser.IE8||o.Browser.IE9)){var t=Date.now();if(void 0===this.checkInitTime&&(this.checkInitTime=t,this.checkInitCount=0),t-this.checkInitTime>1e4&&(this.checkInitTime=t,this.checkInitCount=0),this.checkInitCount++,this.checkInitCount>10)this.checkInitTime=t;else{this.originParams=this.Utils.copyObject(e),this.lastSessionUpdateTime=(new Date).getTime(),(o.Browser.IE10||o.Browser.IE11)&&(this.stash.ieVersion=o.checkBrowser());var n=this;this.flag.init=!0,"sharepoint"in e&&this.isTrue(e.sharepoint)&&(e.mode_spa=!0,"site_in"in e&&this.isTrue(e.site_in)&&(e.fullscreen=!0,"popup_modal"in e&&this.isTrue(e.popup_modal)&&(e.fullscreen=!1))),"mode_spa"in e&&this.isTrue(e.mode_spa)&&(this.config=this.Utils.copyObject(this._config),this.flag=this.Utils.copyObject(this._flag),this.stash=this.Utils.copyObject(this._stash),this.text=this.Utils.copyObject(this._text),this.config.mode_spa=!0,this.sb=document.title,this.url=document.URL,this.ref=document.referrer,this.elementIframe&&(this.removeMe(this.elementIframe),this.customStyle=!1),"sharepoint"in e&&this.isTrue(e.sharepoint)&&(this.config.sharepoint=!0,"site_in"in e&&this.isTrue(e.site_in)&&(this.url=window.parent.document.URL,this.ref=window.parent.document.referrer))),this.config.id=e.id,"site_in"in e&&(this.config.site_in=e.site_in,this.config.suggestConf.displayMax=10),"hash"in e&&e.hash&&(this.config.hash=e.hash),-1!=this.currentUrl.indexOf(".userlocal.jp")&&(this.config.bot_url="https://support-beacon.userlocal.jp/widget/",this.config.gpt_url="https://support-beacon.userlocal.jp/gpt/"),"host"in e&&e.host&&(this.config.bot_url="https://"+e.host+"/widget/",this.config.gpt_url="https://"+e.host+"/gpt/","secure"in e&&!e.secure&&(this.config.bot_url="http://"+e.host+"/widget/",this.config.gpt_url="http://"+e.host+"/gpt/")),"ph"in e&&e.ph&&1477===e.id&&(this.config.bot_url="https://"+e.ph+"/support-beacon.nakanohito.jp/widget/",this.config.gpt_url="https://"+e.ph+"/support-beacon.nakanohito.jp/gpt/","secure"in e&&!e.secure&&(this.config.bot_url="http://"+e.ph+"/support-beacon.nakanohito.jp/widget/",this.config.gpt_url="http://"+e.ph+"/support-beacon.nakanohito.jp/gpt/")),"ws_cable_url"in e&&e.ws_cable_url&&(this.config.ws_url=e.ws_cable_url),"uls"in e&&e.uls&&(this.config.uls=e.uls),("no_cookie"in e&&this.isTrue(e.no_cookie)||this.Utils.checkTimezone(0,180))&&(this.config.no_cookie=!0),"cross_domain"in e&&this.isTrue(e.cross_domain)&&(this.config.cross_domain=!0),"anonymize_ip"in e&&e.anonymize_ip&&(this.config.anonymize_ip=e.anonymize_ip),"lg_id"in e&&e.lg_id&&(this.config.lg_id=e.lg_id),"user_name"in e&&e.user_name&&(this.config.user_name=e.user_name),"pf"in e&&e.pf&&(this.config.pf=e.pf),"mobile_preview"in e&&this.isTrue(e.mobile_preview)&&(this.config.mobilePreview=!0,this.mobileFlag=!0),"preview_url"in e&&e.preview_url&&(this.config.preview_url=e.preview_url),"fullscreen"in e&&this.isTrue(e.fullscreen)&&(this.config.fullscreen=!0),"z_index"in e&&parseInt(e.z_index)&&parseInt(e.z_index)<=2147483647&&(this.config.z_index=parseInt(e.z_index)),"disable_cids"in e&&e.disable_cids&&(this.config.disable_category_ids=e.disable_cids),"cids"in e&&e.cids&&(this.config.enable_category_ids=e.cids),"preview_widget_lang"in e&&e.preview_widget_lang&&(this.config.preview_widget_lang=e.preview_widget_lang),"lang"in e&&e.lang&&(this.config.translate_target_lang=e.lang,delete e.lang),e.hasOwnProperty("target_id")&&(this.config.target_id=e.target_id),this.fp=o.getCookieValue(this.fp_name),this.fp?this.url.indexOf("/web_chats/preview")>-1&&this.ref.indexOf("/web_chats/custom")>-1?this.flag.used_cookie=!1:this.flag.used_cookie=!0:this.fp=o.createFpValue(),-1!==navigator.userAgent.toLowerCase().indexOf("safari")&&this.config.uls&&(o.isiOs12(navigator.userAgent)||o.isMacOs1013(navigator.userAgent))&&localStorage.setItem(this.fp_name,this.fp),this.sessionId=o.getCookieValue("__ulfps")||this.getRandomStr(16),this.sendViewLog((function(t){if("error"!=t.responseText&&""!=t.responseText){var i=n.JSON3.parse(t.responseText),s=i.confs,a=i.hasOwnProperty("lang")?i.lang:"",r=i.user;if((s=n.overwriteViewParams(s,e)).testMode)if(e.hasOwnProperty("priorityParams")&&e.priorityParams){for(var l in e)e.hasOwnProperty(l)&&"id"!=l&&(s[l]=e[l]);e=s}else n.extend(e,s);else n.extend(e,s);if(n.paramInit(e,a),n.params=e,n.langParams=a,1477===e.id&&e.ph&&(n.config.bot_img[0]=n.currentUrl+"/img/1477/main_bot_img.png",n.config.popup.icon_url=n.currentUrl+"/img/1477/popup_icon.png",n.config.popup.pc_icon_url=n.currentUrl+"/img/1477/pc_popup_icon.png"),1819!==e.id||n.config.site_in||(n.config.pre_chat.use=!1,n.config.pre_chat.custom_flag=!1),n.config.site_in||n.config.close_icon.redisplay_flag||!o.getCookieValue("__ulcb_closed_at_"+n.config.hid))if(n.textEncoder=new n.ULAITextEncoder({openLinkNewTab:n.config.openlink_newtab,openLinkNoReferrer:n.config.openlink_noreferrer,mobileFlag:n.mobileFlag,browserChrome:o.Browser.Chrome}),2!=n.config.widget_version){if(o.Browser.DefaultBrowser&&(n.config.display_input_box=!1,n.config.powered_by=!1),n.chatBody=n.getChatBody(),o.Browser.DefaultBrowser){if(!n.config.site_in)return;n.config.animation=!1,n.params.first_talk=n.text.un_support_android,n.params.hasOwnProperty("response_message_no")&&""!==n.params.response_message_no&&(n.params.first_talk=n.params.response_message_no),n.params.suggest=[],n.params.first_list="",n.config.remove_space=!0,n.params.maintenance=!1}if(n.config.id){"maintenance"in n.params&&n.params.maintenance.status&&(n.flag.maintenance=!!n.params.maintenance.status,"message"in n.params.maintenance&&n.params.maintenance.message&&(n.text.maintenance=n.params.maintenance.message),"image"in n.params.maintenance&&n.params.maintenance.image&&!n.params.maintenance.image&&(n.config.maintenance.image=n.params.maintenance.image));var c=n.config.site_in?0:n.config.popup.display_delay_time;setTimeout((function(){var t=n.elementIframe=document.createElement("iframe");if(t.scrolling="no",t.frameBorder=0,t.marginWidth=0,t.marginHeight=0,t.title="AI Chat Support",o.addClass(t,"ul-widget-main-window"),n.renderedIframe=!0,n.runPushBeforeEvent(),!n.insertWidgetForPage())return!1;var i=t.contentWindow.document;i.open(),i.write(n.chatBody),i.close(),n.elementChatLog=i.getElementById("_ul-chat-widget-chat-log"),"windows"!==o.checkDesktopOs()||o.Browser.IE||o.Browser.Firefox||o.addClass(n.elementChatLog,"windows-scrollbar");var s,a=n.setCssStyle.bind(n);n.config.site_in?(n.mobileFlag?(o.Browser.Safari&&n.config.display_input_box&&(o.addClass(i.getElementById("send"),"apple-style"),o.addClass(i.getElementById("submit"),"apple-style")),(s=document.createElement("meta")).setAttribute("name","viewport"),s.setAttribute("content","width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"),i.getElementsByTagName("head").item(0).appendChild(s)):450<=t.width&&t.width<600?o.addClass(n.elementChatLog,"portrait-md"):t.width<450&&o.addClass(n.elementChatLog,"portrait-sm"),e.chat_bg_color&&n.isColor(e.chat_bg_color)&&(n.elementChatLog.style.background=e.chat_bg_color)):(n.mobileFlag&&((s=document.createElement("meta")).setAttribute("name","viewport"),s.setAttribute("content","width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"),i.getElementsByTagName("head").item(0).appendChild(s),o.addClass(t,"mobile-layout"),0==n.config.widget_button_size&&(n.config.widget_button_size=parseInt(.16*n.windowSize.width)),t.style.width=n.config.widget_button_size+"px",t.style.height=n.config.widget_button_size+"px",a("#_ul-widget-btn","line-height: "+n.config.widget_button_size+"px; font-size: "+n.config.widget_button_size+"px;"),a("#_ul-widget-btn i","line-height: "+n.config.widget_button_size+"px;"),o.Browser.Safari&&n.config.display_input_box&&(o.addClass(i.getElementById("send"),"apple-style"),o.addClass(i.getElementById("submit"),"apple-style"))),n.setWidgetWindowColor(e));n.config.chat_bg_img_url&&(a("#_ul-chat-widget-chat-log",'background-image: url("'+n.config.chat_bg_img_url+'") !important'),a("#_ul-chat-widget-chat-log","background-repeat: repeat !important"));var l=n.config.no_viewport?n.config.no_viewport_scale:1;if(n.config.site_in)if(n.mobileFlag){if("sp_in_font_size"in e&&n.isFontSize(e.sp_in_font_size)){var c=parseInt(e.sp_in_font_size)*l+"px";a("body","font-size: "+c),a("#_ul-chat-widget-chat-log .chat-log table","font-size: "+c),a("input[type=text]#send","font-size:"+c),a("input[type=text]#send:focus","font-size:"+c),a("input[type=button]","font-size:"+c),a("#suggest","font-size:"+c)}if("sp_in_button_font_size"in e&&n.isFontSize(e.sp_in_button_font_size)&&a("input[type=button]","font-size:"+parseInt(e.sp_in_button_font_size)*l+"px"),"sp_in_input_font_size"in e&&n.isFontSize(e.sp_in_input_font_size)){var d=parseInt(e.sp_in_input_font_size)*l+"px";a("input[type=text]#send","font-size:"+d),a("input[type=text]#send:focus","font-size:"+d)}"sp_in_suggest_font_size"in e&&n.isFontSize(e.sp_in_suggest_font_size)&&a("#suggest","font-size:"+parseInt(e.sp_in_suggest_font_size)*l+"px")}else{if("pc_in_font_size"in e&&n.isFontSize(e.pc_in_font_size)){var u=parseInt(e.pc_in_font_size)*l+"px";a("body","font-size: "+u),a("#_ul-chat-widget-chat-log .chat-log table","font-size: "+u),a("input[type=text]#send","font-size:"+u),a("input[type=text]#send:focus","font-size:"+u),a("input[type=button]","font-size:"+u),a("#suggest","font-size:"+u)}if("pc_in_button_font_size"in e&&n.isFontSize(e.pc_in_button_font_size)&&a("input[type=button]","font-size:"+parseInt(e.pc_in_button_font_size)*l+"px"),"pc_in_input_font_size"in e&&n.isFontSize(e.pc_in_input_font_size)){var p=parseInt(e.pc_in_input_font_size)*l+"px";a("input[type=text]#send","font-size:"+p),a("input[type=text]#send:focus","font-size:"+p)}"pc_in_suggest_font_size"in e&&n.isFontSize(e.pc_in_suggest_font_size)&&a("#suggest","font-size:"+parseInt(e.pc_in_suggest_font_size)*l+"px")}else if(n.mobileFlag){if("sp_font_size"in e&&n.isFontSize(e.sp_font_size)){var h=parseInt(e.sp_font_size)*l+"px";a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-log","font-size: "+h),a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-log table","font-size: "+h),a("#_ul-chat-widget input[type=text]#send","font-size:"+h),a("#_ul-chat-widget input[type=text]#send:focus","font-size:"+h),a("#_ul-chat-widget input[type=button]","font-size:"+h),a("#suggest","font-size:"+h)}if("sp_input_font_size"in e&&n.isFontSize(e.sp_input_font_size)){var g=parseInt(e.sp_input_font_size)*l+"px";a("#_ul-chat-widget input[type=text]#send","font-size:"+g),a("#_ul-chat-widget input[type=text]#send:focus","font-size:"+g)}"sp_button_font_size"in e&&n.isFontSize(e.sp_button_font_size)&&a("#_ul-chat-widget input[type=button]","font-size:"+parseInt(e.sp_button_font_size)*l+"px"),"sp_suggest_font_size"in e&&n.isFontSize(e.sp_suggest_font_size)&&a("#suggest","font-size:"+parseInt(e.sp_suggest_font_size)*l+"px")}else{if("pc_font_size"in e&&n.isFontSize(e.pc_font_size)){var m=parseInt(e.pc_font_size)*l+"px";a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-log","font-size: "+m),a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-log table","font-size: "+m),a("#_ul-chat-widget input[type=text]#send","font-size:"+m),a("#_ul-chat-widget input[type=text]#send:focus","font-size:"+m),a("#_ul-chat-widget input[type=button]","font-size:"+m),a("#suggest","font-size:"+m)}if("pc_input_font_size"in e&&n.isFontSize(e.pc_input_font_size)){var _=parseInt(e.pc_input_font_size)*l+"px";a("#_ul-chat-widget input[type=text]#send","font-size:"+_),a("#_ul-chat-widget input[type=text]#send:focus","font-size:"+_)}"pc_button_font_size"in e&&n.isFontSize(e.pc_button_font_size)&&a("#_ul-chat-widget input[type=button]","font-size:"+parseInt(e.pc_button_font_size)*l+"px"),"pc_suggest_font_size"in e&&n.isFontSize(e.pc_suggest_font_size)&&a("#suggest","font-size:"+parseInt(e.pc_suggest_font_size)*l+"px")}if("chat_font_family"in e&&n.isFontFamily(e.chat_font_family))a("body","font-family: "+e.chat_font_family),a("button, input, select, textarea","font-family:"+e.chat_font_family);else{var f=e.chat_font_family_win||"meiryo",y=e.chat_font_family_mac||"HiraginoKakuGothicProN",v=n.createFontFamilySetting(f,y);a("body","font-family:"+v),a("button, input, select, textarea","font-family:"+v)}e.chat_bot_bg_color&&n.isColor(e.chat_bot_bg_color)&&(a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot:before","border-color: transparent "+e.chat_bot_bg_color+" transparent transparent;"),a("#_ul-chat-widget-chat-log .chat-bot:before","border-color: transparent "+e.chat_bot_bg_color+" transparent transparent;")),e.chat_user_bg_color&&n.isColor(e.chat_user_bg_color)&&(a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-user:before","border-color: transparent transparent transparent "+e.chat_user_bg_color+";"),a("#_ul-chat-widget-chat-log .chat-user:before","border-color: transparent transparent transparent "+e.chat_user_bg_color+";")),e.send_bg_color&&n.isColor(e.send_bg_color)&&(n.config.submit_bg_color=e.send_bg_color,a("#submit","background: "+e.send_bg_color+" !important")),e.send_bg_active_color&&n.isColor(e.send_bg_active_color)&&a("#submit:active","background: "+e.send_bg_active_color+" !important"),e.send_bg_focus_color&&n.isColor(e.send_bg_focus_color)&&a("#submit:focus","background: "+e.send_bg_focus_color+" !important");var b=i.getElementById("submit");if(e.send_text_color&&n.isColor(e.send_text_color)&&n.config.display_input_box&&(b.style.color=e.send_text_color,n.config.send_icon&&(b.firstElementChild.style.fill=e.send_text_color)),e.chat_list_bg_color&&n.isColor(e.chat_list_bg_color)&&a(".chat-log > ul li","background: "+e.chat_list_bg_color+" !important"),e.chat_list_hover_bg_color&&n.isColor(e.chat_list_hover_bg_color)&&a(".chat-log > ul li:hover","background: "+e.chat_list_hover_bg_color+" !important"),e.chat_list_active_bg_color&&n.isColor(e.chat_list_active_bg_color)&&a(".chat-log > ul li:active","background: "+e.chat_list_active_bg_color+" !important"),e.chat_list_checkbox_text_color&&n.isColor(e.chat_list_checkbox_text_color)&&a(".chat-log > ul li .check-box","color: "+e.chat_list_checkbox_text_color+" !important"),e.chat_list_text_color&&n.isColor(e.chat_list_text_color)&&a(".chat-log > ul li .text","color: "+e.chat_list_text_color+" !important"),e.endcheck_hr_color&&n.isColor(e.endcheck_hr_color)&&(a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot hr","border-top: 1px solid "+e.endcheck_hr_color+";"),a("#_ul-chat-widget-chat-log .chat-bot hr","border-top: 1px solid "+e.endcheck_hr_color+";")),e.endcheck_no_btn_bg_color&&n.isColor(e.endcheck_no_btn_bg_color)&&(a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li","background: "+e.endcheck_no_btn_bg_color+";"),a("#_ul-chat-widget-chat-log .chat-bot .end-question ul li","background: "+e.endcheck_no_btn_bg_color+";")),e.endcheck_no_btn_hover_bg_color&&n.isColor(e.endcheck_no_btn_hover_bg_color)&&(a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li:hover","background: "+e.endcheck_no_btn_hover_bg_color+";"),a("#_ul-chat-widget-chat-log .chat-bot .end-question ul li:hover","background: "+e.endcheck_no_btn_hover_bg_color+";")),e.endcheck_no_btn_active_bg_color&&n.isColor(e.endcheck_no_btn_active_bg_color)&&(a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li:active","background: "+e.endcheck_no_btn_active_bg_color+";"),a("#_ul-chat-widget-chat-log .chat-bot .end-question ul li:active","background: "+e.endcheck_no_btn_active_bg_color+";")),e.endcheck_yes_btn_bg_color&&n.isColor(e.endcheck_yes_btn_bg_color)&&(a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li.success","background: "+e.endcheck_yes_btn_bg_color+";"),a("#_ul-chat-widget-chat-log .chat-bot .end-question ul li.success","background: "+e.endcheck_yes_btn_bg_color+";")),e.endcheck_yes_btn_hover_bg_color&&n.isColor(e.endcheck_yes_btn_hover_bg_color)&&(a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li.success:hover","background: "+e.endcheck_yes_btn_hover_bg_color+";"),a("#_ul-chat-widget-chat-log .chat-bot .end-question ul li.success:hover","background: "+e.endcheck_yes_btn_hover_bg_color+";")),e.endcheck_yes_btn_text_color&&n.isColor(e.endcheck_yes_btn_text_color)&&(a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li.success span.text","color: "+e.endcheck_yes_btn_text_color),a("#_ul-chat-widget-chat-log .chat-bot .end-question ul li.success span.text","color: "+e.endcheck_yes_btn_text_color)),e.endcheck_no_btn_text_color&&n.isColor(e.endcheck_no_btn_text_color)&&(a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li span.text","color: "+e.endcheck_no_btn_text_color),a("#_ul-chat-widget-chat-log .chat-bot .end-question ul li span.text","color: "+e.endcheck_no_btn_text_color)),e.endcheck_yes_btn_active_bg_color&&n.isColor(e.endcheck_yes_btn_active_bg_color)&&(a("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li.success:active","background: "+e.endcheck_yes_btn_active_bg_color+";"),a("#_ul-chat-widget-chat-log .chat-bot .end-question ul li.success:active","background: "+e.endcheck_yes_btn_active_bg_color+";")),"bot_icon_border_color"in e&&n.isColor(e.bot_icon_border_color)&&a("#_ul-widget ._ul-chat-chip > img","border-color: "+e.bot_icon_border_color),"bot_icon_border_width"in e&&n.isSize(e.bot_icon_border_width)&&a("#_ul-widget ._ul-chat-chip > img","border-width: "+e.bot_icon_border_width),"chat_list_underline"in e&&n.isFalse(e.chat_list_underline)&&(a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li span.text","text-decoration: none;"),a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li span.text","text-decoration: none !important;"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li span.text","text-decoration: none;")),"chat_list_border_radius"in e&&n.isSize(e.chat_list_border_radius)&&(a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li","border-radius: "+e.chat_list_border_radius+";"),a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li","border-radius: "+e.chat_list_border_radius+";"),a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li div","border-radius: "+e.chat_list_border_radius+" "+e.chat_list_border_radius+" 0 0;")),"chat_list_border_color"in e&&n.isColor(e.chat_list_border_color)&&(a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li","border-color: "+e.chat_list_border_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li","border-color: "+e.chat_list_border_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li div","border-color: "+e.chat_list_border_color+";")),"chat_list_border_width"in e&&n.isSize(e.chat_list_border_width)&&(a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li","border-width: "+e.chat_list_border_width+";"),a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li","border-width: "+e.chat_list_border_width+";")),"chat_list_padding"in e&&n.isSize(e.chat_list_padding)&&a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li","padding: "+e.chat_list_padding+";"),"chat_list_icon_color"in e&&n.isColor(e.chat_list_icon_color)&&a("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li span.list-layout-before","border-color: transparent transparent transparent "+e.chat_list_icon_color+";"),"form_bg_color"in e&&n.isColor(e.form_bg_color)&&a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form","background: "+e.form_bg_color+";"),"form_q_text_color"in e&&n.isColor(e.form_q_text_color)&&(a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form label","color: "+e.form_q_text_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form .file-upload-size-note","color: "+e.form_q_text_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form .file-upload-size-note","opacity: 0.7;")),"form_a_bg_color"in e&&n.isColor(e.form_a_bg_color)&&(a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input","background: "+e.form_a_bg_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form textarea","background: "+e.form_a_bg_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form select","background: "+e.form_a_bg_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form .file-upload-button","background: "+e.form_a_bg_color+";")),"form_a_text_color"in e&&n.isColor(e.form_a_text_color)&&(a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input","color: "+e.form_a_text_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form textarea","color: "+e.form_a_text_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form select","color: "+e.form_a_text_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form .file-upload-button svg","fill: "+e.form_a_text_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form .file-upload-button span","color: "+e.form_a_text_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form svg.calendar-icon","fill: "+e.form_a_text_color+";")),"form_a_placeholder_color"in e&&n.isColor(e.form_a_placeholder_color)&&(a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input::placeholder","color: "+e.form_a_placeholder_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input:-ms-input-placeholder","color: "+e.form_a_placeholder_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input::-ms-input-placeholder","color: "+e.form_a_placeholder_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form textarea::placeholder","color: "+e.form_a_placeholder_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form textarea:-ms-input-placeholder","color: "+e.form_a_placeholder_color+";"),a("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form textarea::-ms-input-placeholder","color: "+e.form_a_placeholder_color+";")),"form_send_bg_color"in e&&n.isColor(e.form_send_bg_color)&&a('#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input[type="submit"]',"background: "+e.form_send_bg_color+"!important;"),"form_send_text_color"in e&&n.isColor(e.form_send_text_color)&&a('#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input[type="submit"]',"color: "+e.form_send_text_color+"!important;"),n.config.display_input_box){var x=i.getElementById("send");e.input_bg_color&&n.isColor(e.input_bg_color)&&(n.config.input_bg_color=x.style.background=e.input_bg_color),e.input_text_color&&n.isColor(e.input_text_color)&&(x.style.color=e.input_text_color,a("#_ul-chat-widget #send:placeholder-shown","color: "+e.input_text_color+"b3;"),a("#_ul-chat-widget #send::placeholder","color: "+e.input_text_color+"b3;"),a("#_ul-chat-widget #send:-ms-input-placeholder","color: "+e.input_text_color+"b3;"),a("#_ul-chat-widget #send::-ms-input-placeholder","color: "+e.input_text_color+"b3;"),a("#send:placeholder-shown","color: "+e.input_text_color+"b3;"),a("#send::placeholder","color: "+e.input_text_color+"b3;"),a("#send:-ms-input-placeholder","color: "+e.input_text_color+"b3;"),a("#send::-ms-input-placeholder","color: "+e.input_text_color+"b3;")),e.input_border_color&&n.isColor(e.input_border_color)&&(x.style.borderColor=e.input_border_color),e.send_box_color&&n.isColor(e.send_box_color)&&(i.getElementById("_ul-chat-widget-chat-send").style.background=e.send_box_color),n.config.powered_by&&e.send_box_color&&n.isColor(e.send_box_color)&&(i.getElementById("_ul-chat-widget-chat-send").style.background=e.send_box_color)}else n.config.powered_by&&n.config.site_in&&((B=i.createElement("div")).id="_ul-chat-widget-chat-send",i.getElementById("_ul-widget").appendChild(B),e.send_box_color&&n.isColor(e.send_box_color)&&(i.getElementById("_ul-chat-widget-chat-send").style.background=e.send_box_color));if(n.setChatlogBalloonWidth(),n.config.site_in){n.flag.open=!0,n.mobileFlag||o.Browser.IE10&&n.config.display_input_box&&(D=i.getElementById("_ul-chat-widget-chat-send").clientWidth-16,i.getElementsByClassName("sendBox")[0].style.width=parseInt(.8*D)+"px",i.getElementsByClassName("submitBox")[0].style.width=parseInt(.2*D)+"px",i.getElementById("submit").style.width=parseInt(.2*D)-8+"px");var w=parseInt(t.height),C=parseInt(t.width),k=parseInt("40px");if(n.elementChatLog.style.height=w-2+"px",n.config.display_input_box){var I=10;n.config.no_viewport&&(k=40,k*=n.config.no_viewport_scale,I=7*n.config.no_viewport_scale),n.elementChatLog.style.height=w-k-2+"px",i.getElementById("_ul-chat-widget-chat-send").style.width=C-I+"px"}if(n.config.powered_by){if(n.config.display_input_box)o.addClass(i.getElementById("_ul-chat-widget-chat-send"),"powered-by");else var B=i.getElementById("_ul-chat-widget-chat-send");var E=i.createElement("a");n.mobileFlag?n.elementChatLog.style.height=parseInt(n.elementChatLog.style.height)-24+"px":(n.elementChatLog.style.height=parseInt(n.elementChatLog.style.height)-28+"px",E.href=n.poweredBy.url,E.target="_blank");var S=i.createElement("p"),T=i.createTextNode(n.poweredBy.text);(N=i.createElement("img")).src=n.currentUrl+"/img/logo_black_176.png",n.config.site_in&&!n.mobileFlag&&(N.src=n.currentUrl+"/img/logo_black.png"),N.alt="UserLocal",S.appendChild(T),E.appendChild(S),E.appendChild(N),n.config.display_input_box?i.getElementById("_ul-chat-widget-chat-send").insertBefore(E,n.elementChatLog.firstChild):(B.style.width=C-10+"px",B.appendChild(E),o.addClass(i.getElementById("_ul-chat-widget-chat-send"),"powered-by"),o.addClass(i.getElementById("_ul-chat-widget-chat-send"),"non-text-box"))}(Q=i.getElementById("_ul-chat-restart-btn"))&&n.appendElementTooltip(Q,n.text.tooltip_restart_button,"top","tooltipRestartButton")}if(!n.config.site_in){var L=n.elementIframe.style;if(L.setProperty("margin","0"),L.setProperty("max-width","100%"),L.position="fixed",n.mobileFlag){n.styleHideBottom=parseInt(n.config.popup.space.sp.height);var P=o.Browser;if(o.Os.Android&&P.DefaultBrowser&&(n.styleHideBottom+=40),L.right=n.config.popup.space.sp.width,"left"==n.config.position&&(L.right="",L.left=n.config.popup.space.sp.width),L.bottom=n.styleHideBottom+"px",n.config.close_icon.use){var A=i.getElementById("_ul-widget-btn");(K=i.getElementById("closeBtn")).style.setProperty("position","absolute"),K.style.setProperty("top","0"),n.getRect(K);var F=n.getRect(A),M=4;n.config.popup.icon_url&&(M=16),L.width=F.width+M+"px",L.height=F.height+M+"px",n.stash.imgPopupSp.width=F.width,n.stash.imgPopupSp.height=F.height,A.style.setProperty("position","absolute"),A.style.setProperty("height",F.height),A.style.setProperty("width",F.width),A.style.setProperty("bottom","0"),o.Os.iOs&&a("#closeBtn > p","line-height: 90%;");var O=28;n.config.popup.icon_url&&(O=F.height/2),K.style.setProperty("bottom",parseInt(L.height)-O+"px")}o.addClass(t,"ul-widget-hide")}else{L.right=n.config.popup.space.pc.width,"left"==n.config.position&&(L.right="",L.left=n.config.popup.space.pc.width),L.cursor="pointer",L.width=n.config.out.width,L.height=n.config.out.height,n.config.popup.pc_icon_url?L.bottom=n.config.popup.space.pc.height:L.bottom=0,L.boxShadow="0 1px 1px 0 rgba(0, 0, 0, 0.20)";var H=i.getElementById("_ul-widget"),z=i.getElementById("ul-widget-header"),R=i.getElementById("_ul-chat-widget");H.style.height=i.body.style.height=L.height,H.style.width=i.body.style.width=L.width;var W=parseInt(H.style.width)-2,U=parseInt(n.config.popup.pc_header_height);R.style.setProperty("width",W+"px"),z.style.setProperty("width",W+"px"),z.style.setProperty("height",U+"px"),w=parseInt(L.height),C=parseInt(L.width);var q=parseInt("40px");n.config.display_input_box?(n.elementChatLog.style.height=w-q-U+"px",i.getElementById("_ul-chat-widget-chat-send").style.width=C-10+"px"):n.elementChatLog.style.height=w-U+"px";var D,N,j=parseInt(n.config.popup.pc_header_border_radius);if(t.style.setProperty("border-radius",j+"px "+j+"px 0 0"),z.style.setProperty("padding","0 "+j/2+"px"),i.getElementById("_ul-widget-head-title").style.setProperty("width",198-j+"px"),R.style.height=parseInt(n.elementChatLog.style.height)+16+"px",!o.Browser.IE){H=i.getElementById("_ul-widget"),R=i.getElementById("_ul-chat-widget");var V=n.config.powered_by?26:0;t.style.setProperty("max-height","100%"),i.body.style.maxHeight="100%",H.style.maxHeight="100%",R.style.setProperty("height","100%"),R.style.setProperty("max-height","calc(100% - "+U+"px)"),n.config.display_input_box&&(n.elementChatLog.style.maxHeight="calc(100% - "+(q+V)+"px)")}if(n.styleHideBottom=parseInt(U)-parseInt(L.height),o.Browser.IE10&&n.config.display_input_box&&(D=i.getElementById("_ul-chat-widget-chat-send").clientWidth-16,i.getElementsByClassName("sendBox")[0].style.width=parseInt(.8*D)+"px",i.getElementsByClassName("submitBox")[0].style.width=parseInt(.2*D)+"px",i.getElementById("submit").style.width=parseInt(.2*D)-8+"px"),n.config.powered_by)n.config.display_input_box?o.addClass(i.getElementById("_ul-chat-widget-chat-send"),"powered-by"):(B=i.createElement("div")).id="_ul-chat-widget-chat-send",E=i.createElement("a"),S=i.createElement("p"),T=i.createTextNode(n.poweredBy.text),(N=i.createElement("img")).src=n.currentUrl+"/img/logo_black_176.png",n.config.site_in&&!n.mobileFlag&&(N.src=n.currentUrl+"/img/logo_black.png"),n.mobileFlag||(E.href=n.poweredBy.url,E.target="_blank"),N.alt="UserLocal",S.appendChild(T),E.appendChild(S),E.appendChild(N),n.config.display_input_box?(i.getElementById("_ul-chat-widget-chat-send").appendChild(E),n.elementChatLog.style.height=parseInt(n.elementChatLog.style.height)-24+"px"):(B.style.width=C-10+"px",B.appendChild(E),i.getElementById("_ul-chat-widget").appendChild(B),o.addClass(i.getElementById("_ul-chat-widget-chat-send"),"powered-by"),o.addClass(i.getElementById("_ul-chat-widget-chat-send"),"non-text-box"),n.elementChatLog.style.height=parseInt(n.elementChatLog.style.height)-24+"px");if(n.config.default_open){if(n.config.popup.pc_icon_url&&(J=i.getElementById("popupIcon"),($=new Image).src=J.getAttribute("src"),J.style.setProperty("display","none"),o.addEventListener($,"load",(function(){n.stash.imgPopupPc={width:this.width,height:this.height};var e=i.getElementById("popupIcon");e.style.setProperty("display","none"),n.config.close_icon.use&&(n.stash.imgPopupPc.width=n.stash.imgPopupPc.width+10,n.stash.imgPopupPc.height=n.stash.imgPopupPc.height+10,e.style.setProperty("position","absolute"),e.style.setProperty("bottom","0"))})),o.addEventListener($,"error",(function(){n.config.popup.pc_icon_url=!1,n.config.close_icon.use=!1}))),n.flag.open=!0,n.flag.first_open=!1,L.bottom=0,n.config.close_icon.use){var K=i.getElementById("closeBtn"),G=i.getElementsByClassName("ul-widget-close-btn")[0];o.hasClass(K,"hidden")||o.addClass(K,"hidden"),o.hasClass(G,"hidden")&&o.removeClass(G,"hidden")}Q=i.getElementById("_ul-chat-restart-btn");K=i.querySelector(".ul-widget-close-btn");Q&&n.appendElementTooltip(Q,n.text.tooltip_restart_button,"bottom","tooltipRestartButton"),K&&n.appendElementTooltip(K,n.text.tooltip_minimize_button,"bottom","tooltipMinimizeButton")}else{if(n.config.reload_btn){var Q=i.getElementById("_ul-chat-restart-btn");o.addClass(Q,"hidden")}if(n.config.popup.pc_icon_url){var J,$,Z=i.getElementById("_ul-widget");Z.style.setProperty("display","none"),n.elementIframe.style.boxShadow="none",n.elementIframe.style.setProperty("border-radius","0 0 0 0"),(J=i.getElementById("popupIcon")).style.setProperty("display","none"),o.addClass(t,"ul-widget-hide"),($=new Image).src=J.getAttribute("src"),o.addEventListener($,"load",(function(){if(n.stash.imgPopupPc={width:this.width,height:this.height},J.style.setProperty("display","block"),n.config.close_icon.use){var e=i.getElementById("closeBtn");n.stash.imgPopupPc.width=n.stash.imgPopupPc.width+10,n.stash.imgPopupPc.height=n.stash.imgPopupPc.height+10,J.style.setProperty("position","absolute"),J.style.setProperty("bottom","0");var t=n.getRect(e);e.style.setProperty("bottom","0");var o=setInterval((function(){(t=n.getRect(e)).left>0&&(clearInterval(o),e.style.setProperty("bottom",n.stash.imgPopupPc.height-t.height+"px"))}),16)}n.elementIframe.style.setProperty("width",n.stash.imgPopupPc.width+"px"),n.elementIframe.style.setProperty("height",n.stash.imgPopupPc.height+"px")})),o.addEventListener($,"error",(function(){n.config.popup.pc_icon_url=!1,n.config.close_icon.use=!1,L.bottom=parseInt(n.styleHideBottom)+"px",L.boxShadow="0 1px 1px 0 rgba(0, 0, 0, 0.20)",L.borderRadius=n.config.popup.pc_header_border_radius+"px",o.addClass(t,"ul-widget-hide"),Z.style.setProperty("display","block")}))}else L.bottom=parseInt(n.styleHideBottom)+"px",o.addClass(t,"ul-widget-hide")}setTimeout((function(){n.config.popup.pc_open_animation&&(L.transition="0.5s")}),50)}L.zIndex=n.config.z_index}if(n.config.reload_btn&&i.getElementById("_ul-chat-restart-btn")){var Y="home"===n.config.reload_btn_icon?n.html2dom(n.iconHomeSvg):n.html2dom(n.iconReloadSvg);i.getElementById("_ul-chat-restart-btn").appendChild(Y)}n.config.display_input_box&&i.getElementById("send")&&i.getElementById("send").setAttribute("placeholder",n.text.input_placeholder);var X,ee=n.config.site_in?i.getElementById("_ul-widget"):i.getElementById("_ul-chat-widget"),te=new n.BackToBottomBtn({buttonText:n.text.back_to_bottom,clickEvent:function(){o.Os.iOs&&(n.elementChatLog.style.overflowY="hidden",setTimeout((function(){n.elementChatLog.style.overflowY="auto"}),10)),n.elementChatLog.scrollTop=n.elementChatLog.scrollHeight,this.hide()}});if(n.backToBottomBtn=te,ee.appendChild(te.getElement()),n.addEvent(i),n.isTranslateEnabled()){var ne=["ja"].concat(Object.keys(n.config.translated));n.config.translate_target_lang&&-1!==ne.indexOf(n.config.translate_target_lang)?(n.setTranslateLang(),n.initTalk(n.elementChatLog)):n.addLangSelectFirstChat()}else n.config.translate_target_lang=null,n.initTalk(n.elementChatLog);if(n.flag.completed_pre_chat=!(!r&&!n.config.testMode.use),!n.config.pre_chat.use&&!n.config.pre_chat.custom_flag||n.flag.completed_pre_chat||n.flag.maintenance||n.addPreChat(),n.config.display_cookie_consent&&!n.flag.used_cookie&&!n.config.no_cookie&&(!n.config.pre_chat.use||n.flag.completed_pre_chat||n.flag.maintenance)){n.cookieBanner=new n.CookieBanner({bannerText:n.text.cookie_banner,backgroundColor:n.config.chat_bg_color,siteIn:n.config.site_in,onHidden:function(){n.elementChatLog.style.paddingBottom=""}});var ie=n.elementChatLog;ie.parentNode.insertBefore(n.cookieBanner.getElement(),ie.nextSibling),ie.style.paddingBottom="50px"}n.config.site_in||!n.config.popup.open_delay_flag||n.mobileFlag||setTimeout((function(){n.flag.open||n.flag.check_close||n.popupOpen()}),n.config.popup.open_delay_time),n.config.site_in&&o.addEventListener(window,"resize",(function(){X||(X=setTimeout((function(){X=0,n.resizeInlineWidget()}),500))})),n.config.auto_focus&&n.autoFocus("send"),n.config.sharepoint&&!n.config.site_in&&setInterval((function(){n.url!=location.href&&n.hideChatWidget()}),100),n.execCustomEvent("initialized"),n.runPushAfterEvent()}),c)}}else n.v2Init(e,r)}else n.errorViewFunction({type:"view",that:n})}))}}},o.prototype.resizeInlineWidget=function(){if(this.elementIframe&&this.elementIframe.contentWindow){var e=this.elementIframe.contentWindow.document,t=document.getElementById(this.config.target_id),n=t.clientWidth,i=this.config.fullscreen?window.innerHeight:t.clientHeight;this.elementIframe.width=n,this.modalFlag&&(this.elementIframe.height=i);var s=e.getElementById("_ul-chat-widget-chat-send");s&&(s.style.width=n-10+"px");var a=this.elementChatLog,r=a.getElementsByClassName("chat-log");this.mobileFlag||(450<=n&&n<600?(o.removeClass(a,"portrait-sm"),o.addClass(this.elementChatLog,"portrait-md")):n<450?(o.removeClass(a,"portrait-md"),o.addClass(this.elementChatLog,"portrait-sm")):(o.removeClass(a,"portrait-sm"),o.removeClass(a,"portrait-md")));for(var l=0;l<r.length;l++){var c="windows"==o.checkDesktopOs()?n-(o.hasClass(this.elementChatLog,"windows-scrollbar")?32:52):n-32;r[l].style.width=c+"px"}if(this.config.fullscreen){if(this.elementIframe.height=i,1===this.config.widget_version){var d=s?s.clientHeight:0;a.style.height=i-d-3+"px"}this.setBackToBottomBtnPosition(a)}var u=e.getElementsByClassName("pre-chat");u.length>0&&(u[0].style.width=n+"px",this.config.fullscreen&&(u[0].style.height=i+"px"));var p=e.getElementsByClassName("image-viewer");p.length>0&&(p[0].style.width=n+"px",this.config.fullscreen&&(p[0].style.height=i+"px"));var h=e.getElementsByClassName("image-uploader");h.length>0&&(h[0].style.width=n+"px",this.config.fullscreen&&(h[0].style.height=i+"px"));var g=e.getElementById("_ul_operator_exit_modal");g&&(g.style.width=n+"px",this.config.fullscreen&&(g.style.height=i+"px")),this.languageHeader&&this.languageHeader.resize()}},o.prototype.overwriteViewParams=function(e,t){return"pre_chat_flag"in t&&this.isFalse(t.pre_chat_flag)&&(e.pre_chat_flag=!1),"pc_popup_icon_url"in t&&t.pc_popup_icon_url&&(e.pc_popup_icon_url=t.pc_popup_icon_url,e.pc_popup_icon_size_custom=0),"pc_popup_icon_width"in t&&parseInt(t.pc_popup_icon_width)>=0&&(e.pc_popup_icon_width=t.pc_popup_icon_width,e.pc_popup_icon_size_custom=1),"pc_popup_icon_height"in t&&parseInt(t.pc_popup_icon_height)>=0&&(e.pc_popup_icon_height=t.pc_popup_icon_height,e.pc_popup_icon_size_custom=1),"pc_popup_space_width"in t&&parseInt(t.pc_popup_space_width)>=0&&(e.pc_popup_space_width=t.pc_popup_space_width),"pc_popup_space_height"in t&&parseInt(t.pc_popup_space_height)>=0&&(e.pc_popup_space_height=t.pc_popup_space_height),"pc_popup_icon_balloon_status"in t&&(e.pc_popup_icon_balloon_status=t.pc_popup_icon_balloon_status),!("pc_popup_icon_balloon_position"in t)||"top"!=t.pc_popup_icon_balloon_position&&"side"!=t.pc_popup_icon_balloon_position||(e.pc_popup_icon_balloon_position=t.pc_popup_icon_balloon_position),"pc_popup_icon_balloon_message"in t&&(e.pc_popup_icon_balloon_message=t.pc_popup_icon_balloon_message),"sp_popup_icon_url"in t&&t.sp_popup_icon_url&&(e.popup_icon_url=t.sp_popup_icon_url,e.sp_popup_wait_image_origin_size=1,delete t.sp_popup_icon_url),"sp_popup_icon_width"in t&&parseInt(t.sp_popup_icon_width)>=0&&(e.sp_popup_icon_width=t.sp_popup_icon_width,e.sp_popup_wait_image_origin_size=2),"sp_popup_icon_height"in t&&parseInt(t.sp_popup_icon_height)>=0&&(e.sp_popup_icon_height=t.sp_popup_icon_height,e.sp_popup_wait_image_origin_size=2),"sp_popup_space_width"in t&&parseInt(t.sp_popup_space_width)>=0&&(e.sp_popup_space_width=t.sp_popup_space_width),"sp_popup_space_height"in t&&parseInt(t.sp_popup_space_height)>=0&&(e.sp_popup_space_height=t.sp_popup_space_height),!("popup_open_type"in t)||"side"!=t.popup_open_type&&"modal"!=t.popup_open_type||(e.popup_open_type=t.popup_open_type),!("popup_position"in t)||"left"!=t.popup_position&&"right"!=t.popup_position||(e.position=t.popup_position,delete t.popup_position),"remove_icon"in t&&(e.close_icon=t.remove_icon,delete t.remove_icon),"pc_popup_widget_space_width"in t&&parseInt(t.pc_popup_widget_space_width)>=0&&(e.pc_popup_widget_space_width=t.pc_popup_widget_space_width,e.pc_popup_widget_space_custom=1),"pc_popup_widget_space_height"in t&&parseInt(t.pc_popup_widget_space_height)>=0&&(e.pc_popup_widget_space_height=t.pc_popup_widget_space_height,e.pc_popup_widget_space_custom=1),"popup_display_delay_time"in t&&(e.popup_display_delay_time=1e3*t.popup_display_delay_time),"default_open"in t&&(e.default_open=t.default_open),"scroll_event"in t&&(e.scroll_event=t.scroll_event),"scroll_open_height"in t&&(e.openY=t.scroll_open_height,delete t.scroll_open_height),"scroll_close_height"in t&&(e.closeY=t.scroll_close_height,delete t.scroll_close_height),"popup_open_delay"in t&&(e.popup_open_delay_flag=t.popup_open_delay,delete t.popup_open_delay),"popup_open_delay_time"in t&&(e.popup_open_delay_time=1e3*t.popup_open_delay_time),"input_box"in t&&(e.display_input_box=t.input_box,delete t.input_box),e},o.prototype.paramInit=function(e,t){for(var n in void 0===t&&(t=""),e.id&&(this.config.id=e.id),e.hid&&(this.config.hid=e.hid),e.lang&&(this.config.lang=e.lang),e.preview_widget_lang&&(this.config.lang=e.preview_widget_lang),"first_talk"in e&&(this.config.first_talk=e.first_talk),"first_list"in e&&(this.config.first_list=e.first_list),e.title&&(this.config.title=e.title),e.popup_message&&(this.config.popup.message=e.popup_message),"google_id"in e&&e.google_id&&(this.config.google_id=e.google_id),!e.bot_img||void 0===e.bot_img||this.AnalyticsTagCommon.isObject(e.bot_img)||this.AnalyticsTagCommon.isArray(e.bot_img)||(this.config.bot_img[0]=e.bot_img),this.config.log)this.config.log.hasOwnProperty(n)&&"log"in e&&(!1===e.log[n]||"false"===e.log[n])&&(this.config.log[n]=!1);if(e.bot_img&&void 0!==e.bot_img&&(this.AnalyticsTagCommon.isObject(e.bot_img)||this.AnalyticsTagCommon.isArray(e.bot_img))&&(this.config.bot_img=e.bot_img),e.icon_id&&void 0!==e.icon_id&&(this.config.icon_id=e.icon_id),!("display_input_box"in e)||0!==e.display_input_box&&!1!==e.display_input_box&&"false"!==e.display_input_box&&"0"!==e.display_input_box||(this.config.display_input_box=!1),"input_box_type"in e&&e.input_box_type&&!o.Browser.IE&&(this.config.input_box_type=e.input_box_type),"quick_search_keywords"in e&&e.quick_search_keywords&&(this.config.quick_search_keywords=e.quick_search_keywords),e.openY&&e.openY>0&&(this.config.openY=e.openY),e.closeY&&e.closeY>0&&(this.config.closeY=e.closeY),this.config.closeY>this.config.openY&&(this.config.openY=this.config.closeY),e.response_time&&e.response_time>0&&(this.config.response_time=e.response_time),"scroll_event"in e&&this.isTrue(e.scroll_event)&&(this.config.scroll_event=!0),e.bg_color&&this.isColor(e.bg_color)&&(this.config.color=e.bg_color),e.chat_bg_color&&this.isColor(e.chat_bg_color)&&(this.config.chat_bg_color=e.chat_bg_color),"default_open"in e&&this.isTrue(e.default_open)&&(this.config.default_open=!0),e.suggest&&e.suggest.length>0&&(this.config.suggest=e.suggest),"recommend_funnel_flag"in e&&this.isTrue(e.recommend_funnel_flag)&&(this.config.recommend_funnel_flag=!0),"recommend_split_flag"in e&&this.isTrue(e.recommend_split_flag)&&(this.config.recommend_split.flag=!0,this.config.recommend_split.num=parseInt(e.recommend_split_num)||5),"error"in e&&e.error&&(this.config.error=e.error),"animation"in e&&this.isFalse(e.animation)&&(this.config.animation=!1),"backlog_view"in e&&this.isTrue(e.backlog_view)&&(this.config.backlog.view=e.backlog_view),"backlog_display_count"in e&&e.backlog_display_count>0&&(this.config.backlog.display_count=e.backlog_display_count),"reload_btn"in e&&this.isTrue(e.reload_btn)&&(this.config.reload_btn=!0),"reload_btn_icon"in e&&e.reload_btn_icon&&(this.config.reload_btn_icon=e.reload_btn_icon),"powered_by"in e&&this.isTrue(e.powered_by)&&(this.config.powered_by=!0),"remove_space"in e&&this.isTrue(e.remove_space)&&(this.config.remove_space=e.remove_space),"auto_focus"in e&&this.isTrue(e.auto_focus)&&(this.config.auto_focus=e.auto_focus),!("operator_mode"in e)||2!==e.operator_mode&&"2"!==e.operator_mode||(this.config.operator_mode=!0),"operator_feedback_form"in e&&this.isFalse(e.operator_feedback_form)&&(this.config.operator.feedback_form=!1),"operator_connect_confirm"in e&&this.isTrue(e.operator_connect_confirm)&&(this.config.operator.connect_confirm=!0),"operator_connect_display_waiting"in e&&this.isTrue(e.operator_connect_display_waiting)&&(this.config.operator.connect_display_waiting=!0),"operator_header_bg_color"in e&&this.isColor(e.operator_header_bg_color)&&(this.config.operator.header_bg_color=e.operator_header_bg_color),"operator_header_text_color"in e&&this.isColor(e.operator_header_text_color)&&(this.config.operator.header_text_color=e.operator_header_text_color),"operator_u_send_img_flag"in e&&this.isFalse(e.operator_u_send_img_flag)&&(this.config.operator.send_img_flag=!1),"popup_open_type"in e&&(this.config.popup_open_type=e.popup_open_type),"position"in e&&(this.config.position=e.position),"popup_width"in e&&this.isSize(e.popup_width)&&(this.config.out.width=e.popup_width),"popup_height"in e&&this.isSize(e.popup_height)&&(this.config.out.height=e.popup_height),"sp_popup_height_pct"in e){var i=parseInt(e.sp_popup_height_pct);i=Math.max(i,50),i=Math.min(i,100),this.config.out.sp_height_pct=i}if("popup_icon_url"in e&&(this.config.popup.default_icon=!1,this.config.popup.icon_url=e.popup_icon_url),"pc_popup_icon_url"in e&&(this.config.popup.pc_icon_url=e.pc_popup_icon_url,this.config.popup.pc_open_animation=!1),"pc_popup_icon_size_custom"in e&&this.isTrue(e.pc_popup_icon_size_custom)&&(this.config.popup.icon.pc.size_custom=!0),"pc_popup_icon_width"in e&&parseInt(e.pc_popup_icon_width)>=0&&(this.config.popup.icon.pc.width=parseInt(e.pc_popup_icon_width)+"px"),"pc_popup_icon_height"in e&&parseInt(e.pc_popup_icon_height)>=0&&(this.config.popup.icon.pc.height=parseInt(e.pc_popup_icon_height)+"px"),"pc_popup_icon_balloon_status"in e&&this.isTrue(e.pc_popup_icon_balloon_status)&&(this.config.popup.icon.pc.balloon.status=!0),"pc_popup_icon_balloon_message"in e&&(this.config.popup.icon.pc.balloon.message=e.pc_popup_icon_balloon_message),!("pc_popup_icon_balloon_position"in e)||"top"!==e.pc_popup_icon_balloon_position&&"side"!==e.pc_popup_icon_balloon_position||(this.config.popup.icon.pc.balloon.position=e.pc_popup_icon_balloon_position),"sp_popup_icon_width"in e&&parseInt(e.sp_popup_icon_width)>=0&&(this.config.popup.icon.sp.width=parseInt(e.sp_popup_icon_width)+"px"),"sp_popup_icon_height"in e&&parseInt(e.sp_popup_icon_height)>=0&&(this.config.popup.icon.sp.height=parseInt(e.sp_popup_icon_height)+"px"),"sp_popup_wait_image_origin_size"in e&&(this.isTrue(e.sp_popup_wait_image_origin_size)||2===parseInt(e.sp_popup_wait_image_origin_size))&&(this.config.popup.sp_wait_image_origin_size=!0,this.config.popup.icon.sp.size_custom=2===parseInt(e.sp_popup_wait_image_origin_size)),"popup_display_delay_time"in e&&(this.config.popup.display_delay_time=e.popup_display_delay_time),"popup_open_delay_time"in e&&this.isTrue(e.popup_open_delay_flag)&&(this.config.popup.open_delay_flag=!0,this.config.popup.open_delay_time=e.popup_open_delay_time),"testMode"in e&&(this.config.testMode.use=e.testMode),"no_viewport"in e&&(this.config.no_viewport=e.no_viewport),"no_viewport_android"in e&&this.mobileFlag&&o.Os.Android&&(this.config.no_viewport=e.no_viewport_android),"no_viewport_ios"in e&&this.mobileFlag&&o.Os.iOs&&(this.config.no_viewport=e.no_viewport_ios),"pc_popup_space_width"in e&&parseInt(e.pc_popup_space_width)>=0&&(this.config.popup.space.pc.width=parseInt(e.pc_popup_space_width)+"px"),"pc_popup_space_height"in e&&parseInt(e.pc_popup_space_height)>=0&&(this.config.popup.space.pc.height=parseInt(e.pc_popup_space_height)+"px"),"pc_popup_widget_space_custom"in e&&this.isTrue(e.pc_popup_widget_space_custom)&&(this.config.popup.pc_widget_space_custom=!0),"pc_popup_widget_space_width"in e&&parseInt(e.pc_popup_widget_space_width)>=0&&(this.config.popup.pc_widget_space.width=e.pc_popup_widget_space_width),"pc_popup_widget_space_height"in e&&parseInt(e.pc_popup_widget_space_height)>=0&&(this.config.popup.pc_widget_space.height=e.pc_popup_widget_space_height),"sp_popup_space_width"in e&&parseInt(e.sp_popup_space_width)>=0&&(this.config.popup.space.sp.width=parseInt(e.sp_popup_space_width)+"px"),"sp_popup_space_height"in e&&parseInt(e.sp_popup_space_height)>=0&&(this.config.popup.space.sp.height=parseInt(e.sp_popup_space_height)+"px"),"circle_icon"in e&&this.isTrue(e.circle_icon)&&(this.config.bot_icon.circle=!0),"close_icon"in e&&this.isTrue(e.close_icon)&&(this.config.close_icon.use=!0),"sp_popup_close_icon_size"in e&&parseInt(e.sp_popup_close_icon_size)>=24&&(this.config.close_icon.sp_size=e.sp_popup_close_icon_size),"icon_redisplay_flag"in e&&this.isFalse(e.icon_redisplay_flag)&&(this.config.close_icon.redisplay_flag=!1),"openlink_newtab"in e&&!this.isTrue(e.openlink_newtab)&&(this.config.openlink_newtab=!1),"openlink_noreferrer"in e&&this.isTrue(e.openlink_noreferrer)&&(this.config.openlink_noreferrer=!0),"bot_icon_border_width"in e&&this.isSize(e.bot_icon_border_width)&&(this.config.bot_icon_border_width=e.bot_icon_border_width),"chat_list_icon"in e&&this.isFalse(e.chat_list_icon)&&(this.config.list_layout.before_icon_display=!1),"chat_bot_loading"in e&&this.isTrue(e.chat_bot_loading)&&(this.config.chat_bot_loading=!0),"chat_bot_inside_img"in e&&this.isTrue(e.chat_bot_inside_img)&&(this.config.chat_bot_inside_img=!0),"chat_display_send_time"in e&&this.isTrue(e.chat_display_send_time)&&(this.config.chat_display_send_time=!0),("pre_chat_flag"in e&&this.isTrue(e.pre_chat_flag)||2===parseInt(e.pre_chat_flag))&&(this.config.pre_chat.use=!0,this.config.pre_chat.message=e.pre_chat_message||"",this.config.pre_chat.required=1===parseInt(e.pre_chat_flag)),"pre_chat_custom_flag"in e&&(this.isTrue(e.pre_chat_custom_flag)||2===parseInt(e.pre_chat_custom_flag))&&(this.config.pre_chat.custom_flag=!0,this.config.pre_chat.custom_question=e.pre_chat_custom_question||"",this.config.pre_chat.message=e.pre_chat_message||"",this.config.pre_chat.custom_required=2===parseInt(e.pre_chat_custom_flag)),"translate_lang_select_message"in e&&e.translate_lang_select_message&&(this.config.translate_lang_select_message=e.translate_lang_select_message),"translate_lang"in e&&e.translate_lang.length>0&&(this.config.translate_lang_list=e.translate_lang),"translate_status"in e&&(this.config.translate_status=e.translate_status),"translated"in e&&(this.config.translated=e.translated),"chat_bg_img_url"in e&&e.chat_bg_img_url&&(this.config.chat_bg_img_url=e.chat_bg_img_url),"pc_popup_header_height"in e&&e.pc_popup_header_height){var s=parseInt(e.pc_popup_header_height);s=Math.max(s,32),s=Math.min(s,64),this.config.popup.pc_header_height=s}if("widget_version"in e&&1!=e.widget_version&&(this.config.widget_version=parseInt(e.widget_version)),"pc_popup_header_border_radius"in e&&e.pc_popup_header_border_radius){var a=parseInt(e.pc_popup_header_border_radius);a=Math.max(a,0),a=Math.min(a,30),this.config.popup.pc_header_border_radius=a}if("carousel_panel_size"in e&&"large"!==e.carousel_panel_size&&(this.carousel_panel_size=e.carousel_panel_size),"send_icon"in e&&this.isTrue(e.send_icon)&&(this.config.send_icon=!0),"send_text_color"in e&&this.isColor(e.send_text_color)&&(this.config.send_text_color=e.send_text_color),"display_cookie_consent"in e&&this.isTrue(e.display_cookie_consent)&&(this.config.display_cookie_consent=!0),"disable_category_ids"in e&&e.disable_category_ids&&(this.config.disable_category_ids=e.disable_category_ids),"menu_items"in e&&e.menu_items&&(this.config.menu_items=e.menu_items),"popup_modal"in e&&this.isTrue(e.popup_modal)&&(this.flag.popup_modal=!0,this.stash.popupModalParent=e.popup_modal_parent),"operator_first_talk"in e&&e.operator_first_talk&&(this.text.un_operator_message=e.operator_first_talk),"render_frame"in e&&parseInt(e.render_frame)>=0&&(this.renderFrame=parseInt(e.render_frame)),2===this.config.widget_version&&("gpt_mode"in e&&parseInt(e.gpt_mode)>=0&&(this.config.gpt_mode=e.gpt_mode,3===this.config.gpt_mode&&(this.config.gpt_mode=this.config.testMode.use?1:0),4===this.config.gpt_mode&&(this.config.gpt_mode=this.config.testMode.use?2:0)),"gpt_doc_mode"in e&&parseInt(e.gpt_doc_mode)>=0&&(this.config.gpt_doc_mode=e.gpt_doc_mode,3===this.config.gpt_doc_mode&&(this.config.gpt_doc_mode=this.config.testMode.use?1:0),4===this.config.gpt_doc_mode&&(this.config.gpt_doc_mode=this.config.testMode.use?2:0),6===this.config.gpt_doc_mode&&(this.config.gpt_doc_mode=this.config.testMode.use?5:0))),""!==t){var r=[{check:t.input_placeholder,setKey:"input_placeholder"},{check:t.input_button_value,setKey:"input_button_value"},{check:t.yes_text,setKey:"yes_text"},{check:t.no_text,setKey:"no_text"},{check:t.form_send,setKey:"form_send"},{check:t.exit,setKey:"exit"},{check:t.pre_chat_send,setKey:"pre_chat_send"},{check:t.answer_check_text,setKey:"answer_check"},{check:t.maintenance_text,setKey:"maintenance"},{check:t.error_talk_backlog,setKey:"error_talk_backlog"},{check:t.error_talk_view,setKey:"error_talk_view"},{check:t.error_talk_talk,setKey:"error_talk_talk"},{check:t.error_talk_form,setKey:"error_talk_form"},{check:t.un_support_android,setKey:"un_support_android"},{check:t.un_operator_message,setKey:"un_operator_message"},{check:t.un_operator_placeholder,setKey:"un_operator_placeholder"},{check:t.backlog_display_text,setKey:"backlog"},{check:t.operator_connect_confirm,setKey:"operator_connect_confirm"},{check:t.operator_connect_button,setKey:"operator_connect_button"},{check:t.operator_connect_cancel_button,setKey:"operator_connect_cancel_button"},{check:t.operator_connect_text,setKey:"operator_connect_text"},{check:t.operator_response_text,setKey:"operator_response_text"},{check:t.operator_close_text,setKey:"operator_close_text"},{check:t.operator_session_close_text,setKey:"operator_session_close_text"},{check:t.operator_disconnect_button_text,setKey:"operator_disconnect_button_text"},{check:t.user_close_text,setKey:"user_close_text"},{check:t.operator_exit_confirm,setKey:"operator_exit_confirm"},{check:t.operator_exit_cancel_button,setKey:"operator_exit_cancel_button"},{check:t.operator_exit_button,setKey:"operator_exit_button"},{check:t.operator_connect_error,setKey:"operator_connect_error"},{check:t.operator_network_error,setKey:"operator_network_error"},{check:t.operator_reconnect,setKey:"operator_reconnect"},{check:t.operator_feedback_message,setKey:"operator_feedback_message"},{check:t.operator_feedback_comment_placeholder,setKey:"operator_feedback_comment_placeholder"},{check:t.operator_feedback_good,setKey:"operator_feedback_good"},{check:t.operator_feedback_bad,setKey:"operator_feedback_bad"},{check:t.operator_feedback_rating_required,setKey:"operator_feedback_rating_required"},{check:t.operator_cancel_chat_text,setKey:"operator_cancel_chat_text"},{check:t.form_name_label,setKey:"form_name_label"},{check:t.form_email_label,setKey:"form_email_label"},{check:t.form_message_label,setKey:"form_message_label"},{check:t.form_message_placeholder,setKey:"form_message_placeholder"},{check:t.form_select_default,setKey:"form_select_default"},{check:t.form_checkbox_required,setKey:"form_checkbox_required"},{check:t.form_select_file,setKey:"form_select_file"},{check:t.form_file_size_over,setKey:"form_file_size_over"},{check:t.form_file_not_support_browser,setKey:"form_file_not_support_browser"},{check:t.form_not_support_file,setKey:"form_not_support_file"},{check:t.form_field_required,setKey:"form_field_required"},{check:t.form_email_validation,setKey:"form_email_validation"},{check:t.form_select_required,setKey:"form_select_required"},{check:t.form_file_required,setKey:"form_file_required"},{check:t.file_list_title,setKey:"file_list_title"},{check:t.file_preview,setKey:"file_preview"},{check:t.file_gpt_doc,setKey:"file_gpt_doc"},{check:t.tooltip_restart_button,setKey:"tooltip_restart_button"},{check:t.tooltip_minimize_button,setKey:"tooltip_minimize_button"},{check:t.tooltip_close_button,setKey:"tooltip_close_button"},{check:t.tooltip_attach_image_button,setKey:"tooltip_attach_image_button"},{check:t.tooltip_fullscreen_button,setKey:"tooltip_fullscreen_button"},{check:t.tooltip_exit_fullscreen_button,setKey:"tooltip_exit_fullscreen_button"},{check:t.back_to_bottom,setKey:"back_to_bottom"},{check:t.open_new_tab,setKey:"open_new_tab"},{check:t.line_break_placeholder,setKey:"line_break_placeholder"},{check:t.gpt_mode,setKey:"gpt_mode"},{check:t.gpt_doc_mode,setKey:"gpt_doc_mode"},{check:t.gpt_switch,setKey:"gpt_switch"},{check:t.gpt_doc_switch,setKey:"gpt_doc_switch"},{check:t.gpt_mode_first_talk,setKey:"gpt_mode_first_talk"},{check:t.gpt_doc_mode_first_talk,setKey:"gpt_doc_mode_first_talk"},{check:t.gpt_doc_mode_file_first_talk,setKey:"gpt_doc_mode_file_first_talk"},{check:t.gpt_doc_mode_reference_file,setKey:"gpt_doc_mode_reference_file"},{check:t.gpt_response_label,setKey:"gpt_response_label"},{check:t.translate_select,setKey:"translate_select"},{check:t.recommend_split_message,setKey:"recommend_split_message"},{check:t.cookie_banner,setKey:"cookie_banner"}];for(var l in r)this.isText(r[l].check)&&(this.text[r[l].setKey]=r[l].check);t.input_button_value&&""!==t.input_button_value&&void 0!==t.input_button_value&&(this.config.input_button_value=t.input_button_value)}0===this.config.gpt_mode&&(this.text.gpt_doc_mode=this.text.gpt_mode,this.text.gpt_doc_switch=this.text.gpt_switch),e.input_placeholder&&e.input_placeholder.length>0&&(this.text.input_placeholder=e.input_placeholder),e.operator_connect_confirm_text&&e.operator_connect_confirm_text.length>0&&(this.text.operator_connect_confirm=e.operator_connect_confirm_text),e.operator_connect_button_text&&e.operator_connect_button_text.length>0&&(this.text.operator_connect_button=e.operator_connect_button_text),e.operator_connect_cancel_button_text&&e.operator_connect_cancel_button_text.length>0&&(this.text.operator_connect_cancel_button=e.operator_connect_cancel_button_text),e.operator_connect_text&&e.operator_connect_text.length>0&&(this.text.operator_connect_text=e.operator_connect_text),e.operator_response_text&&e.operator_response_text.length>0&&(this.text.operator_response_text=e.operator_response_text),e.confirm_text&&e.confirm_text.length>0&&(this.text.answer_check=e.confirm_text),e.confirm_yes_text&&e.confirm_yes_text.length>0&&(this.text.yes_text=e.confirm_yes_text),e.confirm_no_text&&e.confirm_no_text.length>0&&(this.text.no_text=e.confirm_no_text),e.gpt_mode_switch_text&&e.gpt_mode_switch_text.length>0&&(this.text.gpt_switch=e.gpt_mode_switch_text),e.gpt_mode_first_talk&&e.gpt_mode_first_talk.length>0&&(this.text.gpt_mode_first_talk=e.gpt_mode_first_talk),e.gpt_doc_mode_first_talk&&e.gpt_doc_mode_first_talk.length>0&&(this.text.gpt_doc_mode_first_talk=e.gpt_doc_mode_first_talk),e.gpt_doc_mode_switch_text&&e.gpt_doc_mode_switch_text.length>0&&(this.text.gpt_doc_switch=e.gpt_doc_mode_switch_text),e.recommend_split_message&&e.recommend_split_message.length>0&&(this.text.recommend_split_message=e.recommend_split_message),this.config.form[0].name.label.text=this.text.form_name_label,this.config.form[1].email.label=this.text.form_email_label,this.config.form[2].message.label=this.text.form_message_label,this.config.form[2].message.placeholder=this.text.form_message_placeholder},o.prototype.addEvent=function(e){var t=this,n=null;n=!this.mobileFlag||this.config.site_in?e.getElementById("ul-widget-header"):e.getElementById("_ul-widget-btn");var i,s=e.getElementById("send"),a=e.getElementById("submit"),r=this.elementChatLog;if("mousewheel"in document.body||"onmousewheel"in document.body?o.addEventListener(document.body,"mousewheel",(function(e){t.scrollEvent(e)})):"DOMMouseScroll"in document.body?o.addEventListener(document.body,"DOMMouseScroll",(function(e){t.scrollEvent(e)})):"onwheel"in document.body&&o.addEventListener(document.body,"wheel",(function(e){t.scrollEvent(e)})),o.addEventListener(r,"scroll",(function(e){i||(i=setTimeout((function(){i=0,t.chatLogScrollEvent(r)}),500))})),this.config.close_icon.use&&!this.config.site_in){var l=e.getElementById("closeBtn");o.addEventListener(l,"click",(function(e){t.removePopup()}))}if(!t.config.site_in)if(t.mobileFlag){var c=e.getElementById("ul-widget-header");t.widgetPositionY=0,o.Os.iOs&&o.addEventListener(window,"popstate",(function(e){!1!==t.parentBodyStyle&&(document.querySelector("body").setAttribute("style",t.parentBodyStyle),t.parentBodyStyle=!1)})),o.clickOrSimilarEvent(n,(function(){return setTimeout((function(){t.popupOpen()}),26),!1}),(function(){return!1}),this.elementIframe.contentWindow.document),o.clickOrSimilarEvent(c,(function(){return setTimeout((function(){t.popupClose()}),26),!1}),(function(){}),this.elementIframe.contentWindow.document)}else if(o.addEventListener(n,"click",(function(){t.poopupToggle()})),t.config.popup.pc_icon_url){var d=e.getElementById("popupIcon");o.addEventListener(d,"click",(function(){t.popupOpen()}))}if(t.config.display_input_box){if(t.config.error?s.setAttribute("disabled","disabled"):(o.clickOrSimilarEvent(a,(function(e){t.sendChat(s,r,t)}),(function(){}),this.elementIframe.contentWindow.document),o.addEventListener(s,"focus",(function(){t.createSuggest()})),o.addEventListener(s,"keypress",(function(e){13===e.keyCode&&(e.shiftKey||(t.sendChat(s,r,t),t.canFullScreenOnAndrid()&&s.blur()))})),o.addEventListener(s,"keyup",(function(e){if(13===e.keyCode)return!1;if(t.stash.operator.ws){var n=new Date;t.stash.operator.timeLastKeypress=n.getTime(),t.stash.operator.flagTyping||(t.stash.operator.flagTyping=!0,t.sendUserTyping(1),t.stash.operator.intervalCheckerUserInput=setInterval((function(){t.checkerUserInput()}),t.config.timeCheckerUserInput))}})),o.clickOrSimilarEvent(s,(function(){t.changeLogSize()}),(function(){}),this.elementIframe.contentWindow.document)),this.config.reload_btn){var u=e.getElementById("_ul-chat-restart-btn");t.mobileFlag?o.clickOrSimilarEvent(u,(function(e,n){return t.restartBtnEvent(),!1}),(function(e){return!1}),this.elementIframe.contentWindow.document):o.addEventListener(u,"click",(function(e){return e.stopPropagation(),t.restartBtnEvent(),!1}))}}else this.config.reload_btn&&!this.config.site_in&&(u=e.getElementById("_ul-chat-restart-btn"),t.mobileFlag?o.clickOrSimilarEvent(u,(function(e,n){return t.restartBtnEvent(),!1}),(function(e){return!1}),this.elementIframe.contentWindow.document):o.addEventListener(u,"click",(function(e){return e.stopPropagation(),t.restartBtnEvent(),!1})));if("onpagehide"in window&&o.addEventListener(window,"pagehide",(function(e){t.stash.operator.ws&&t.closeUserWs()})),"onbeforeunload"in window&&o.addEventListener(window,"beforeunload",(function(e){t.stash.operator.ws&&t.closeUserWs()})),o.addEventListener(document,"visibilitychange",(function(){var e=document.visibilityState;t.stash.operator.ws&&"visible"===e&&(t.stash.operator.lastVisibleTime=Date.now(),1!==t.stash.operator.ws.readyState&&t.reconnectOperator())})),d=t.elementIframe.contentDocument.getElementById("_ul-img-popup-icon")){var p=new Image;o.addEventListener(p,"load",(function(){t.loadPopupImg()})),o.addEventListener(p,"error",(function(){t.mobileFlag&&(n.removeChild(d),n.appendChild(t.html2dom(t.mobilePopupSvg)))}));var h=setInterval((function(){0===parseInt(t.elementIframe.style.width)?t.loadPopupImg():clearInterval(h)}),100);p.src=d.getAttribute("src")}},o.prototype.initTalk=function(e,t,n){var i=this;void 0===t&&(t=500),void 0===n&&(n=!1),this.config.testMode.use&&this.changeTestMode(),setTimeout((function(){if(!i.config.remove_space&&!n){var t=document.createElement("div");o.addClass(t,"initWhiteSpace"),t.style.height=i.getRect(e).height+"px",i.config.site_in?parseInt(t.style.height)<=0&&(t.style.height=i.config.inner.height):t.style.height=i.config.out.height,e.appendChild(t)}!n&&5!==i.config.gpt_doc_mode&&i.config.backlog.view&&"xmlHttp"===i.createHttpRequest()[1]&&e.appendChild(i.backlogButtonTemplate()),!i.config.operator_mode&&5!==i.config.gpt_doc_mode||i.flag.maintenance?""!==i.params.first_talk&&void 0!==i.params.first_talk?(e.appendChild(i.sendBot(i.params.first_talk,{icon_id:i.params.icon_id})),(i.AnalyticsTagCommon.isArray(i.params.first_list)&&0==i.params.first_list.length||""==i.params.first_list||void 0===i.params.first_list)&&i.isOpenWidget()&&i.scrollAuto(e,e.scrollTop,i)):(i.AnalyticsTagCommon.isArray(i.params.first_list)&&0==i.params.first_list.length||""==i.params.first_list||void 0===i.params.first_list)&&i.initRunPushEvent():i.config.operator_mode?(i.runPushEvent(),i.enterOperatorMode("first","","","","")):5===i.config.gpt_doc_mode&&(i.runPushEvent(),i.enterGptMode("gpt_doc")),setTimeout((function(){if(!i.config.operator_mode&&5!==i.config.gpt_doc_mode&&!i.flag.maintenance){var t=[],o="first_list_display_type"in i.params&&"carousel"===i.params.first_list_display_type,s=o?"carousel":"text";if(i.AnalyticsTagCommon.isArray(i.params.first_list)&&i.params.first_list.length>0)for(var a=0;a<i.params.first_list.length;a++)"string"==typeof i.params.first_list[a]?t.push({message:{reply:i.params.first_list[a],reply_id:null},type:s}):i.AnalyticsTagCommon.isObject(i.params.first_list[a])&&t.push({message:i.params.first_list[a],type:s});if(2===i.config.widget_version&&2===i.config.gpt_mode&&t.push({message:{reply:i.text.gpt_switch},type:s,gpt:!0}),2===i.config.widget_version&&2===i.config.gpt_doc_mode&&t.push({message:{reply:i.text.gpt_doc_switch},type:s,gpt_doc:!0}),t.length>0){if(o){e.appendChild(i.sendCarousel(i.parseSendList(t)));var r=e.childNodes[e.childNodes.length-1];i.getScrollLeft(r.lastElementChild)<=0&&(r.firstElementChild.style.display="none")}else e.appendChild(i.sendList(i.parseSendList(t)));if(""!==i.params.first_talk&&void 0!==i.params.first_talk){var l=1;!n&&i.config.backlog.view&&"xmlHttp"===i.createHttpRequest()[1]&&l++,i.isOpenWidget()&&(n?i.scrollAuto(e,e.scrollTop,i,1):i.scrollAuto(e,e.scrollTop,i,l))}else i.isOpenWidget()&&i.scrollAuto(e,e.scrollTop,i)}}}),1===i.config.widget_version?500:0)}),t)},o.prototype.addBotText=function(e,t,n,i){var s=this;this.execCustomEvent("chat",{text:e,type:"scenario"==i?"select":"input"}),this.flag.stream=(this.flag.gpt_doc_mode||this.flag.gpt_mode||this.stash.custom_chat_id)&&!o.Browser.IE;var a=this.sendTemplate("","chat-bot",{loading:this.config.chat_bot_loading||this.flag.stream,streaming:this.flag.stream,display_ai_label:this.flag.gpt_doc_mode||this.flag.gpt_mode});if((this.config.chat_bot_loading||this.flag.stream)&&(t.appendChild(a),this.scrollAuto(t,t.scrollTop,this)),this.flag.gpt_doc_mode||this.flag.gpt_mode)this.sendGptLog(e,i,{targetChatLog:a},(function(e){s.callbackSendGptLog(e,a,t)}));else{var r=Date.now(),l=this.config.chat_bot_loading?Math.max(1200,this.config.response_time):this.config.response_time;this.sendTalkLog(e,n,i,{targetChatLog:a},(function(o){if("error"!=o.responseText&&""!=o.responseText){var c=s.JSON3.parse(o.responseText);t.scrollTop=s.stash.afterScrollTop,"knowledge"!=i&&(s.flag.funnel_init=!1,s.stash.funnelQuestion=s.textEncoder.removeTag(e));var d=Date.now()-r,u=l-d,p=Math.max(0,u),h=!1;setTimeout((function(){var e,i,o,r=!1,l=!1;if("success"==c.status){e=0,i=1,c.result&&c.result.icon_id&&(e=c.result.icon_id);var d=t.scrollTop;if(s.config.chat_bot_loading||t.appendChild(a),c.hasOwnProperty("files")&&c.files.length>0&&(r=!0),"custom_chat"==c.result.type&&(l=!0),"image"==c.result.type&&""!=c.result.img_url){var u=""!==c.result.message?c.result.message:"下記画像をご覧ください。",p=!!s.config.chat_bot_inside_img&&c.result.img_url,g=!!c.result.confirm_flag&&[{text:s.text.yes_text,replyId:null},{text:s.text.no_text,replyId:null}];s.sendBot(u,{mid:c.result.mid,icon_id:e,target_chatlog:a,img:p,list:g,created_date:c.created_date}),p||t.appendChild(s.sendImageBot(c.result.img_url,{icon_id:null,elementLog:t}))}else if("text"==c.result.type&&0==c.list.length)if(c.result&&c.result.confirm_flag)s.sendBot(c.result.message,{list:[{text:s.text.yes_text,replyId:null},{text:s.text.no_text,replyId:null}],mid:c.result.mid,icon_id:e,target_chatlog:a,created_date:c.created_date});else if(r&&"message_templates"==c.result.reply_type)s.removeMe(a),i=0;else if("chatgpt_doc"===c.result.reply_type&&c.gpt_files)s.sendBot(c.result.message,{icon_id:e,target_chatlog:a,gpt_files:c.gpt_files});else{var m=n&&"recommend_na"==n.replyId;s.sendBot(c.result.message,{icon_id:e,target_chatlog:a,display_funnel_question:"message_templates"==c.result.reply_type&&!m&&s.config.recommend_funnel_flag})}else if("text"==c.result.type&&c.list.length>0){s.sendBot(c.result.message,{icon_id:e,target_chatlog:a,display_funnel_question:"recommends"===c.result.reply_type&&s.config.recommend_funnel_flag});var _=s.parseSendList(c.list);t.appendChild(s.sendList(_,{replyType:c.result.reply_type})),i=2}else if("restart"===c.result.type)s.msg_cnt++,c.result.hasOwnProperty("message")&&""!==c.result.message&&s.sendBot(c.result.message,{icon_id:e,target_chatlog:a}),s.restartTalk(1500);else if("video"===c.result.type&&""!==c.result.img_url){u=""!==c.result.message?c.result.message:"下記動画をご覧ください。";var f=!!s.config.chat_bot_inside_img&&c.result.img_url;if(g=!!c.result.confirm_flag&&[{text:s.text.yes_text,replyId:null},{text:s.text.no_text,replyId:null}],s.sendBot(u,{mid:c.result.mid,icon_id:e,target_chatlog:a,video:f,list:g,created_date:c.created_date}),!f){var y=s.createElementChatLog();(C=s.createElementVideoPlayer(c.result.img_url)).onloadedmetadata=function(){s.scrollAuto(t,t.scrollTop,s,2)},y.appendChild(C),t.appendChild(y)}}else if("operator"==c.result.type){var v=0;if(c.result.hasOwnProperty("message")&&""!==c.result.message){var b={icon_id:e,target_chatlog:a};if(c.result.hasOwnProperty("img_url")&&""!==c.result.img_url){var x=c.result.img_url.match(/\.mp4$/i)?"video":"img",w=!!s.config.chat_bot_inside_img&&c.result.img_url;b[x]=w}if(s.sendBot(c.result.message,b),v=1e3,!w)if("img"===x)t.appendChild(s.sendImageBot(c.result.img_url,{icon_id:null,elementLog:t}));else if("video"===x){var C;y=s.createElementChatLog(),(C=s.createElementVideoPlayer(c.result.img_url)).onloadedmetadata=function(){s.scrollAuto(t,t.scrollTop,s,2)},y.appendChild(C),t.appendChild(y)}}else s.removeMe(a);h=!0,setTimeout((function(){s.enterOperatorMode("scenario",c.result.mid,c.result.operator_uid,c.result.operator_did,c.result.operator_cid,(function(){s.restartTalk(1500)}))}),v)}else if("carousel"==c.result.type){s.sendBot(c.result.message,{icon_id:e,target_chatlog:a}),_=s.parseSendList(c.list),t.appendChild(s.sendCarousel(_));var k=t.childNodes[t.childNodes.length-1];s.getScrollLeft(k.lastElementChild)<=0&&(k.firstElementChild.style.display="none"),i=2}else"custom_chat"===c.result.type?(s.sendBot(c.result.message,{icon_id:e,target_chatlog:a}),setTimeout((function(){s.enterGptMode("custom_chat",null,{id:c.custom_chat.id,type:c.custom_chat.type,name:c.custom_chat.name,first_talk:c.custom_chat.first_talk})}),1e3)):r&&"message_templates"==c.result.reply_type?(s.removeMe(a),i=0):s.sendBot(c.result.message,{icon_id:e,target_chatlog:a});var I=-1==["operator","carousel"].indexOf(c.result.type)&&1!=c.result.confirm_flag&&(0!=c.list.length||"message_templates"==c.result.reply_type)&&!l;c.hasOwnProperty("files")&&c.files.length>0&&I&&(t.appendChild(s.sendFileList(c.files)),k=t.childNodes[t.childNodes.length-1],s.getScrollLeft(k.lastElementChild)<=0&&(k.querySelector("a.carousel_arrow").style.display="none"),i+=1),t.scrollTop=d,"image"!=c.result.type&&(o=t.scrollTop,s.scrollAuto(t,o,s,i),s.stash.afterScrollTop=null)}else if(c.status.match(/Over max calls/))e=0,i=1,c.result&&c.result.icon_id&&(e=c.result.icon_id),t.appendChild(s.sendBot(s.text.error_talk_talk,{icon_id:e})),o=t.scrollTop,s.scrollAuto(t,o,s,i),s.stash.afterScrollTop=null;else if("maintenance"===c.status&&"text"===c.result.type){var B={};"message"in c.result&&c.result.message&&(s.text.maintenance=c.result.message),"img_url"in c.result&&c.result.img_url&&(s.config.maintenance.image=c.result.img_url,s.config.bot_img[10]=s.config.maintenance.image),s.config.maintenance.image||(B.icon_id=10),s.maintenanceMode(s.text.maintenance,B)}else t.appendChild(s.sendBot(s.text.error_talk_talk,{icon_id:0,target_chatlog:a})),s.scrollAuto(t,t.scrollTop,s);var E=c.form&&c.form.length>0,S="message_templates"==c.result.reply_type&&r;!E||h||S||l||(o=t.scrollTop,t.appendChild(s.sendCustomFormTemplate(c.form,c.result.mid,c.result.form_message)),s.scrollAuto(t,o,s,1))}),p)}else s.errorTalkFunction({message:s.text.error_talk_talk,that:s,targetChatLog:a})}))}},o.prototype.callbackSendGptLog=function(e,t,n){this.flag.stream?this.callbackSendGptStreamLog(e,t,n):this.callbackSendGptTalkLog(e,t,n)},o.prototype.callbackSendGptStreamLog=function(e,t,n){var i=this,o=this.initMarkedScript(),s="",a="",r=!0;function l(){r=!1}n.addEventListener("wheel",l,{passive:!0}),n.addEventListener("touchstart",l,{passive:!0}),n.addEventListener("mousedown",l,{passive:!0});var c=e.body.pipeThrough(new TextDecoderStream).getReader();new Promise((function(e,l){!function l(d){return new Promise((function(e,l){c.read().then((function(l){var c=l.done,d=l.value;e(c);var u=(d=a+d).split("\n"),p=!0,h=!1,g=void 0;try{for(var m,_=u[Symbol.iterator]();!(p=(m=_.next()).done);p=!0){var f=m.value;try{var y=JSON.parse(f),v=y.status,b=y.data}catch(e){a=f;continue}var x=t.getElementsByClassName("chat-bot")[0];switch(v){case"start":x.innerHTML="",x.classList.add("gpt-mode");break;case"streaming":s+=i.textEncoder.convertToSafeBreak(b),x.innerHTML="",x.innerHTML=o.parse(s),r&&i.scrollAuto(n,n.scrollTop,i);break;case"done":if(i.flag.gpt_doc_mode&&b.gpt_files){var w=document.createElement("div");w.style.display="block",w.style.maxWidth="100%";var C=b.gpt_files;if(i.AnalyticsTagCommon.isArray(C)||(C=[C]),0!==C.length){i.createPageLinkForPreview(x,C);var k=document.createElement("div");k.classList.add("answer-file-separator"),w.appendChild(k);var I=i.Utils.blackOrWhite(i.config.chat_bg_color),B=document.createElement("div");B.classList.add("answer-file-title"),B.style.color=I,B.textContent=i.text.gpt_doc_mode_reference_file,w.appendChild(B);var E=document.createElement("div");E.classList.add("answer-file-list"),C.forEach((function(e){var t=document.createElement("a");t.setAttribute("href",e.preview_link),t.setAttribute("target","_blank"),t.setAttribute("tabIndex","0"),t.classList.add("answer-file");var n=document.createElement("img"),o=e.thumbnail;"pdf"===e.file_extension?o=i.currentUrl+"/img/filetype/pdf.svg":"txt"!==e.file_extension&&o||(o=i.currentUrl+"/img/filetype/blank.svg"),n.setAttribute("src",o),t.appendChild(n);var s=document.createElement("span");s.textContent=e.filename,s.classList.add("answer-file-name"),s.style.color=I,t.appendChild(s),E.appendChild(t)})),w.appendChild(E)}x.appendChild(w)}r&&i.scrollAuto(n,n.scrollTop,i);break;case"ng":var S=i.textEncoder.convertToBotChatText(b);x.textContent=S;break;case"error":S=i.textEncoder.convertToBotChatText(b),x.textContent=S}}}catch(e){h=!0,g=e}finally{try{!p&&_.return&&_.return()}finally{if(h)throw g}}}))})).then((function(n){if(n){var o=t.getElementsByClassName("chat-bot")[0];""===o.textContent&&(o.textContent=i.text.error_talk_talk),e()}else l()}))}()}))},o.prototype.callbackSendGptTalkLog=function(e,t,n){var i=this,s=o.Browser.IE?{parse:function(e){return e}}:this.initMarkedScript();if("error"!=e.responseText&&""!=e.responseText){var a=i.JSON3.parse(e.responseText);n.scrollTop=i.stash.afterScrollTop;var r=t.getElementsByClassName("chat-bot")[0];if(r.classList.add("gpt-mode"),"done"===a.status){var l=a.data,c=i.textEncoder.convertToSafeBreak(l.answer);if(r.innerHTML=s.parse(c),i.flag.gpt_doc_mode&&l.gpt_files){var d=document.createElement("div");d.style.display="block",d.style.maxWidth="100%";var u=l.gpt_files;if(i.AnalyticsTagCommon.isArray(u)||(u=[u]),0!==u.length){i.createPageLinkForPreview(r,u);var p=document.createElement("div");p.classList.add("answer-file-separator"),d.appendChild(p);var h=i.Utils.blackOrWhite(i.config.chat_bg_color),g=document.createElement("div");g.classList.add("answer-file-title"),g.style.color=h,g.textContent=i.text.gpt_doc_mode_reference_file,d.appendChild(g);var m=document.createElement("div");m.classList.add("answer-file-list"),u.forEach((function(e){var t=document.createElement("a");t.setAttribute("href",e.preview_link),t.setAttribute("target","_blank"),t.setAttribute("tabIndex","0"),t.classList.add("answer-file");var n=document.createElement("img"),o=e.thumbnail;"pdf"===e.file_extension?o=i.currentUrl+"/img/filetype/pdf.svg":"txt"!==e.file_extension&&o||(o=i.currentUrl+"/img/filetype/blank.svg"),n.setAttribute("src",o),t.appendChild(n);var s=document.createElement("span");s.textContent=e.filename,s.classList.add("answer-file-name"),s.style.color=h,t.appendChild(s),m.appendChild(t)})),d.appendChild(m)}r.appendChild(d)}i.scrollAuto(n,n.scrollTop,i,1)}}else i.errorTalkFunction({message:i.text.error_talk_talk,that:i,targetChatLog:t})},o.prototype.importMarkedScript=function(){var e=this.elementIframe.contentWindow.document,t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src",this.currentUrl+"/marked.min.js"),e.body.appendChild(t);var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",this.currentUrl+"/highlight.min.js"),e.body.appendChild(n);var i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("href",this.currentUrl+"/nord.min.css"),e.body.appendChild(i),this.flag.import_marked=!0},o.prototype.initMarkedScript=function(){var e=this.elementIframe.contentWindow.marked,t=this.elementIframe.contentWindow.hljs;return this.markedSetting(e,t)},o.prototype.markedSetting=function(e,t){var n=this,i={preprocess:function(t){return t=t.replace(/<br>/g,"\n"),e.lexer(t).some((function(e){return"table"==e.type}))&&(t=t.replace(/([^|\n]+\|.*[^|\n]($|\n)){2,}/g,(function(e){return e.replace(/(^[^|\n]+\|.*[^|\n])($)/gm,"| $1 |$2")}))),t}};e.use({breaks:!0,hooks:i});var o=new e.Renderer;return o.code=function(e,i){if(e=n.textEncoder.unescapeHTML(e),i&&t.getLanguage(i))var o=t.highlight(i,e).value;else{var s=t.highlightAuto(e);o=s.value,i=s.language}return'<div class="code-header">'+i+'</div><pre><code class="hljs">'+o+"</code></pre>"},o.codespan=function(e){return"<code>"+(e=n.textEncoder.unescapeHTML(e))+"</code>"},o.link=function(e,t,n){return'<a href="'+e+'" target="_blank" rel="noopener noreferrer">'+n+"</a>"},o.table=function(e,t){return'<div class="table-container"><table class="table table-bordered">\n<thead>\n'+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n</div>\n"},e.setOptions({renderer:o,headerIds:!1,mangle:!1}),e},o.prototype.createPageLinkForPreview=function(e,t){if(!o.Browser.IE){var n=e.innerHTML,i={},s={};t.forEach((function(e){var t=e.filename.normalize("NFC");i[t]=e.file_h,s[t]=e.preview_link}));var a="&lt;\\|\\s*(.+?\\.(?:"+["txt","csv","doc","docx","xls","xlsx","xlsm","ppt","pptx","pdf"].join("|")+"))\\s*(?:\\:\\s*([^\\|]+?))?\\|&gt;",r=new RegExp(a,"gi"),l=n.matchAll(r),c=!0,d=!1,u=void 0;try{for(var p,h=l[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var g=p.value,m=g[1],_=g[2];if(m&&(m=m.normalize("NFC")),Object.keys(i).includes(m)){var f=i[m],y=s[m],v="（"+m+"）";m.match(/\.pdf$/i)&&_?v="（"+m+" : "+(_=this.replacePageNumbersWithLinks(f,y,_))+"）":m&&y&&(v=" ("+this.createFileLink(m,y)+"）"),n=n.replace(g[0],v)}else n=n.replace(g[0],"")}}catch(e){d=!0,u=e}finally{try{!c&&h.return&&h.return()}finally{if(d)throw u}}e.innerHTML=n}},o.prototype.replacePageNumbersWithLinks=function(e,t,n){function i(e,t,n){return'<a href="'+e+"#page="+t+'" target="_blank" tabindex="0">'+n+"</a>"}var o=/((?:ページ|page)\s*)((?:\d+\s*[,、-]\s*)*\d+)/gi,s=/((?:\d+\s*[,、-]\s*)*\d+\s*)((?:ページ目|ページ|page)\s*)/gi,a=/^\s*((?:\d+\s*[,、-]\s*)*\d+)\s*$/gi;return n.match(o)?n=n.replace(o,(function(e,n,o){return o.trim().split(/\s*[,、-]\s*/).map((function(e){return i(t,e,n+e)})).join(", ")})):n.match(s)?n=n.replace(s,(function(e,n,o){return n.trim().split(/\s*[,、-]\s*/).map((function(e){return i(t,e,e+o)})).join(", ")})):n.match(a)&&(n=n.replace(a,(function(e,n){return n.trim().split(/\s*[,、-]\s*/).map((function(e){return i(t,e,"ページ"+e)}))}))),n},o.prototype.createFileLink=function(e,t){return'<a href="'+t+'" target="_blank" tabindex="0">'+e+"</a>"},o.prototype.addBotEndCheckText=function(e,t,n,i,o,s){var a=this;this.sendCheckLog(e,t,n,o,s,(function(e){if("error"!=e.responseText&&""!=e.responseText){var t=a.JSON3.parse(e.responseText),n=0;t.result&&t.result.icon_id&&(n=t.result.icon_id);var o=!1;setTimeout((function(){if("success"==t.status){a.msg_cnt++;var e=1;"text"==t.result.type&&t.list&&0==t.list.length?(i.appendChild(a.sendBot(t.result.message,{icon_id:n})),e=0):"form"!=t.result.type||t.hasOwnProperty("form")&&0!==t.form.length?"restart"===t.result.type?(a.msg_cnt++,t.result.hasOwnProperty("message")&&""!==t.result.message&&i.appendChild(a.sendBot(t.result.message,{icon_id:n})),e=0,a.restartTalk(1500)):"operator"==t.result.type?(o=!0,a.enterOperatorMode("endcheck",t.result.mid,t.result.operator_uid,t.result.operator_did,t.result.operator_cid,(function(){a.restartTalk(1500)}))):t.hasOwnProperty("form")&&0!==t.form.length||i.appendChild(a.sendBot(t.result.message,{icon_id:n})):(t.result.hasOwnProperty("message")&&""!==t.result.message&&i.appendChild(a.sendBot(t.result.message,{icon_id:n})),i.appendChild(a.sendFormTemplate(a.config.form,t.result.mid)),e=0),a.scrollAuto(i,i.scrollTop,a,e),a.stash.afterScrollTop=null}else if("maintenance"===t.status&&"text"===t.result.type){var s={};"message"in t.result&&t.result.message&&(a.config.maintenance.message=t.result.message),"img_url"in t.result&&t.result.img_url&&(a.config.maintenance.image=t.result.img_url,a.config.bot_img[10]=a.config.maintenance.image),a.config.maintenance.image||(s.icon_id=10),a.maintenanceMode(a.config.maintenance.message,s)}t.form&&t.form.length>0&&!o&&(t.result.hasOwnProperty("message")&&""!==t.result.message&&i.appendChild(a.sendBot(t.result.message,{icon_id:n})),i.appendChild(a.sendCustomFormTemplate(t.form,t.result.mid,t.result.form_message)),a.scrollAuto(i,i.scrollTop,a,1))}),a.config.response_time)}}))},o.prototype.getRequestParams=function(e){void 0===e&&(e={});var t={bot_id:this.config.id,h_id:this.config.hid,hash:this.config.hash,rand:this.rand,sb:this.sb,lg_id:this.config.lg_id,user_name:this.config.user_name,google_id:this.config.google_id,translate_lang:this.config.translate_target_lang,widget_type:this.config.site_in?"site_in":"popup",url:this.url,ref:this.ref,pf:this.config.pf,fp:this.fp,session:this.sessionId,br_time:(new Date).getTime(),bw:this.windowSize.width,bh:this.windowSize.height,sw:this.screenSize.width,sh:this.screenSize.height,dpr:this.dpr,no_cookie:this.config.no_cookie,anonymize_ip:this.config.anonymize_ip,mode_spa:this.config.mode_spa,version:this.version};for(var n in this.flag.popup_modal&&(t.widget_type="popup"),e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},o.prototype.sendViewLog=function(e){var t={};this.config.disable_category_ids.length>0&&(t.disable_category_ids=this.config.disable_category_ids),this.config.enable_category_ids.length>0&&(t.enable_category_ids=this.config.enable_category_ids),""!==this.config.preview_url&&(t.preview_url=this.config.preview_url),this.config.sharepoint&&(t.sharepoint=this.config.sharepoint),this.config.preview_widget_lang&&(t.preview_widget_lang=this.config.preview_widget_lang),this.stash.ieVersion&&(t.ieVersion=this.stash.ieVersion);var n=this.getRequestParams(t),i=this.config.bot_url+"view";this.sendRequest(i,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(n)}),{callback:e,errorFunction:this.errorViewFunction,errorFunctionOption:{type:"view",that:this},xDomainNonError:!0,xhrErrorStrictConditions:!0})},o.prototype.sendTalkLog=function(e,t,n,i,o){var s=null,a=null,r=null,l=null,c=null;i=i||{},o=o||function(){},null!==t&&(s=t.replyId,t.hasOwnProperty("replySid")&&t.replySid&&(a=t.replySid),t.hasOwnProperty("apiKey")&&t.apiKey&&(l=t.apiKey)),i.hasOwnProperty("carouselLink")&&i.carouselLink&&(c=i.carouselLink),this.config.recommend_funnel_flag&&(r=this.stash.selectedCid);var d={log:this.config.log.talk,message:e,select_id:s,select_sid:a,select_cid:r,api_key:l,question_type:n,carousel_link:c,disable_category_ids:this.config.disable_category_ids,enable_category_ids:this.config.enable_category_ids,funnel_init:this.flag.funnel_init,mode:""};this.stash.ieVersion&&(d.ieVersion=this.stash.ieVersion);var u=this.getRequestParams(d),p=this.config.bot_url+"talk";(this.flag.gpt_mode||this.flag.gpt_doc_mode)&&(p=this.config.gpt_url+"talk"),null!==l&&-1!==this.sendCustomFormGptBeaconBotId.indexOf(this.config.id)&&(p=this.config.gpt_url+"talk"),this.sendRequest(p,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(u)}),{callback:o,errorFunction:this.errorTalkFunction,errorFunctionOption:{type:"talk",message:this.text.error_talk_talk,that:this,targetChatLog:i.targetChatLog}})},o.prototype.sendGptLog=function(e,t,n,i){n=n||{},i=i||function(){};var o={log:this.config.log.talk,message:e,question_type:t,mode:"",stream:this.flag.stream};this.stash.ieVersion&&(o.ieVersion=this.stash.ieVersion),this.flag.gpt_mode&&(o.gpt_mode=1,o.mode="gpt"),this.flag.gpt_doc_mode&&(o.gpt_doc_mode=1,o.mode="gpt_doc",this.stash.gpt_doc_file_hs.length&&(o.gpt_doc_file_hs=this.stash.gpt_doc_file_hs)),this.stash.custom_chat_id&&(o.mode="custom_chat",o.custom_chat_id=this.stash.custom_chat_id);var s=this.getRequestParams(o),a=this.config.gpt_url+"stream";this.flag.stream?this.sendStreamRequest(a,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(s)}),{callback:i,errorFunction:this.errorTalkFunction,errorFunctionOption:{type:"talk",message:this.text.error_talk_talk,that:this,targetChatLog:n.targetChatLog}}):this.sendRequest(a,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(s)}),{callback:i,errorFunction:this.errorTalkFunction,errorFunctionOption:{type:"talk",message:this.text.error_talk_talk,that:this,targetChatLog:n.targetChatLog}})},o.prototype.sendCheckLog=function(e,t,n,i,o,s){var a=this.getRequestParams({log:this.config.log.talk,qa_result:e,mid:t,reply_id:n,question_type:i,created_date:o}),r=this.config.bot_url+"check";this.sendRequest(r,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(a)}),{callback:s,errorFunction:this.errorTalkFunction,errorFunctionOption:{type:"check",message:this.text.error_talk_talk,that:this}})},o.prototype.sendFormLog=function(e,t,n){var i={};for(var o in t)t.hasOwnProperty(o)&&(i[t[o].getAttribute("name")]=t[o].value);var s=this.getRequestParams({mid:n,dom:i,log:this.config.log.form}),a=this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(s)}),r=this.config.bot_url+"form";this.sendRequest(r,a,{callback:e,errorFunction:this.errorTalkFunction,errorFunctionOption:{type:"form",message:this.text.error_talk_form,that:this}})},o.prototype.sendCustomFormLog=function(e,t,n,i){var o={};for(var s in t)if(t.hasOwnProperty(s)){if(o[t[s].getAttribute("name")]=t[s].value,"div"===t[s].tagName.toLowerCase()){for(var a="",r=t[s].querySelectorAll("input:checked"),l=0;l<r.length;l++)a+=""==a?r[l].value:"|"+r[l].value;o[t[s].getAttribute("name")]=a}"file"===t[s].type&&t[s].files&&t[s].files[0]&&(o[t[s].getAttribute("name")]=t[s].files[0].name)}var c=this.getRequestParams({mid:n,dom:o,translate_lang:this.config.translate_target_lang,log:this.config.log.form}),d=null;(d=new FormData(i)).append("json",this.JSON3.stringify(c));var u=this.config.bot_url+"customform";-1!==this.sendCustomFormGptBeaconBotId.indexOf(this.config.id)&&(u=this.config.gpt_url+"customform"),this.sendRequest(u,d,{contentType:!1,callback:e,errorFunction:this.errorTalkFunction,errorFunctionOption:{type:"customform",message:this.text.error_talk_form,that:this}})},o.prototype.getBackLog=function(e){var t=this.getRequestParams({offset:this.config.backlog.backlog_click*this.config.backlog.display_count,limit:this.config.backlog.display_count}),n=this.config.bot_url+"backlog";this.sendRequest(n,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(t)}),{callback:e,errorFunction:this.errorTalkFunction,errorFunctionOption:{type:"backlog",message:this.text.error_talk_backlog,that:this}})},o.prototype.getSuggest=function(e){var t=this,n={};this.config.disable_category_ids.length>0&&(n.disable_category_ids=this.config.disable_category_ids),this.config.enable_category_ids.length>0&&(n.enable_category_ids=this.config.enable_category_ids),""!==this.config.preview_url&&(n.preview_url=this.config.preview_url);var i=this.getRequestParams(n),o=this.config.bot_url+"suggest";this.sendRequest(o,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(i)}),{callback:e,errorFunction:function(){t.sendSurveyLog({event_type:"error",error_message:"request error - suggest"})}})},o.prototype.sendSurveyLog=function(e){var t=this,n=this.getRequestParams(e),i=this.config.bot_url+"log";this.flag.send_survey_log&&(this.sendRequest(i,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(n)})),this.flag.send_survey_log=!1,setTimeout((function(){t.flag.send_survey_log=!0}),5e3))},o.prototype.sendConnectLog=function(e,t,n,i,o){var s=this.getRequestParams({mid:t,operator_uid:n,operator_did:i,operator_cid:o}),a=this.config.bot_url+"connect";this.sendRequest(a,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(s)}),{callback:e,errorFunction:this.errorConnectFunction,errorFunctionOption:{type:"connect",message:this.text.operator_connect_error,that:this}})},o.prototype.sendReconnectLog=function(e,t){var n=this;""===t&&(t=0==this.elementChatLog.querySelectorAll(".chat-log:not(.post-cancel)[data-mid]").length?"no-mid":t);var i=this.getRequestParams({last_mid:t}),o=this.config.bot_url+"reconnect";this.sendRequest(o,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(i)}),{callback:e,errorFunction:function(){n.sendSurveyLog({event_type:"error",error_message:"request error - reconnect"})}})},o.prototype.sendPreChatData=function(e){var t=this,n=t.elementIframe.contentWindow.document,i=n.getElementById("preChatDialog"),o={};this.checkSendDomList(e).forEach((function(e){o[e.getAttribute("name")]=e.value}));var s=this.getRequestParams({dom:o,log:this.config.log.form}),a=this.config.bot_url+"prechat";return this.sendRequest(a,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(s)}),{callback:function(){var e=n.getElementById("preChat");t.removeMe(e),t.flag.completed_pre_chat=!0},errorFunction:function(e){Array.prototype.slice.call(i.childNodes).forEach((function(e){e.parentNode.removeChild(e)}));var n=document.createElement("p");n.innerText=t.text.error_talk_form,i.appendChild(n),t.sendSurveyLog({event_type:"error",error_message:"request error - "+e.type})},errorFunctionOption:{type:"prechat"}}),!1},o.prototype.sendUserChatLog=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!==e&&""!==e&&"string"==typeof e&&0!==e.replace(/[\t\s ]/g,"").length){this.msg_cnt=this.msg_cnt+1;var n=this.elementChatLog,i=n.scrollTop;n.appendChild(this.sendUser(e)),this.config.chat_bot_loading||this.scrollAuto(n,i,this),this.addBotText(e,n,{replySid:t},"knowledge")}},o.prototype.sendBotChatLog=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(null!==e&&""!==e&&void 0!==e){var n=this.elementChatLog,i=n.scrollTop;n.appendChild(this.sendBot(e)),t&&this.scrollAuto(n,i,this)}},o.prototype.sendChat=function(e,t,n){if((!this.config.pre_chat.use||this.flag.completed_pre_chat)&&null!==e.value&&""!==e.value&&"string"==typeof e.value&&0!==e.value.replace(/[\t\s ]/g,"").length){n.msg_cnt++;var i=t.scrollTop;if(this.stash.operator.channelId){if(!this.stash.operator.ws)return n.stash.operator.activeWS=!1,n.stash.operator.ws=new WebSocket(n.config.ws_url),n.setWS(),n.surveillanceWs(),!1;n.stash.operator.timeLastKeypress=0,n.checkerUserInput();var o=n.sendWS(e.value);if(!o)return!1;t.appendChild(o)}else t.appendChild(n.sendUser(e.value));var s=e.value;e.value="",this.stash.operator.ws?n.scrollAuto(t,i,n):(this.config.chat_bot_loading||n.scrollAuto(t,i,n),n.addBotText(s,t,null,"knowledge"))}},o.prototype.sendBot=function(e,t){return this.sendTemplate(e,"chat-bot",t)},o.prototype.sendImageBot=function(e,t){return this.sendImageTemplate(e,"chat-bot",t)},o.prototype.sendUser=function(e,t){return this.sendTemplate(e,"chat-user",t)},o.prototype.sendList=function(e,t){return this.sendListTemplate(e,t)},o.prototype.sendCarousel=function(e){return this.sendListTemplate(e,{mode:"carousel"})},o.prototype.addChatTimeStamp=function(e,t,n){var i=document.createElement("div");i.setAttribute("class","time-stamp"),i.style.color=this.Utils.blackOrWhite(this.config.chat_bg_color),i.style.position="absolute",i.style.display="inline-block",i.style.bottom="4px","chat-bot"==t?i.style.right="-42px":i.style.left="-42px";var o=("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2);return i.appendChild(document.createTextNode(o)),i},o.prototype.scrollEvent=function(e){if(this.config.scroll_event&&!this.mobileFlag&&!this.config.site_in&&!this.flag.check_close){var t=this.elementIframe.style;if(this.config.openY<=this.getScrollPositionY()&&!this.flag.check_scroll_open&&!this.flag.open){this.flag.open=!0,this.flag.check_open=!0,this.flag.first_open=!1,this.flag.check_scroll_open=!0,2===this.config.widget_version?(t.bottom=parseInt(this.styleHideBottom)+"px",this.popupOpen({scrollCall:!0})):(o.removeClass(this.elementIframe,"ul-widget-hide"),t.bottom=0,this.config.popup.pc_icon_url&&this.hiddenPcPopupIcon(),this.execCustomEvent("popup_open"));var n=this.elementChatLog,i=n.scrollTop;if(this.flag.first_open){var s=0;""!==this.params.first_talk&&void 0!==this.params.first_talk&&this.AnalyticsTagCommon.isArray(this.params.first_list)&&this.params.first_list.length>0&&s++,this.config.backlog.view&&"xmlHttp"===this.createHttpRequest()[1]&&s++,this.scrollAuto(n,i,this,s)}else this.scrollAuto(n,i,this)}this.config.closeY>=this.getScrollPositionY()&&this.flag.check_scroll_open&&(this.flag.check_scroll_open=!1,this.flag.open=!1,2===this.config.widget_version?this.popupClose({scrollCall:!0}):(this.config.popup.pc_icon_url?this.displayPcPopupIcon():t.bottom=this.styleHideBottom+"px",this.execCustomEvent("popup_close")),o.addClass(this.elementIframe,"ul-widget-hide"))}},o.prototype.chatLogScrollEvent=function(e){var t=e.scrollHeight-e.clientHeight-e.scrollTop;t>900?(this.setBackToBottomBtnPosition(e),this.backToBottomBtn.show()):t<50&&this.backToBottomBtn.hide()},o.prototype.setBackToBottomBtnPosition=function(e){var t=this.mobileFlag?28:34;t=this.mobileFlag&&this.config.no_viewport?t*this.config.no_viewport_scale:t,this.backToBottomBtn.setTop(e.clientHeight-(t+15))},o.prototype.getScrollPositionY=function(){return document.documentElement.scrollTop||document.body.scrollTop},o.prototype.escapeHTML=function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML},o.prototype.sendTemplate=function(e,t,n){var i=this;void 0===n&&(n={});var s=n.target_chatlog;s&&(s.textContent=null);var a=s||this.createElementChatLog(),r=document.createElement("div");o.addClass(r,t);var l="chat-user"==t?"chat_user":"chat_bot";this.params[l+"_bg_color"]&&this.isColor(this.params[l+"_bg_color"])&&(r.style.background=i.params[l+"_bg_color"]),this.params[l+"_text_color"]&&this.isColor(this.params[l+"_text_color"])&&(r.style.color=i.params[l+"_text_color"]);var c=92;if(this.config.no_viewport&&(c=this.config.no_viewport_scale*c),"chat-bot"==t){var d="operator"===n.log_type?this.textEncoder.convertToBotChatText(e.replace(/\n/g,"<br>")):this.textEncoder.convertToBotChatText(e);if(r.innerHTML=d,r.setAttribute("aria-label","chat"),r.setAttribute("role","region"),this.setAriaLive(d),n.loading){var u=document.createElement("div");o.addClass(u,"chatlog-loader"),r.textContent=null,r.appendChild(u)}if(n.display_funnel_question&&!i.flag.funnel_init&&""!==i.stash.funnelQuestion){var p=document.createElement("div");p.setAttribute("class","funnel-question"),p.textContent="「"+this.Utils.truncate(i.stash.funnelQuestion,12)+"」"+i.text.funnel_question_message,a.appendChild(p)}if(n.display_ai_label&&(i.flag.gpt_mode||i.flag.gpt_doc_mode||"gpt"==n.backlog_type)){var h=document.createElement("div");h.setAttribute("class","ai-label");var g=i.Utils.blackOrWhite(i.config.chat_bg_color);h.textContent=i.text.gpt_response_label,h.style.color=g,h.appendChild(i.html2dom(i.aiSparkleSvg)),a.appendChild(h)}if(n.hasOwnProperty("img_src")&&n.img_src){var m=this.getBotIcon(n.img_src);this.config.bot_icon.circle&&o.addClass(m,"circle"),a.appendChild(m)}else if(this.config.bot_img&&""!=this.config.bot_img[0]){var _=this.config.bot_img[0];if(n&&n.icon_id&&n.icon_id in this.config.bot_img&&(_=this.config.bot_img[n.icon_id]),_)m=this.getBotIcon(_),this.config.bot_icon.circle&&o.addClass(m,"circle"),a.appendChild(m);else{var f=document.createElement("div");o.addClass(f,"_ul-chat-chip"),o.addClass(f,"non-image-keep-size"),a.appendChild(f)}}}else r.innerHTML="operator"===n.log_type||this.flag.gpt_doc_mode||this.flag.gpt_mode||this.v2InputBox&&"newline"===this.v2InputBox.getInputType()?this.textEncoder.convertToNewLineUserChatText(e):this.textEncoder.convertToUserChatText(e),r.setAttribute("aria-label","chat"),r.setAttribute("role","region");if(n.img){var y=document.createElement("div"),v=this.createElementChatImage(n.img);y.appendChild(v),o.addClass(y,"inside-image"),r.appendChild(y)}if(n.video){var b=document.createElement("div"),x=this.createElementVideoPlayer(n.video);o.addClass(b,"inside-video"),this.flag.backlog_no_scroll||(x.onloadedmetadata=function(){var e=i.elementChatLog;i.scrollAuto(e,e.scrollTop,i,1)}),b.appendChild(x),r.appendChild(b)}if(n.list&&n.mid){var w=this.createElementEndCheck(n.list),C=document.createElement("div"),k=document.createElement("span");o.addClass(C,"end-question"),o.addClass(k,"question");var I=document.createTextNode(n.mid),B=document.createElement("span");B.style.display="none",B.appendChild(I),o.addClass(B,"mid"),C.appendChild(B);var E=document.createTextNode(n.created_date),S=document.createElement("span");S.style.display="none",S.appendChild(E),o.addClass(S,"created-date"),C.appendChild(S);var T=this.text.answer_check;"answer_text"in n&&(T=n.answer_text),k.innerHTML=this.textEncoder.convertToBotChatText(T),C.appendChild(k),C.appendChild(w),r.appendChild(document.createElement("hr")),r.appendChild(C),o.addClass(r.getElementsByTagName("li")[0],"success")}if(this.config.chat_display_send_time){var L=a.getElementsByClassName("_ul-chat-chip").length>0,P=n.backlogDate?n.backlogDate:new Date;r.style.position="relative",r.appendChild(this.addChatTimeStamp(P,t,L))}a.appendChild(r),Array.prototype.slice.call(r.querySelectorAll("a[data-q]")).forEach((function(e){var t=e.dataset.q,n=e.dataset.sid;""!=t&&e.addEventListener("click",(function(){i.sendUserChatLog(t,n)}))})),Array.prototype.slice.call(r.querySelectorAll("a[data-restart]")).forEach((function(e){"1"==e.dataset.restart&&e.addEventListener("click",(function(){i.restartTalk()}))}));var A=Array.prototype.slice.call(r.querySelectorAll("img"));if(A.forEach((function(e){if("A"!=e.parentElement.tagName){var t=e.getAttribute("src");e.style.setProperty("cursor","pointer"),e.addEventListener("click",(function(){i.addImageViewer(t)}))}})),!this.flag.backlog_no_scroll){var F=Array.prototype.slice.call(r.querySelectorAll("iframe")),M=A.concat(F),O=i.elementChatLog,H=s?O.childElementCount-2:O.childElementCount-1,z=O.children[H]&&1==O.children[H].getElementsByClassName("chat-user").length?1:0;M.forEach((function(e){o.addEventListener(e,"load",(function(){i.scrollAuto(O,O.scrollTop,i,z)}))}))}return a},o.prototype.parseSendList=function(e){for(var t=[],n=0;n<e.length;n++)if("text"==e[n].type||"carousel"==e[n].type){var i={};e[n].message&&e[n].message.reply&&(i.text=e[n].message.reply,i.replyId=e[n].message.reply_id,e[n].message.hasOwnProperty("reply_sid")&&e[n].message.reply_sid&&(i.replySid=e[n].message.reply_sid),e[n].message.hasOwnProperty("reply_cid")&&e[n].message.reply_cid&&(i.replyCid=e[n].message.reply_cid),e[n].message.hasOwnProperty("api_key")&&e[n].message.api_key&&(i.apiKey=e[n].message.api_key),e[n].message.hasOwnProperty("reply_img")&&e[n].message.reply_img&&(i.replyImg=e[n].message.reply_img),e[n].message.hasOwnProperty("reply_link")&&e[n].message.reply_link&&(i.replyLink=e[n].message.reply_link),e[n].hasOwnProperty("gpt")&&this.isTrue(e[n].gpt)&&(i.gpt=!0),e[n].hasOwnProperty("gpt_doc")&&this.isTrue(e[n].gpt_doc)&&(i.gpt_doc=!0),t.push(i))}return t},o.prototype.sendImageTemplate=function(e,t,n){var i=this,s=this.createElementChatLog();if("chat-bot"==t&&this.config.bot_img&&""!=this.config.bot_img[0]){var a=document.createElement("div");if(null!=n.icon_id){var r=document.createElement("img");r.src=this.config.bot_img[0],n&&n.icon_id&&n.icon_id in this.config.bot_img&&(r.src=this.config.bot_img[n.icon_id]),r.alt="",o.addClass(a,"_ul-chat-chip"),a.appendChild(r)}else o.addClass(a,"_ul-chat-chip"),o.addClass(a,"non-image");s.appendChild(a)}var l=i.createElementChatImage(e,(function(){if(!(!("elementLog"in n)||"noScroll"in n&&n.noScroll||"backlogScroll"in n&&n.backlogScroll)){var e=n.elementLog.scrollTop;i.scrollAuto(n.elementLog,e,i,2)}"backlogScroll"in n&&n.backlogScroll&&(i.scrollBottom(n.elementLog,i.stash.scrollBottom),i.stash.scrollHeight=n.elementLog.scrollHeight)}),(function(){i.addImageViewer(e)}));return s.appendChild(l),s},o.prototype.createElementChatImage=function(e,t,n){t=t||function(){},n=n||function(){};var i=document.createElement("img");return i.setAttribute("src",e),i.alt="",i.onload=t,i.style.setProperty("cursor","pointer"),o.clickOrSimilarEvent(i,n,(function(){}),this.elementIframe.contentWindow.document),i},o.prototype.addImageViewer=function(e){var t=this,n=document.createElement("div");o.addClass(n,"image-viewer"),n.style.top=0,n.style.width="100%",n.style.height="100%";var i=document.createElement("div");o.addClass(i,"image-viewer-background"),n.appendChild(i);var s=e.match(/img_url=(.*)$/),a=s?s[1]:e,r=document.createElement("span"),l=document.createElement("img"),c=document.createElement("button"),d=document.createElement("a"),u=document.createElement("span");o.addClass(r,"image-viewer-contents"),o.addClass(l,"image-viewer-contents-img"),o.addClass(c,"image-viewer-close-btn"),o.addClass(d,"image-viewer-new-tab"),l.setAttribute("src",a),l.onload=function(){r.style.setProperty("width",l.clientWidth+"px"),r.style.setProperty("height",l.clientHeight+"px")},u.textContent=t.text.open_new_tab,d.setAttribute("href",a),d.target="_blank",d.appendChild(u),d.appendChild(this.html2dom(this.iconNewTab)),c.appendChild(this.html2dom(this.iconCloseSvg)),r.appendChild(l),r.appendChild(c),a.match(/^http/)&&r.appendChild(d),n.appendChild(r),n.addEventListener("click",(function(){t.removeMe(n)})),d.addEventListener("click",(function(e){e.stopPropagation()})),this.elementIframe.contentWindow.document.getElementById("_ul-widget").appendChild(n)},o.prototype.createElementVideoPlayer=function(e){var t=document.createElement("video");return o.addClass(t,"video-player"),t.setAttribute("controls",!0),t.setAttribute("playsinline",!0),t.setAttribute("preload","metadata"),t.setAttribute("controlsList","nodownload"),t.setAttribute("src",e),t},o.prototype.displayModalDialog=function(e,t,n,i,s){var a=this;t=t||"閉じる",void 0===i&&(i=function(){}),void 0===s&&(s=!0);var r=document.createElement("div");o.addClass(r,"modal-container"),n&&o.addClass(r,n),r.style.top=0,r.style.width="100%",r.style.height="100%";var l=document.createElement("div");o.addClass(l,"modal-background"),r.appendChild(l);var c=document.createElement("div"),d=document.createElement("p"),u=document.createElement("button");o.addClass(c,"modal-dialog"),d.innerHTML=this.textEncoder.convertToBotChatText(e),u.textContent=t,c.appendChild(d),c.appendChild(u),r.appendChild(c),o.clickOrSimilarEvent(u,(function(){a.removeMe(r),i()}),(function(){}),this.elementIframe.contentWindow.document),o.clickOrSimilarEvent(l,(function(){!0===s&&a.removeMe(r)}),(function(){}),this.elementIframe.contentWindow.document),this.elementIframe.contentWindow.document.getElementById("_ul-widget").appendChild(r)},o.prototype.createElementSystemChatLog=function(e){var t=this.createElementChatLog(),n=document.createElement("div");return o.addClass(n,"chat-system"),n.innerHTML=this.textEncoder.convertToBotChatText(e),t.appendChild(n),t},o.prototype.createElementOperatorFeedbackForm=function(){var e=this,t=e.elementIframe.contentWindow.document,n=this.createElementChatLog(),i=document.createElement("form");o.addClass(i,"feedback");var s=document.createElement("div");s.textContent=this.text.operator_feedback_message,o.addClass(s,"text-alien-center"),i.appendChild(s);var a=document.createElement("div");o.addClass(a,"star-btn-wrapper");var r=document.createElement("div");o.addClass(r,"star-text-wrapper");var l=document.createElement("div"),c=document.createElement("div");o.addClass(l,"star-text text-alien-right"),o.addClass(c,"star-text"),l.textContent=this.text.operator_feedback_good,c.textContent=this.text.operator_feedback_bad,r.appendChild(c),r.appendChild(l);var d=document.createElement("ul");a.appendChild(d),a.appendChild(r),i.appendChild(a);for(var u=[],p=1;p<=5;p++){var h=document.createElement("input");h.setAttribute("type","radio"),h.setAttribute("name","rating"),h.setAttribute("value",p),h.setAttribute("id","starRadioBtn"+p),h.setAttribute("required",!0),h.style.position="absolute",h.style.opacity="0",h.style.width="20%",d.appendChild(h);var g=document.createElement("li"),m=document.createElement("label");o.addClass(m,"star-label");var _=this.html2dom(this.starOnBtnSvg);m.setAttribute("for","starRadioBtn"+p),m.appendChild(this.html2dom(this.starOffBtnSvg)),_.style.display="none",m.appendChild(_),g.appendChild(m),d.appendChild(g),u.push(m),o.clickOrSimilarEvent(m,(function(e){var t;t=u.indexOf(e)+1,u.forEach((function(e,n){e.childNodes[0].style.display=n+1<=t?"none":"block",e.childNodes[1].style.display=n+1>t?"none":"block"}))}),(function(){}),this.elementIframe.contentWindow.document)}var f=this.createElementInput("textarea",{type:"textarea",placeholder:this.text.operator_feedback_comment_placeholder});f.firstChild.name="comment",i.appendChild(f);var y=this.createElementInput("submit",{type:"submit",value:this.text.form_send});return o.addClass(y,"text-alien-center"),i.appendChild(y),i.addEventListener("submit",(function(n){n.preventDefault();var s=document.createElement("div"),a=document.createElement("div");s.style.lineHeight=e.getRect(i).height+"px",s.style.height=e.getRect(i).height+"px",s.style.width=e.getRect(i).width+"px",o.addClass(s,"sending-form"),o.addClass(a,"connection-loader"),s.appendChild(a),i.appendChild(s);for(var r=t.getElementsByName("rating"),l=0,c=0;c<r.length;c++)if(r[c].checked){l=r[c].value;break}var d={rating:l,comment:i.comment.value},u=e.getRequestParams({fid:e.getRandomStr(32),dom:d,log:e.config.log.form}),p=e.config.bot_url+"operatorFeedback",h=e.AnalyticsTagCommon.encodeHTMLForm({json:e.JSON3.stringify(u)});e.sendRequest(p,h,{callback:function(t){if("error"==t.responseText||""==t.responseText)var n=e.text.error_talk_form;else n=e.JSON3.parse(t.responseText).result.message||"送信が完了しました";var o=e.elementChatLog;e.removeMe(s),e.disableForm(i),i.style.pointerEvents="none",i.style.opacity="0.6",o.appendChild(e.sendBot(n)),e.scrollAuto(o,o.scrollTop,e)},errorFunction:e.errorTalkFunction,errorFunctionOption:{type:"operatorFeedback",message:e.text.error_talk_form,that:e}})})),n.appendChild(i),n},o.prototype.createElementOperatorCustomFeedbackForm=function(){for(var e=this.createElementForm(this.config.operator.custom_feedback_form,"sendCustomFeedbackForm",null,!1,this.config.operator.custom_feedback_form_message),t=e.querySelectorAll("input[type=file]"),n=0;n<t.length;n++)this.removeMe(t[n].parentNode);o.addClass(e,"feedback"),o.addClass(e,"custom");var i=this.createElementChatLog();return i.appendChild(e),i},o.prototype.sendOperatorCustomFeedbackForm=function(e){var t=this,n=(t.elementIframe.contentWindow.document,document.createElement("div")),i=document.createElement("div");n.style.lineHeight=t.getRect(e).height+"px",n.style.height=t.getRect(e).height+"px",n.style.width=t.getRect(e).width+"px",o.addClass(n,"sending-form"),o.addClass(i,"connection-loader"),n.appendChild(i),e.appendChild(n);var s=t.checkSendDomList(e),a={};for(var r in s)if(s.hasOwnProperty(r)&&(a[s[r].getAttribute("name")]=s[r].value,"div"===s[r].tagName.toLowerCase())){for(var l="",c=s[r].querySelectorAll("input:checked"),d=0;d<c.length;d++)l+=""==l?c[d].value:"|"+c[d].value;a[s[r].getAttribute("name")]=l}var u=t.getRequestParams({fid:t.getRandomStr(32),dom:a,custom:!0,log:t.config.log.form}),p=t.config.bot_url+"operatorFeedback",h=t.AnalyticsTagCommon.encodeHTMLForm({json:t.JSON3.stringify(u)});return t.sendRequest(p,h,{callback:function(i){if("error"==i.responseText||""==i.responseText)var o=t.text.error_talk_form;else o=t.JSON3.parse(i.responseText).result.message||"送信が完了しました";var s=t.elementChatLog;t.removeMe(n),t.disableForm(e),e.style.pointerEvents="none",e.style.opacity="0.6",s.appendChild(t.sendBot(o)),t.scrollAuto(s,s.scrollTop,t)},errorFunction:t.errorTalkFunction,errorFunctionOption:{type:"operatorFeedback custom",message:t.text.error_talk_form,that:t}}),!1},o.prototype.createElementOperatorCustomForm=function(e,t){for(var n=this.createElementForm(e,"sendOperatorCustomForm",null,!1,t),i=n.querySelectorAll("input[type=file]"),o=0;o<i.length;o++)this.removeMe(i[o].parentNode);var s=this.createElementChatLog();return s.appendChild(n),s},o.prototype.sendOperatorCustomForm=function(e){var t=this,n=document.createElement("div"),i=document.createElement("div");n.style.lineHeight=t.getRect(e).height+"px",n.style.height=t.getRect(e).height+"px",n.style.width=t.getRect(e).width+"px",n.style.margin="0",i.style.top="40%",i.style.left="45%",e.style.position="relative",o.addClass(n,"sending-form"),o.addClass(i,"connection-loader"),n.appendChild(i),e.appendChild(n);var s=t.checkSendDomList(e),a={};for(var r in s)if(s.hasOwnProperty(r)&&(a[s[r].getAttribute("name")]=s[r].value,"div"===s[r].tagName.toLowerCase())){for(var l="",c=s[r].querySelectorAll("input:checked"),d=0;d<c.length;d++)l+=""==l?c[d].value:"|"+c[d].value;a[s[r].getAttribute("name")]=l}return t.sendFormWS(a,e.parentElement.dataset.mid),!1},o.prototype.appendElementTooltip=function(e,t,n,i){n=n||"top";var s=this,a=this.elementIframe.contentDocument.getElementById("_ul-widget"),r=document.createElement("div"),l=null,c=function(){l=setTimeout((function(){r.style.display="block";var t=e.getBoundingClientRect();"top"===n?r.style.top=t.top-35+"px":"bottom"===n&&(r.style.top=t.bottom+5+"px"),s.elementIframe.clientWidth/2>=e.getBoundingClientRect().left?r.style.left=t.left+"px":(o.addClass(r,"reverse"),r.style.right=a.clientWidth-t.right+"px")}),500)},d=function(){r.style.display="none",clearTimeout(l)};this.mobileFlag?(o.addEventListener(e,"touchstart",c),o.addEventListener(e,"touchend",d),o.addEventListener(e,"click",(function(e){d()}))):(o.addEventListener(e,"mouseenter",c),o.addEventListener(e,"mouseleave",d)),o.addClass(r,"tooltip"),o.addClass(r,n),i&&r.setAttribute("id",i),r.textContent=t,a.appendChild(r)},o.prototype.sendListTemplate=function(e,t){t=t||{};var n=this,i=this.createElementChatLog(),s=document.createElement("ul");if(t.hasOwnProperty("mode")&&"carousel"===t.mode?(o.addClass(s,"chat-log-group-carousel"),"medium"===n.carousel_panel_size&&o.addClass(s,"size-medium")):o.addClass(s,"chat-log-group-list"),"carousel"==t.mode){i.style.position="relative";var a=document.createElement("a");a.setAttribute("class","carousel_arrow");var r=document.createElement("span");r.setAttribute("class","carousel_slide_icon next_slide_icon"),a.appendChild(r),o.addEventListener(a,"click",(function(){n.nextSlideCarousel(s,e.length)}));var l=document.createElement("a");l.setAttribute("class","carousel_arrow prev");var c=document.createElement("span");c.setAttribute("class","carousel_slide_icon prev_slide_icon"),l.appendChild(c),l.style.display="none",o.addEventListener(l,"click",(function(){n.prevSlideCarousel(s,e.length)})),i.appendChild(a),i.appendChild(l),o.addEventListener(s,"scroll",(function(){s.scrollLeft<=0?l.style.display="none":Math.floor(n.getScrollLeft(s))<=0?a.style.display="none":(l.style.display="block",a.style.display="block")}))}function d(e,i){var s=document.createElement("li");if("carousel"==t.mode){var a="";e[i].hasOwnProperty("replyImg")&&e[i].replyImg&&(a=e[i].replyImg);var r=document.createElement("div");if(o.addClass(r,"carousel-img-frame"),e[i].hasOwnProperty("gpt")&&e[i].gpt||e[i].hasOwnProperty("gpt_doc")&&e[i].gpt_doc)r.appendChild(n.html2dom(n.aiSparkleSvg)),s.appendChild(r);else{var l=document.createElement("img");l.src=a,r.appendChild(l),s.appendChild(r)}}var c=document.createElement("span");if(s.setAttribute("role","button"),s.setAttribute("tabIndex","0"),o.setData(s,"value",e[i].text),!n.mobileFlag&&n.config.list_layout.before_icon_display){var d=document.createElement("span");o.addClass(d,"list-layout-before"),s.appendChild(d)}if(o.addClass(c,"text"),o.data(s,"reply-id",e[i].replyId),e[i].hasOwnProperty("replySid")&&e[i].replySid&&o.data(s,"reply-sid",e[i].replySid),e[i].hasOwnProperty("replyCid")&&e[i].replyCid&&o.data(s,"reply-cid",e[i].replyCid),e[i].hasOwnProperty("apiKey")&&e[i].apiKey&&o.data(s,"api-key",e[i].apiKey),c.innerHTML=n.textEncoder.convertToSelectionText(e[i].text),s.appendChild(c),e[i].hasOwnProperty("replyLink")&&e[i].replyLink){var u=n.config.openlink_newtab?"_blank":"_parent",p=n.config.openlink_noreferrer?"noreferrer nofollow noopener":"nofollow noopener",h=n.textEncoder.createElementChatATag("",e[i].replyLink,u,p,"");h.style.textDecoration="none",h.setAttribute("class","carousel-link"),h.innerHTML=s.innerHTML,s.innerHTML=h.outerHTML,s.setAttribute("tabIndex","-1")}return e[i].hasOwnProperty("gpt")&&e[i].gpt&&(o.data(s,"gpt",1),s.classList.add("gpt-mode")),e[i].hasOwnProperty("gpt_doc")&&e[i].gpt_doc&&(o.data(s,"gpt_doc",1),s.classList.add("gpt-mode")),s}if(n.config.recommend_split.flag&&"recommends"==t.replyType){var u=n.config.recommend_split.num,p=e.length<u?e.length:u,h="recommend_na"===e[e.length-1].replyId;h&&e.length-1===u&&p++;for(var g=0;g<p;g++)s.appendChild(d(e,g));p<e.length&&s.appendChild(function e(t,i){var a=document.createElement("li");if(a.setAttribute("role","button"),a.setAttribute("tabIndex","0"),o.data(a,"recommends",1),!n.mobileFlag&&n.config.list_layout.before_icon_display){var r=document.createElement("span");o.addClass(r,"list-layout-before"),a.appendChild(r)}var l=document.createElement("span");o.addClass(l,"text");var c=t.length-i;function p(t,i){n.removeMe(a);var r=document.createElement("div");o.addClass(r,"recommend-loader"),s.appendChild(r),setTimeout((function(){r&&n.removeMe(r);var a,l=i+u;for(l=t.length<l?t.length:l,h&&t.length-1===l&&l++,a=i;a<l;a++){var c=d(t,a);o.clickOrSimilarEvent(c,_,(function(){}),n.elementIframe.contentWindow.document),o.addEventListener(c,"keyup",(function(e){13===e.keyCode&&m(this)})),s.appendChild(c)}l<t.length&&s.appendChild(e(t,a))}),500)}return h&&c--,l.textContent="ja"!==n.config.lang||n.config.translate_target_lang?n.text.recommend_split_message+" ( "+c+" )":n.text.recommend_split_message+" (残り"+c+"件)",a.appendChild(l),a.addEventListener("click",(function(){p(t,i)})),a.addEventListener("keyup",(function(e){13===e.keyCode&&p(t,i)})),a}(e,u))}else for(g=0;g<e.length;g++)s.appendChild(d(e,g));function m(e){if((!n.config.pre_chat.use||n.flag.completed_pre_chat)&&!o.getData(e,"recommends")){var t=o.getData(e,"value"),i={replyId:o.getData(e,"reply-id")},s=o.getData(e,"reply-sid");s&&(i.replySid=s);var a=o.getData(e,"reply-cid");a&&n.config.recommend_funnel_flag&&n.setSelectedCid(a);var r=o.getData(e,"api-key");r&&(i.apiKey=r);var l=n.elementChatLog,c=l.scrollTop;n.addElementWhiteSpace(l,parseInt(l.style.height),c),setTimeout((function(){n.msg_cnt++,n.addElementWhiteSpace(l,l.style.height,c),l.appendChild(n.sendUser(t)),n.config.chat_bot_loading||n.scrollAuto(l,c,n),n.addBotText(t,l,i,"scenario")}),100)}}function _(e){if(e.blur(),o.getData(e,"gpt"))n.enterGptMode("gpt");else if(o.getData(e,"gpt_doc"))n.enterGptMode("gpt_doc");else{if(o.getData(e,"recommends"))return;m(e)}}for(i.appendChild(s),g=0;g<s.childElementCount;g++)s.childNodes[g].querySelectorAll("a.carousel-link").length>0?o.addEventListener(s.childNodes[g],"click",(function(){var e={replyId:this.dataset.replyId,replySid:this.dataset.replySid},t=this.querySelector("a.carousel-link").href;n.sendTalkLog(this.dataset.value,e,"scenario",{carouselLink:t})})):(o.clickOrSimilarEvent(s.childNodes[g],_,(function(){}),this.elementIframe.contentWindow.document),o.addEventListener(s.childNodes[g],"keyup",(function(e){13===e.keyCode&&m(this)})));return i},o.prototype.createElementEndCheck=function(e){for(var t=this,n=document.createElement("ul"),i=0;i<e.length;i++){var s=document.createElement("li"),a=document.createElement("span");o.data(s,"reply-id",e[i].replyId),s.setAttribute("role","button"),s.setAttribute("tabIndex","0"),o.setData(s,"value",e[i].text),o.addClass(a,"text"),a.innerHTML=this.textEncoder.convertToSelectionText(e[i].text),s.appendChild(a),n.appendChild(s)}function r(e){var n=o.hasClass(e,"success")?"solved":"unsolved",i=o.data(e,"reply-id"),s=e.parentNode.parentNode.getElementsByClassName("mid")[0].textContent,a=e.parentNode.parentNode.getElementsByClassName("created-date")[0].textContent,r=t.elementChatLog,l=r.scrollTop;t.addElementWhiteSpace(r,parseInt(r.style.height),l),setTimeout((function(){t.msg_cnt++,t.addElementWhiteSpace(r,parseInt(r.style.height),l),t.addBotEndCheckText(n,s,i,r,"scenario",a)}),100)}function l(e){e.blur(),e.style.pointerEvents="none",r(e)}for(i=0;i<n.childElementCount;i++)o.clickOrSimilarEvent(n.childNodes[i],l,(function(){}),this.elementIframe.contentWindow.document),o.addEventListener(n.childNodes[i],"keyup",(function(e){13===e.keyCode&&r(this)}));return n},o.prototype.nextSlideCarousel=function(e,t){var n=Math.ceil(e.scrollLeft+e.scrollWidth/t),i=Math.ceil(Math.ceil(e.scrollLeft)%Math.floor(e.scrollWidth/t));n-i+Math.floor(e.scrollWidth/t)>=e.scrollWidth?e.scrollLeft=e.scrollWidth:e.scrollLeft=n-i},o.prototype.prevSlideCarousel=function(e,t){var n=Math.floor(e.scrollLeft-e.scrollWidth/t),i=Math.floor(Math.ceil(Math.max(this.getScrollLeft(e),0))%Math.floor(e.scrollWidth/t));n+i+Math.floor(e.scrollWidth/t)<=0?e.scrollLeft=0:e.scrollLeft=n+i},o.prototype.sendFormTemplate=function(e,t){var n=this.createElementChatLog();return n.appendChild(this.createElementForm(e,"sendData",t,!1)),n},o.prototype.sendCustomFormTemplate=function(e,t,n){var i=this.createElementChatLog();return i.appendChild(this.createElementForm(e,"sendCustomData",t,!1,n)),i},o.prototype.createElementForm=function(e,t,n,i,s){t=t||"sendData";var a=this,r=this.config.formTag.action,l=this.config.formTag.method,c=[],d=e.length,u=!1,p=this.text.form_send;i&&(p="ja"==o.prototype.getBrowserLang()?this.text.pre_chat_send:"Start Chat");for(var h={type:"submit",value:p},g=0;g<e.length;g++)for(var m in e[g])e[g].hasOwnProperty(m)&&(c[c.length]=this.createElementInput(m,e[g][m]),"submit"==e[g][m].type.toLowerCase()&&(u=!0,c[c.length-1].setAttribute("class","text-alien-center")),c.length>=d&&!u&&(c[c.length]=this.createElementInput("submit",h),c[c.length-1].setAttribute("class","text-alien-center")));var _=document.createElement("form");if(-1!=["sendData","sendCustomData","sendCustomFeedbackForm"].indexOf(t)&&_.setAttribute("class","designed-form"),_.action=r,_.method=l,void 0!==n&&o.setData(_,"mid",n),s){var f=document.createElement("div");f.innerHTML=this.textEncoder.convertToBotChatText(s),_.appendChild(f)}for(g=0;g<c.length;g++)c[g]&&_.appendChild(c[g]);return _.setAttribute("onSubmit","return false;"),o.clickOrSimilarEvent(c[c.length-1].firstElementChild,(function(){if(_.checkValidity()){switch(t){case"sendData":a.sendFormData(_);break;case"sendCustomData":a.sendCustomFormData(_);break;case"sendPreChatData":a.sendPreChatData(_);break;case"sendCustomFeedbackForm":a.sendOperatorCustomFeedbackForm(_);break;case"sendOperatorCustomForm":a.sendOperatorCustomForm(_)}_.querySelector('input[type="submit"]').style.pointerEvents="none"}}),(function(){}),this.elementIframe.contentWindow.document),_},o.prototype.disableForm=function(e){var t=Array.prototype.slice.call(e.querySelectorAll("input, textarea, select, label.file-upload-button")),n=Array.prototype.slice.call(e.querySelectorAll("label"));t.forEach((function(e){e.setAttribute("disabled","disabled"),"checkbox"!==e.type&&"radio"!==e.type&&e.style.setProperty("box-shadow","0 0 0px 999px #e0e0e0 inset"),e.style.setProperty("-webkit-text-fill-color","#666"),e.style.setProperty("color","#666"),e.style.setProperty("border","1px solid #ddd"),e.style.setProperty("cursor","auto")})),n.forEach((function(e){e.style.setProperty("color","#999");var t=e.querySelector("svg");t&&t.style.setProperty("fill","#999"),e.classList.contains("star-label")&&(e.style.pointerEvents="none")}))},o.prototype.backlogButtonTemplate=function(){var e=this,t=this.createElementChatLog();t.style.textAlign="center";var n=document.createElement("div");n.setAttribute("role","button"),n.setAttribute("tabindex",0),n.style.color=this.Utils.blackOrWhite(this.config.chat_bg_color),t.appendChild(n);var i=document.createTextNode(e.text.backlog);function s(t){var n=t.parentNode.nextElementSibling;-1!=n.firstChild.className.indexOf("chat-system")&&e.removeMe(n),e.addBackLog(t),e.config.backlog.backlog_click++}return n.appendChild(i),o.addClass(n,"backlog-button"),o.clickOrSimilarEvent(n,(function(e){s(e)}),(function(){}),this.elementIframe.contentWindow.document),n.addEventListener("keyup",(function(e){13===e.keyCode&&s(this)})),t},o.prototype.addBackLog=function(e){var t=this,n=t.elementChatLog;t.getBackLog((function(e){if("error"!=e.responseText&&""!=e.responseText){for(var i=t.JSON3.parse(e.responseText),s=n.getElementsByClassName("chat-log"),a=t.getScrollBottom(n),r=[],l=1;l<s.length;l++)r[r.length]=s[l];o.Browser.IE||(n.innerHTML="");var c=[];for(i.length==t.config.backlog.display_count&&(c[c.length]=t.backlogButtonTemplate()),c=c.concat(t.backlogTemplate(i)).concat(r),l=0;l<c.length;l++)n.appendChild(c[l]);if(o.Browser.IE){var d=n.getElementsByClassName("chat-log");n.removeChild(d[0])}t.scrollBottom(n,a),t.stash.afterScrollTop=null,t.stash.scrollBottom=a}}))},o.prototype.backlogTemplate=function(e){var t=[],n=this.elementChatLog,i={icon_id:null,backlogScroll:1};n&&(i.elementLog=n),this.flag.backlog_no_scroll=!0;for(var s=0;s<e.length;s++){var a=new Date(e[s].created_at.replace("Z",""));if(this.config.chat_display_send_time&&(0==s||this.config.backlog.displayed_time.toLocaleString().split(" ")[0]!=a.toLocaleString().split(" ")[0])){this.config.backlog.displayed_time=a;var r="ja"===this.getBrowserLang()&&"ja"===this.config.lang&&!this.config.translate_target_lang,l=this.createElementSystemChatLog(this.Utils.dateFormat(a,r));o.addClass(l.firstChild,"backlog-date"),t[t.length]=l}if("log_type"in e[s]&&"bot"==e[s].log_type){var c={backlogDate:a};!("answer_type"in e[s])||"chatgpt"!=e[s].answer_type&&"chatgpt_doc"!=e[s].answer_type||(c.backlog_type="gpt",c.display_ai_label=!0),t[t.length]=this.sendTemplate(e[s].question_body,"chat-user",c),t[t.length]=this.sendBot(e[s].answer_body,c),"answer_img"in e[s]&&""!=e[s].answer_img&&(t[t.length]=this.sendImageBot(e[s].answer_img,i))}else"log_type"in e[s]&&"operator"==e[s].log_type&&("user"==e[s].chat_type?(i.imageType="user","file_name"in e[s]&&""!=e[s].file_name?(c={img:e[s].file_name,imageType:"operator",icon_id:null,backlogScroll:1,backlogDate:a,log_type:"operator"},t[t.length]=this.sendTemplate("","chat-user",c)):t[t.length]=this.sendUser(e[s].message_body,{backlogDate:a,log_type:"operator"})):"operator"==e[s].chat_type&&(i.imageType="operator","file_name"in e[s]&&""!=e[s].file_name?(c={img:e[s].file_name,imageType:"user",icon_id:null,backlogScroll:1,backlogDate:a,log_type:"operator"},t[t.length]=this.sendTemplate("","chat-bot",c)):t[t.length]=this.sendBot(e[s].message_body,{backlogDate:a,log_type:"operator"})))}return this.flag.backlog_no_scroll=!1,t},o.prototype.getScrollLeft=function(e){return e.scrollWidth-e.clientWidth-e.scrollLeft},o.prototype.getScrollBottom=function(e){return e.scrollHeight-e.clientHeight-e.scrollTop},o.prototype.scrollBottom=function(e,t){e.scrollTop=e.scrollHeight-(e.clientHeight+t)},o.prototype.createElementInput=function(e,t){var n,i=this,s=document.createElement("div"),a=null,r=null,l=null,c=null,d=e+"_"+this.getRandomStr(6);if("type"in t){if(r=this.createElementFormLabel(d,t),"textarea"===t.type.toLowerCase())a=document.createElement("textarea"),n=["id","autofocus","cols","disabled","form","maxlength","name","placeholder","readonly","required","rows","wrap"];else if("select"===t.type.toLowerCase()){a=document.createElement("select");var u=t.select_options,p=document.createElement("option");p.setAttribute("value",""),p.appendChild(document.createTextNode(this.text.form_select_default)),a.appendChild(p),u.forEach((function(e){var t=document.createElement("option");t.setAttribute("value",e),t.appendChild(document.createTextNode(e)),a.appendChild(t)})),n=["id","autofocus","disabled","form","multiple","name","size","required"]}else if("checkbox"==t.type.toLowerCase())(u=t.select_options||[]).length>0?((a=document.createElement("div")).style.margin="0",u.forEach((function(e,n){var o=document.createElement("div");o.style.margin="0";var s=document.createElement("label");s.setAttribute("for",d+"_"+n),s.appendChild(document.createTextNode(e));var r=document.createElement("input");r.setAttribute("type","checkbox"),r.setAttribute("value",s.innerText),r.setAttribute("id",d+"_"+n),r.addEventListener("change",(function(){if("required"===t.required){var e=a.querySelectorAll("input[type=checkbox]");a.querySelectorAll("input[type=checkbox]:checked").length>0?(e[e.length-1].required=!1,i.setFormRequireMessage(e[e.length-1],"")):(e[e.length-1].required=!0,i.setFormRequireMessage(e[e.length-1],i.text.form_checkbox_required))}})),o.appendChild(r),o.style.display="flex",o.appendChild(s),a.appendChild(o)}))):(c=r,r=null,(a=document.createElement("input")).setAttribute("type","checkbox"),a.setAttribute("value",0),a.addEventListener("change",(function(e){a.value=this.checked?1:0})),s.style.display="flex"),n=["id","autofocus","disabled","form","multiple","name","size","required"];else if("radio"===t.type.toLowerCase())(u=t.select_options||[]).length>0&&((a=document.createElement("div")).style.margin="0px",u.forEach((function(e,n){var o=document.createElement("div");o.style.margin="2px 0px";var s=document.createElement("label");s.setAttribute("for",d+"_"+n),s.appendChild(document.createTextNode(e));var r=document.createElement("input");r.setAttribute("type","radio"),r.setAttribute("value",s.innerText),r.setAttribute("id",d+"_"+n),r.setAttribute("name",d),r.addEventListener("change",(function(){if("required"===t.required){var e=a.querySelectorAll("input[type=radio]");a.querySelectorAll("input[type=radio]:checked").length>0?(e[e.length-1].required=!1,i.setFormRequireMessage(e[e.length-1],"")):(e[e.length-1].required=!0,i.setFormRequireMessage(e[e.length-1],i.text.form_checkbox_required))}})),o.appendChild(r),o.style.display="flex",o.appendChild(s),a.appendChild(o)}))),n=["id","autofocus","disabled","form","multiple","name","size","required"];else if("date"===t.type.toLowerCase()){(a=document.createElement("input")).setAttribute("class","datepicker-input"),a.setAttribute("type","date"),a.setAttribute("autocomplete","off"),a.setAttribute("max","9999-12-31");var h=this.html2dom(this.iconCalendarSvg);h.setAttribute("class","calendar-icon"),n=["id","autofocus","disabled","form","readonly","name","placeholder","required"]}else if("file"===t.type.toLowerCase()){var g="image/jpg,image/jpeg,image/png,image/gif,application/pdf,text/plain,text/csv,application/zip,application/x-zip-compressed,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/vnd.ms-excel.sheet.macroenabled.12,application/vnd.ms-excel.sheet.macroEnabled.12";if(t.accept_file_types&&t.accept_file_types.length>0){var m=t.accept_file_types.split(","),_=[];m.forEach((function(e){switch(e){case"image":_=_.concat(["image/jpg","image/jpeg","image/png","image/gif"]);break;case"video":_=_.concat(["video/mp4","video/quicktime"]);break;case"pdf":_=_.concat(["application/pdf"]);break;case"text":_=_.concat(["text/plain"]);break;case"csv":_=_.concat(["text/csv"]);break;case"zip":_=_.concat(["application/zip"]);break;case"docx":_=_.concat(["application/vnd.openxmlformats-officedocument.wordprocessingml.document"]);break;case"xlsx":_=_.concat(["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]);break;case"pptx":_=_.concat(["application/vnd.openxmlformats-officedocument.presentationml.presentation"]);break;case"xlsm":_=_.concat(["application/vnd.ms-excel.sheet.macroenabled.12"])}})),g=_.join(",")}(l=document.createElement("label")).setAttribute("for",d),o.addClass(l,"file-upload-button");var f=i.html2dom(this.fileUploadIconSvg);l.appendChild(f);var y=document.createElement("span");y.textContent=this.text.form_select_file,l.appendChild(y),(a=document.createElement("input")).type="file",a.accept=g,a.style.opacity=0,a.style.height="1px",c=document.createElement("div"),o.addClass(c,"file-upload-size-note"),c.textContent=i.text.form_file_size_over,o.addEventListener(a,"change",(function(e){var t=e.target.files[0];if(t){if(t.size>10485760)return i.displayModalDialog(i.text.form_file_size_over),a.value="",f.innerHTML=i.html2dom(i.fileUploadIconSvg).innerHTML,o.removeClass(f,"img-icon"),void(y.textContent=i.text.form_select_file);if(-1==g.split(",").indexOf(t.type))return i.displayModalDialog(i.text.form_not_support_file),a.value="",f.innerHTML=i.html2dom(i.fileUploadIconSvg).innerHTML,o.removeClass(f,"img-icon"),void(y.textContent=i.text.form_select_file);-1!=t.type.indexOf("image")?(f.innerHTML=i.html2dom(i.iconImageSvg).innerHTML,o.addClass(f,"img-icon")):(f.innerHTML=i.html2dom(i.iconFileSvg).innerHTML,o.addClass(f,"img-icon")),y.textContent=t.name}})),n=["required"]}else if("rating"===t.type.toLowerCase()){(a=document.createElement("div")).value="0",o.addClass(a,"rating-container");var v=document.createElement("div");o.addClass(v,"star-btn-wrapper");var b=document.createElement("ul");o.addClass(b,"star-btn-list"),v.appendChild(b),a.appendChild(v);for(var x=[],w=1;w<=5;w++){var C=document.createElement("input");C.setAttribute("type","radio"),C.setAttribute("name",d),C.setAttribute("value",w),C.setAttribute("id","starRadioBtn_"+d+"_"+w),o.addClass(C,"star-button"),C.style.position="absolute",C.style.opacity="0",b.appendChild(C);var k=document.createElement("li"),I=document.createElement("label");o.addClass(I,"star-label");var B=this.html2dom(this.starOnBtnSvg);I.setAttribute("for","starRadioBtn_"+d+"_"+w),I.appendChild(this.html2dom(this.starOffBtnSvg)),B.style.display="none",I.appendChild(B),k.appendChild(I),b.appendChild(k),x.push(I),o.clickOrSimilarEvent(I,(function(e){var n;if(n=x.indexOf(e)+1,x.forEach((function(e,t){e.childNodes[0].style.display=t+1<=n?"none":"block",e.childNodes[1].style.display=t+1>n?"none":"block"})),"required"===t.required){var o=a.querySelectorAll("input[type=radio]");o[0].required=!1,i.setFormRequireMessage(o[0],"")}}),(function(){}),this.elementIframe.contentWindow.document)}n=["id","autofocus","disabled","form","multiple","name","size","required"]}else{if(!this.checkInputTag(t.type))return;(a=document.createElement("input")).setAttribute("type",t.type);var E=this.getCheckList();for(var S in t)this.checkSetAttribute(S,E[t.type])&&""!==t[S]&&a.setAttribute(S,t[S])}for(var S in t)if("type"!=t&&this.checkSetAttribute(S,n)&&""!==t[S])if("checkbox"==t.type&&t.select_options&&t.select_options.length>0)(T=a.querySelectorAll("input[type=checkbox]"))[T.length-1].setAttribute(S,t[S]),"required"===t.required&&this.setFormRequireMessage(T[T.length-1],this.text.form_checkbox_required);else if("radio"==t.type&&t.select_options&&t.select_options.length>0)(T=a.querySelectorAll("input[type=radio]"))[T.length-1].setAttribute(S,t[S]),"required"===t.required&&this.setFormRequireMessage(T[T.length-1],this.text.form_checkbox_required);else if("rating"==t.type){var T;(T=a.querySelectorAll("input[type=radio]"))[0].setAttribute(S,t[S]),"required"===t.required&&this.setFormRequireMessage(T[0],this.text.operator_feedback_rating_required)}else{var L="input",P=this.text.form_field_required,A=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;"select"===t.type?(L="change",P=this.text.form_select_required):"file"===t.type&&(P=this.text.form_file_required),"required"===t.required?(a.value||0===a.value?a.setCustomValidity(""):i.setFormRequireMessage(a,P),a.addEventListener(L,(function(){a.value||0===a.value?"email"!==t.type||A.test(a.value)?a.setCustomValidity(""):a.setCustomValidity(i.text.form_email_validation):i.setFormRequireMessage(a,P)}))):a.addEventListener(L,(function(){"email"===t.type&&a.value&&!A.test(a.value)&&0!==a.value.length?a.setCustomValidity(i.text.form_email_validation):a.setCustomValidity("")})),a.setAttribute(S,t[S])}}if("submit"!==e&&a.setAttribute("id",d),a.setAttribute("name",e),r&&s.appendChild(r),l&&s.appendChild(l),h){var F=this.config.no_viewport?this.config.no_viewport_scale:1;o.Browser.Firefox&&!this.mobileFlag?a.style.paddingLeft=4*F+"px":a&&(a.style.paddingLeft=32*F+"px",s.appendChild(h))}return s.appendChild(a),c&&s.appendChild(c),s},o.prototype.checkInputTag=function(e){e=e.toLowerCase();var t=this.getCheckList(),n=["id","name","value","style"];for(var i in t)if(i==e)return"non"!=t[i]&&(this.checkListSetAttribute=t[i],this.checkListSetAttribute=this.checkListSetAttribute.concat(n)),!0;return!1},o.prototype.getCheckList=function(){var e=["size","maxlength","autocomplete","pattern","placeholder","readonly","required","list"],t=["size","maxlength","autocomplete","list","max","min","readonly","required","step"];return{hidden:[],text:e,search:e,tel:e,url:e,email:["size","maxlength","autocomplete","pattern","placeholder","readonly","required"],password:["size","maxlength","autocomplete","pattern","placeholder","readonly","required"],datetime:t,data:t,month:t,week:t,time:t,"datatime-local":t,number:t,range:t,color:["autocomplete","list"],checkbox:["checked","required"],date:["required"],radio:["checked","required"],file:["size","accept","multiple","required"],submit:["formaction","formenctype","formmethod","formnovalidate","formtarget"],image:["src","alt","height","width","formaction","formenctype","formmethod","formnovalidate","formtarget"],reset:"non",button:[]}},o.prototype.setFormRequireMessage=function(e,t){e.setCustomValidity(t)},o.prototype.checkSetAttribute=function(e,t){if(t&&this.AnalyticsTagCommon.isArray(t)){for(var n in t)if(t.hasOwnProperty(n)&&""!==t[n]&&t[n]===e)return!0}else if(this.checkListSetAttribute&&this.AnalyticsTagCommon.isArray(this.checkListSetAttribute))for(var n in this.checkListSetAttribute)if(this.checkListSetAttribute.hasOwnProperty(n)&&""!==this.checkListSetAttribute[n]&&this.checkListSetAttribute[n]===e)return!0;return!1},o.prototype.createElementFormLabel=function(e,t){var n=null;if("label"in t){if(n=document.createElement("label"),"string"==typeof t.label)n.appendChild(document.createTextNode(t.label));else{var i=["style","title"];for(var o in t.label)this.checkSetAttribute(o,i)&&""!==t.label[o]&&n.setAttribute(o,t.label[o]);if(t.label.text&&(n.innerHTML=this.textEncoder.convertToBotChatText(t.label.text)),t.label.require_text){if("string"==typeof t.label.require_text){var s="ja"==this.config.lang?t.label.require_text:"*";t.label.require_text={text:s,fontSize:"0.7em",marginLeft:"4px",color:"#d9534f"}}n.appendChild(this.getCustomFormLabel(t.label.require_text))}}n.setAttribute("for",e)}return n},o.prototype.sendFormData=function(e){var t=this.checkSendDomList(e),n=this,i=(o.documentIframe=n.elementIframe.contentWindow.document).getElementsByTagName("form"),s=(i=i[i.length-1]).parentElement;s.style.position="relative";var a=document.createElement("div");a.style.lineHeight=a.style.height=n.getRect(i).height+"px",a.style.width=a.style.width=n.getRect(i).width+"px",o.addClass(a,"sending-form");var r=document.createElement("div");o.addClass(r,"connection-loader"),r.style.top="20%";var l=document.createTextNode("送信中");r.appendChild(l),a.appendChild(r);var c=o.getData(e,"mid");return s.appendChild(a),this.sendFormLog((function(t){if("error"!=t.responseText&&""!=t.responseText){var i,o=n.JSON3.parse(t.responseText),r=n.elementChatLog;s.removeChild(a),n.disableForm(e),"restart"===o.result.type&&o.result.hasOwnProperty("message")&&""!==o.result.message||o.result.hasOwnProperty("message")&&""!==o.result.message||(o.result.message="送信が完了しました"),""!==(i=o.result.message)&&r.appendChild(n.sendBot(i)),"restart"===o.result.type&&n.restartTalk(1500),n.scrollAuto(r,r.scrollTop,n)}else n.errorTalkFunction({message:n.text.error_talk_form,that:n})}),t,c),!1},o.prototype.sendCustomFormData=function(e){var t=this.checkSendDomList(e),n=this,i=(o.documentIframe=n.elementIframe.contentWindow.document).getElementsByTagName("form"),s=(i=i[i.length-1]).parentElement;s.style.position="relative";var a=document.createElement("div");a.style.lineHeight=a.style.height=n.getRect(i).height+"px",a.style.width=a.style.width=n.getRect(i).width+"px",o.addClass(a,"sending-form");var r=document.createElement("div");o.addClass(r,"connection-loader"),r.style.top="20%";var l=document.createTextNode("送信中");r.appendChild(l),a.appendChild(r);var c=o.getData(e,"mid");return s.appendChild(a),this.sendCustomFormLog((function(t){if("error"!=t.responseText&&""!=t.responseText){var i,o=n.JSON3.parse(t.responseText),r=n.elementChatLog;if(s.removeChild(a),n.disableForm(e),"restart"===o.result.type&&o.result.hasOwnProperty("message")&&""!==o.result.message||o.result.hasOwnProperty("message")&&""!==o.result.message||(o.result.message="送信が完了しました"),""!==(i=o.result.message)&&r.appendChild(n.sendBot(i)),o.list.length>0){var l=n.parseSendList(o.list);r.appendChild(n.sendListTemplate(l))}"restart"===o.result.type&&n.restartTalk(1500);var c=o.list.length>0?1:void 0;n.scrollAuto(r,r.scrollTop,n,c)}else n.errorTalkFunction({message:n.text.error_talk_form,that:n})}),t,c,e),!1},o.prototype.checkSendDomList=function(e){var t=["div","input","textarea","select"],n=["reset","submit"],i=[],o=[],s=[];for(var a in t)if(t.hasOwnProperty(a)){if(s=e.getElementsByTagName(t[a]),"input"==t[a]){o=[];for(var r=!0,l=0;l<s.length;l++){for(var c in r=!0,n)n.hasOwnProperty(c)&&n[c]==s[l].getAttribute("type").toLowerCase()&&(r=!1);r&&null!=s[l].getAttribute("name")&&-1==s[l].getAttribute("id").indexOf("starRadioBtn")&&(o[o.length]=s[l])}s=o}else if("div"==t[a]){for(o=[],l=0;l<s.length;l++)s[l].getAttribute("id")&&(o[o.length]=s[l]);s=o}else{for(o=[],l=0;l<s.length;l++)o[o.length]=s[l];s=o}i=i.concat(s)}return i},o.prototype.insertWidgetForPage=function(){if(this.config.site_in){var e=document.getElementById(this.config.target_id);if(!e)return!1;if(this.config.fullscreen){var t=document.querySelector("body");this.parentBodyStyle=t.getAttribute("style"),t.setAttribute("style","overflow: hidden; margin: 0px;"),this.elementIframe.height=window.innerHeight}else e.style.height?(this.elementIframe.height=e.style.height,this.flag.popup_modal&&(this.elementIframe.height=e.clientHeight)):this.elementIframe.height=this.config.inner.height;e.style.width||(e.style.width="auto"),e.style.width?(this.elementIframe.width=e.clientWidth,0==this.elementIframe.width&&(this.elementIframe.width=e.offsetWidth-2)):this.elementIframe.width=this.config.inner.width,e.appendChild(this.elementIframe)}else document.body.appendChild(this.elementIframe);return!0},o.prototype.setWidgetWindowColor=function(e){var t=null,n=this.elementIframe.contentWindow.document;this.mobileFlag?(t=n.getElementById("_ul-widget"),n.getElementById("_ul-widget-btn")):t=n.getElementById("_ul-widget");var i=n.getElementById("_ul-chat-widget");e.widget_bg_color&&this.isColor(e.widget_bg_color)&&(t.style.background=e.widget_bg_color),e.chat_bg_color&&this.isColor(e.chat_bg_color)&&(i.style.background=e.chat_bg_color);var o=n.getElementById("_ul-widget-head-title"),s=document.createTextNode(this.config.title);e.title_text_color&&this.isColor(e.title_text_color)&&(o.style.color=e.title_text_color);var a=n.getElementsByClassName("ul-widget-lamp")[0].childNodes[0];e.widget_lamp_color&&this.isColor(e.widget_lamp_color)&&(this.config.lamp_color=e.widget_lamp_color,a.style.background=e.widget_lamp_color);var r=n.getElementsByClassName("ul-widget-close-btn")[0];if(r){var l=r.childNodes[0];e.widget_close_color&&this.isColor(e.widget_close_color)&&(this.mobileFlag?l.style.color=e.widget_close_color:l.style.background=e.widget_close_color)}o.appendChild(s)},o.prototype.getRect=function(e){return e.getBoundingClientRect()},o.prototype.addElementWhiteSpace=function(e,t,n,i,o,s){if(i>=0){var a=function t(){var n=0;u<=1?(c<=1&&(g?n=1:clearInterval(l),o.removeElementWhiteSpace(e),i=o.resizeElementWhiteSpace(e,i),o.renderWidget||o.initRunPushEvent()),i=parseInt(100*(i+d))/100,e.scrollTop=i,c--):(p>0&&(p-=h,r.style.height=p+"px"),u--),g&&(n?o.cancelAnimationFrame(l):o.requestAnimationFrame(t))};switch(!0){case s>0:break;case"slow"==s:s=64;break;case"normal"==s:s=32;break;case"first"==s:s=16;break;default:s=32}e.scrollTop=i;var r,l,c=parseInt(o.renderFrame*(o.animationFPS/60)),d=parseInt((n-i)/c*100)/100,u=0,p=0,h=0;e.getElementsByClassName("whiteSpace").length>0&&(r=e.getElementsByClassName("whiteSpace")[e.getElementsByClassName("whiteSpace").length-1],parseInt(o.getRect(r).height)>0&&(p=o.getRect(r).height,h=p/u));var g=!1;this.isRequestAnimationFrame()&&this.isCancelAnimationFrame()?(g=!0,l=this.requestAnimationFrame(a)):l=setInterval(a,s)}else e.scrollTop=n},o.prototype.resizeElementWhiteSpace=function(e,t){var n=e.getElementsByClassName("initWhiteSpace")[0],i=this.elementIframe.contentWindow.document;if(void 0!==n){var o=this.getRect(n),s=o.top,a=o.height+s-8,r=i.getElementById("__ul_operator_announce");this.config.site_in||(a-=32),r&&(a-=this.getRect(r).height),this.cookieBanner&&this.cookieBanner.isShown()&&(a-=54),this.config.site_in||this.flag.check_open?(a<=0?(t=this.getScrollBottom(e),this.removeElementInitWhiteSpace(e),t=e.scrollHeight-(e.clientHeight+t)):(n.style.height=a+"px",t=this.getRect(n).top),this.flag.first_open=!1):this.config.site_in||this.flag.check_open||this.mobileFlag||!this.config.default_open||(this.flag.check_open=!0,a<=0?(t=this.getScrollBottom(e),this.removeElementInitWhiteSpace(e),t=e.scrollHeight-(e.clientHeight+t)):(n.style.height=a+"px",t=this.getRect(n).top))}return t},o.prototype.removeElementInitWhiteSpace=function(e){for(var t=e.getElementsByClassName("initWhiteSpace"),n=t.length,i=0;i<n;i++)t[i].parentNode.removeChild(t[i])},o.prototype.removeElementWhiteSpace=function(e){for(var t=e.getElementsByClassName("whiteSpace"),n=t.length,i=0;i<n;i++)t[i].parentNode.removeChild(t[i])},o.prototype.scrollAuto=function(e,t,n,i){var o=e.children,s=!1,a=!1;void 0===i?a=i=1:((a=i+=1)>o.length&&(a=i=o.length-1),o[o.length-i]&&(s=n.getRect(o[o.length-i])),i=1);var r=!1;if(o[o.length-i]){r=n.getRect(o[o.length-i]);var l=n.getRect(e).height,c=n.stash.afterScrollTop=e.scrollTop+r.top+r.height+16-l,d=40;n.config.site_in||(d=80);for(var u=0,p=o.length-1;p>=o.length-a;p--)u+=n.getRect(o[p]).height;if(s&&u>l-d){if(c=n.stash.afterScrollTop=e.scrollTop+s.top+4,!n.config.site_in){var h=n.elementIframe.contentWindow.document,g=h.getElementById("ul-widget-header");g||(g=h.getElementById("v2PopupHeader"));var m=n.getRect(g).height;c=n.stash.afterScrollTop=n.stash.afterScrollTop-m}n.config.site_in&&n.isTranslateEnabled()&&n.languageHeader?c=n.stash.afterScrollTop=n.stash.afterScrollTop-(n.languageHeader.getHeight()+4):n.flag.popup_modal&&(c=n.stash.afterScrollTop=n.stash.afterScrollTop-(n.modalHeader.getHeight()+4));var _=o[o.length-i],f=_.currentStyle||window.getComputedStyle(_);c=n.stash.afterScrollTop=c-(parseInt(f.marginTop)+parseInt(f.marginBottom))}n.config.animation?n.addElementWhiteSpace(e,l,c,t,n,1e3/n.animationFPS):(e.scrollTop=c,e.scrollTop=n.resizeElementWhiteSpace(e,c),n.renderWidget||n.initRunPushEvent())}},o.prototype.setParam=function(e,t){this.config[e]=t},o.prototype.getParam=function(e){return this.config[e]},o.prototype.current=function(e){if(document.currentScript&&document.currentScript.src)return document.currentScript.src;for(var t=document.getElementsByTagName("script"),n=[],i=0;i<t.length;i++)t[i].src.match(/\/chatbot.js$/)&&n.push(t[i].src);return 1!==n.length?e:n[0]},o.prototype.sendStreamRequest=function(e,t,n){fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:t}).then((function(e){n.callback(e)})).catch((function(){n.errorFunction(n.errorFunctionOption)}))},o.prototype.sendRequest=function(e,t,n){if(-1==e.indexOf("/view")&&-1==e.indexOf("/log")&&!this.config.no_cookie){var s,a=(new Date).getTime()-this.lastSessionUpdateTime>18e5;!o.getCookieValue("__ulfps")&&a&&(this.sessionId=this.getRandomStr(16),t instanceof FormData?o.Browser.IE||((s=this.JSON3.parse(t.get("json"))).session=this.sessionId,t.set("json",this.JSON3.stringify(s))):((s=this.JSON3.parse(decodeURIComponent(t.replace(/^json=/,"").replace(/\+/g,"%20")))).session=this.sessionId,t=this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(s)}))),o.setCookie(this.fp_name,this.fp,this.fp_period,this.fp_domains,this.config.cross_domain),o.setCookie("__ulfps",this.sessionId,1800,this.fp_domains,this.config.cross_domain),this.lastSessionUpdateTime=(new Date).getTime()}this.cookieBanner&&this.cookieBanner.hide();var r={method:"POST",async:!0,callback:function(){},errorFunction:function(){},errorFunctionOption:{},xDomainNonError:!1,xhrErrorStrictConditions:!1,contentType:"application/x-www-form-urlencoded; charset=UTF-8"},l={};if("object"===(void 0===n?"undefined":i(n)))for(var c in r)r.hasOwnProperty(c)&&(l[c]=r[c],n.hasOwnProperty(c)&&n[c]!==r[c]&&(l[c]=n[c]));else l=r;n=l;var d=this.createHttpRequest(),u=d[0];if("xDomain"!=d[1])u.onreadystatechange=function(){4==u.readyState&&200==u.status?n.callback(u):4==u.readyState&&n.errorFunction&&"function"==typeof n.errorFunction&&((!n.xhrErrorStrictConditions||500!=u.status&&501!=u.status&&502!=u.status&&503!=u.status&&504!=u.status&&505!=u.status&&506!=u.status&&507!=u.status&&508!=u.status&&509!=u.status&&510!=u.status)&&n.xhrErrorStrictConditions||n.errorFunction(n.errorFunctionOption))},u.open(n.method,e,n.async),n.contentType&&u.setRequestHeader("Content-Type",n.contentType),u.timeout=this.xmlHttpRequestTimeout,u.send(t||null);else{var p="https:"===document.location.protocol?"https://":"http://";e=e.replace(/https?:\/\//,p),u.timeout=this.xmlHttpRequestTimeout,u.onprogress=function(){},u.onload=function(){n.callback(u)},u.ontimeout=function(){n.xDomainNonError||n.errorFunction(n.errorFunctionOption)},u.onerror=function(){n.xDomainNonError||n.errorFunction(n.errorFunctionOption)},u.open(n.method,e),u.send(t||null)}},o.prototype.createHttpRequest=function(){var e=null,t=null;if(window.XMLHttpRequest){e=new XMLHttpRequest,t="xmlHttp";try{e.withCredentials=!0}catch(e){}}else e=new XDomainRequest,t="xDomain";return[e,t]},o.prototype.errorTalkFunction=function(e){if(!("message"in e)&&!e.message)return!1;if("that"in e&&e.that)var t=e.that;var n=t.elementChatLog;n.appendChild(t.sendBot(e.message,{icon_id:0,target_chatlog:e.targetChatLog}));var i=t.elementIframe.contentWindow.document.getElementsByTagName("form");if(i&&0 in i){var o=(i=i[i.length-1]).parentElement.querySelector(".sending-form");t.disableForm(i),o&&o.parentElement.removeChild(o)}setTimeout((function(){var e=n.scrollTop;t.scrollAuto(n,e,t),t.stash.afterScrollTop=null}),t.config.response_time),t&&e.type&&t.sendSurveyLog({event_type:"error",error_message:"request error - "+e.type})},o.prototype.errorViewFunction=function(e){if(void 0===e)return!1;if(e.hasOwnProperty("that")&&e.that)var t=e.that;t&&t.execCustomEvent("init_error")},o.prototype.errorConnectFunction=function(e){if(!("message"in e)&&!e.message)return!1;if("that"in e&&e.that)var t=e.that;var n=t.elementChatLog;n.appendChild(t.sendBot(e.message,{icon_id:0,target_chatlog:e.targetChatLog}));var i=t.elementIframe.contentWindow.document.getElementsByTagName("form");if(i&&0 in i){var o=(i=i[i.length-1]).parentElement.querySelector(".sending-form");t.disableForm(i),o&&o.parentElement.removeChild(o)}setTimeout((function(){var e=n.scrollTop;t.scrollAuto(n,e,t),t.stash.afterScrollTop=null}),t.config.response_time),t&&e.type&&t.sendSurveyLog({event_type:"error_alert",error_message:"request error - "+e.type})},o.prototype.initRunPushEvent=function(){var e=this;setTimeout((function(){if(e.flag.maintenance){var t={};e.config.maintenance.image&&(e.config.bot_img[10]=e.config.maintenance.image,t.icon_id=10),!1===e.flag.send_maintenance&&(e.flag.send_maintenance=!0,e.maintenanceMode(e.text.maintenance,t))}else e.runPushEvent();e.renderWidget=!0}),this.config.response_time/2)},o.prototype.isFontSize=function(e){if(!e)return!1;var t=document.createElement("div");return t.style.fontSize=e,t.style.fontSize===e},o.prototype.isSize=function(e){if(!e)return!1;var t=document.createElement("div");return t.style.width=e,t.style.width===e},o.prototype.isOpenWidget=function(){return this.config.site_in||!this.config.site_in&&this.flag.open},o.prototype.isTranslateEnabled=function(){return(0===this.config.translate_status||1===this.config.translate_status&&this.config.testMode.use)&&Object.keys(this.config.translated).length>0&&!this.flag.maintenance&&5!==this.config.gpt_doc_mode},o.prototype.isMenuEnabled=function(){return(1==this.config.gpt_mode||1==this.config.gpt_doc_mode||0!=this.config.menu_items.length)&&!this.flag.maintenance},o.prototype.changeLogSize=function(){var e=this;if(!this.config.site_in&&this.config.display_input_box&&o.Os.iOs&&o.Browser.Chrome){var t=window.innerHeight;setTimeout((function(){var n=e.elementIframe.contentWindow.document,i=n.getElementById("_ul-main-window").clientHeight-n.getElementById("ul-widget-header").clientHeight-76;t>e.windowSize.height&&(i-=64,e.elementChatLog.style.height=i+"px")}),500)}},o.prototype.maintenanceMode=function(e,t){void 0===t&&(t={});var n=this.elementChatLog;n.appendChild(this.sendBot(e,t));var i=n.scrollTop;this.scrollAuto(n,i,this)},o.prototype.autoFocus=function(e){"string"==typeof e&&(this.mobileFlag||this.elementIframe.contentWindow.document.getElementById(e).focus())},o.prototype.changeTestMode=function(){for(var e=["first_list"],t="",n=0;n<e.length;n++)t=this.config.testMode.before+e[n]+this.config.testMode.after,this.params.hasOwnProperty(t)&&this.AnalyticsTagCommon.isArray(this.params[t])&&(this.params[e[n]]=this.params[t]);0!==this.config.translate_status&&1!==this.config.translate_status||!this.config.translated[this.config.translate_target_lang]||(this.params.first_list=this.config.translated[this.config.translate_target_lang].first_list_test||this.config.translated[this.config.translate_target_lang].first_list)},o.prototype.restartTalk=function(e){this.flag.funnel_init=!0,this.stash.funnelQuestion="",this.setSelectedCid(null),this.initTalk(this.elementChatLog,e,!0)},o.prototype.disableBeforeChatLogs=function(){for(var e=this.elementIframe.contentWindow.document.getElementsByClassName("chat-log"),t=0;t<e.length;t++){e[t].style.pointerEvents="none",e[t].style.opacity="0.6";var n=e[t].getElementsByTagName("li");if(0!==n.length)for(var i=0;i<n.length;i++)n[i].setAttribute("tabIndex","-1")}},o.prototype.getTranslateLangList=function(){var e=this,t=[],n=Object.keys(e.config.translated),i={ja:"日本語",en:"English","zh-cn":"中文(简体)","zh-tw":"中文(繁體)"};return n.forEach((function(t){i[t]=e.config.translated[t].lang_display_name})),-1===n.indexOf(e.config.lang)&&n.unshift(e.config.lang),-1===n.indexOf("ja")&&-1!==e.config.translate_lang_list.indexOf("ja")&&n.unshift("ja"),n.forEach((function(e){t.push({code:e,text:i[e]?i[e]:e})})),t},o.prototype.toggleLanguageMenu=function(){var e=this,t=e.elementIframe.contentWindow.document;if(e.languageMenu)e.languageMenu.toggle();else{e.languageMenu=new e.LanguageMenu({langList:e.getTranslateLangList(),clickLangEvent:function(t){e.config.translate_target_lang=t.code,e.cookieBanner&&e.cookieBanner.hide(),e.disableBeforeChatLogs(),e.setTranslateLang(),e.restartTalk()},updateAriaEvent:function(n){var i=e.config.site_in?t.getElementById("v2SiteInTranslateBtn"):t.getElementById("v2PopupTranslateBtn");i&&i.setAttribute("aria-expanded",n)}});var n,i="#languageMenu",s=t.getElementById("_ul-widget");if(o.addEventListener(s,"click",(function(n){e.Utils.getClosestElement(n.target,i,t)||e.languageMenu.hide()})),o.addEventListener(s,"keyup",(function(n){13===n.keyCode&&(e.Utils.getClosestElement(n.target,i,t)||e.languageMenu.hide())})),e.config.site_in)n=t.getElementById("v2SiteInTranslateBtn"),e.languageMenu.setStyleTop(e.languageHeader.getButtonHeight()+e.languageHeader.getButtonMarginBottom()+2+"px"),n.appendChild(e.languageMenu.getElement());else(n=e.isMenuEnabled()?t.getElementById("v2PopupMenuBtn"):t.getElementById("v2PopupTranslateBtn")).parentNode.insertBefore(e.languageMenu.getElement(),n.nextSibling),e.languageMenu.setStyleTop(e.v2Header.getHeaderTopHeight()+4+"px"),e.languageMenu.setStyleRight("4px")}},o.prototype.toggleMenu=function(){var e=this,t=e.elementIframe.contentWindow.document,n=1===e.config.gpt_mode,i=1===e.config.gpt_doc_mode;if(0===e.config.gpt_mode&&(e.text.gpt_doc_mode=e.text.gpt_mode),e.menu)e.menu.toggle();else{e.menu=new e.Menu({siteInFlag:e.config.site_in,translateBtnFlag:e.isTranslateEnabled(),translatedFlag:e.config.translate_target_lang,gptBtnFlag:n,gptDocBtnFlag:i,reloadBtnFlag:e.config.reload_btn,restartText:e.text.tooltip_restart_button,gptText:e.text.gpt_mode,gptDocText:e.text.gpt_doc_mode,translateText:e.text.translate_select,customMenuItems:e.config.menu_items,aiSparkleSvg:this.aiSparkleSvg,clickReloadBtn:function(t){return t.stopPropagation(),e.restartBtnEvent(),!1},clickGptBtn:function(t){return e.enterGptMode(t),!1},clickTranslateBtn:function(){return e.toggleLanguageMenu(),!1},clickCustomMenu:function(){e.menu.hide()}});var s="#v2Menu",a=t.getElementById("_ul-widget");o.addEventListener(a,"click",(function(n){e.Utils.getClosestElement(n.target,s,t)||e.menu.hide()})),o.addEventListener(a,"keyup",(function(n){13===n.keyCode&&(e.Utils.getClosestElement(n.target,s,t)||e.menu.hide())}));var r=e.elementChatLog.offsetHeight+"px";if(e.menu.setMaxHeight(r),e.config.site_in){(c=t.getElementById("v2SiteInMenuBtn")).appendChild(e.menu.getElement());var l=e.menu.getHeight();e.menu.getHeight()>r&&(l=r),e.menu.setStyleTop(1-l-4+"px"),e.menu.setStyleLeft("2px")}else{var c;(c=t.getElementById("v2PopupMenuBtn")).parentNode.insertBefore(e.menu.getElement(),c.nextSibling),e.menu.setStyleTop(e.v2Header.getHeaderTopHeight()+4+"px"),e.menu.setStyleRight("4px")}}},o.prototype.addPreChat=function(){var e=this,t=document.createElement("div");o.addClass(t,"pre-chat"),this.config.site_in&&o.addClass(t,"pre-chat-sitein"),t.setAttribute("id","preChat"),t.style.position="absolute",t.style.left="1px",t.style.width=this.elementIframe.clientWidth-3+"px",t.style.height=this.elementIframe.clientHeight-(this.config.site_in?4:this.config.popup.pc_header_height)+"px",t.style.zIndex="10005",t.style.top=(this.config.site_in?1:this.config.popup.pc_header_height)+"px",this.config.site_in||this.config.default_open||2!==this.config.widget_version||(t.style.display="none",t.style.height="0px",t.style.left="0px");var n=document.createElement("div");o.addClass(n,"pre-chat-background"),this.setCssStyle(".pre-chat-background","background: "+this.config.chat_bg_color),this.config.chat_bg_img_url&&(this.setCssStyle(".pre-chat-background",'background-image: url("'+e.config.chat_bg_img_url+'") !important'),this.setCssStyle(".pre-chat-background","background-repeat: repeat !important")),t.appendChild(n);var i=document.createElement("div");o.addClass(i,"pre-chat-dialog"),i.setAttribute("id","preChatDialog"),i.style.display="none",t.appendChild(i);var s=document.createElement("p");s.style.whiteSpace="pre-line",s.innerHTML=this.textEncoder.convertToBotChatText(this.config.pre_chat.message),i.appendChild(s);var a=o.prototype.getBrowserLang(),r=[];if(this.config.pre_chat.use&&(r.push({name:{type:"text",placeholder:"",label:{text:"ja"==a?this.text.form_name_label:"Name"}}},{email:{type:"email",placeholder:"example@example.com",label:{text:"ja"==a?this.text.form_email_label:"Email Address"}}}),this.config.pre_chat.required&&(r[0].name.required="required",r[0].name.label.require_text="*",r[1].email.required="required",r[1].email.label.require_text="*")),this.config.pre_chat.custom_flag&&(r.push({optional_info:{type:"text",label:{text:this.config.pre_chat.custom_question}}}),this.config.pre_chat.custom_required)){var l=r[this.config.pre_chat.use?2:0].optional_info;l.required="required",l.label.require_text="*"}var c=this.createElementForm(r,"sendPreChatData",null,!0);this.setCssStyle('.pre-chat-dialog form input[type="submit"]',"background: "+this.config.submit_bg_color+" !important"),i.appendChild(c),this.elementIframe.contentWindow.document.getElementById("_ul-widget").appendChild(t),!e.config.display_cookie_consent||e.flag.used_cookie||e.config.no_cookie||(e.cookieBanner=new e.CookieBanner({bannerText:e.text.cookie_banner,backgroundColor:2==e.config.widget_version?"#ffffff":e.config.chat_bg_color,siteIn:e.config.site_in}),t.appendChild(e.cookieBanner.getElement())),this.renderWidget=!0},o.prototype.getBrowserLang=function(){var e="ja";return window.navigator&&(e=window.navigator.languages&&window.navigator.languages[0]||window.navigator.language||window.navigator.userLanguage||window.navigator.browserLanguage),-1!==e.indexOf("-")&&-1===["zh-CN","zh-TW"].indexOf(e)&&(e=e.split("-")[0]),e},o.prototype.addLangSelectFirstChat=function(){var e=this,t=this.elementIframe.contentWindow.document,n=this.elementChatLog,i="言語を選択してください。";if("ja"===this.getBrowserLang()&&"ja"===this.config.lang||(i="Please select a language. "),this.config.translate_lang_select_message&&(i=this.config.translate_lang_select_message),i+="<br>( Translated by Google )",2===e.config.widget_version);else{var s=t.getElementById("_ul-widget-head-title");s&&(s.textContent="")}2===e.config.widget_version?(this.v2InputBox.hideInput(),this.quickSearchMenu&&this.quickSearchMenu.hide(),this.v2ResizeChatLogHeight()):this.disableInputForm(),2===e.config.widget_version&&(e.config.site_in?e.languageHeader.changeLangSelectMode():e.v2Header.changeLangSelectMode());var a=Object.keys(this.config.translated),r={ja:"日本語",en:"English","zh-cn":"中文(简体)","zh-tw":"中文(繁體)"};a.forEach((function(t){r[t]=e.config.translated[t].lang_display_name})),-1===a.indexOf(this.config.lang)&&a.unshift(this.config.lang),-1===a.indexOf("ja")&&-1!==e.config.translate_lang_list.indexOf("ja")&&a.unshift("ja");var l=this.createElementChatLog(),c=document.createElement("ul");function d(t){e.config.translate_target_lang=t,e.cookieBanner&&e.cookieBanner.hide(),l.style.pointerEvents="none",l.style.opacity="0.6";var n=l.getElementsByTagName("li");if(0!==n.length)for(var i=0;i<n.length;i++)n[i].setAttribute("tabIndex","-1");e.setTranslateLang(),e.restartTalk()}o.addClass(c,"chat-log-group-list"),a.forEach((function(t){var n=document.createElement("li"),i=document.createElement("span");if(n.setAttribute("role","button"),n.setAttribute("tabIndex","0"),o.setData(n,"value",t),!e.mobileFlag&&e.config.list_layout.before_icon_display){var s=document.createElement("span");o.addClass(s,"list-layout-before"),n.appendChild(s)}o.addClass(i,"text"),i.textContent=r[t]?r[t]:t,n.appendChild(i),c.appendChild(n)})),l.appendChild(c);for(var u=0;u<c.childElementCount;u++)o.clickOrSimilarEvent(c.childNodes[u],(function(e){e.blur(),d(o.getData(e,"value"))}),(function(){}),this.elementIframe.contentWindow.document),o.addEventListener(c.childNodes[u],"keyup",(function(e){13===e.keyCode&&d(o.getData(this,"value"))}));setTimeout((function(){var t=1;if(!e.config.remove_space){var s=document.createElement("div");o.addClass(s,"initWhiteSpace"),s.style.height=e.getRect(n).height+"px",e.config.site_in?parseInt(s.style.height)<=0&&(s.style.height=e.config.inner.height):s.style.height=e.config.out.height,n.appendChild(s)}e.config.backlog.view&&(n.appendChild(e.backlogButtonTemplate()),t++),n.appendChild(e.sendBot(i)),n.appendChild(l),setTimeout((function(){e.isOpenWidget()&&e.scrollAuto(n,n.scrollTop,e,t)}),100)}),300)},o.prototype.changeTranslateLang=function(e){this.isTranslateEnabled()&&(this.config.translate_target_lang==e||!this.config.translate_target_lang&&e==this.config.lang||(this.config.translate_target_lang=e,this.disableBeforeChatLogs(),this.setTranslateLang(),this.restartTalk()))},o.prototype.setTranslateLang=function(){var e=this.elementIframe.contentWindow.document,t=e.getElementById("_ul-widget-head-title"),n=e.getElementById("_ul-chat-widget"),i=e.getElementById("_ul-chat-widget-chat-send"),o=this.elementChatLog;return 2===this.config.widget_version&&(!this.config.site_in&&this.isOpenWidget()?this.v2Header.changeUnLangSelectMode():this.languageHeader&&this.languageHeader.changeUnLangSelectMode()),this.config.translate_target_lang===this.config.lang||-1===Object.keys(this.config.translated).indexOf(this.config.translate_target_lang)?(t&&(t.textContent=this.config.title),this.config.translate_target_lang=null,this.params.first_talk=this.config.first_talk,this.params.first_list=this.config.first_list,this.paramInit(this.params,this.langParams),this.config.display_input_box&&(this.enableInputForm(this.text.input_placeholder),i||(this.v2InputBox.show(),this.v2ResizeChatLogHeight())),this.quickSearchMenu&&(this.quickSearchMenu.show(),this.v2ResizeChatLogHeight()),2===this.config.widget_version&&this.config.reload_btn&&this.config.site_in&&this.languageHeader.setBtnText(this.text.tooltip_restart_button),this.v2InputBox&&(this.v2InputBox.setBtnText(this.text.input_button_value),this.v2InputBox.setPlaceholderText(this.text.input_placeholder,this.text.line_break_placeholder)),this.v2OperatorInputBox&&(this.v2OperatorInputBox.setBtnText(this.text.input_button_value),this.v2OperatorInputBox.setPlaceholderText(this.text.input_placeholder,this.text.line_break_placeholder)),2===this.config.widget_version&&this.menu&&this.menu.setText({restartText:this.text.tooltip_restart_button,gptText:this.text.gpt_mode,gptDocText:this.text.gpt_doc_mode,translateText:this.text.translate_select}),void o.setAttribute("lang",this.config.lang)):(i?(n&&(n.style.height=this.mobileFlag?parseInt(n.style.height)+i.clientHeight+"px":"100%"),o.style.height=parseInt(o.style.height)+i.clientHeight+"px",this.removeMe(i),this.config.display_input_box=!1,this.mobileFlag||(o.style.maxHeight="100%")):this.v2InputBox&&(this.v2InputBox.hideInput(),this.quickSearchMenu&&this.quickSearchMenu.hide(),this.v2ResizeChatLogHeight()),"ja"===this.config.translate_target_lang&&-1===Object.keys(this.config.translated).indexOf("ja")?(t&&(t.textContent=this.config.title),void(this.config.translate_target_lang=null)):(this.paramInit({},this.config.translated[this.config.translate_target_lang].lang_text),this.params.first_talk=this.config.translated[this.config.translate_target_lang].first_talk,this.params.first_list=this.config.translated[this.config.translate_target_lang].first_list,2===this.config.widget_version&&this.config.reload_btn&&this.config.site_in&&this.languageHeader.setBtnText(this.text.tooltip_restart_button),this.v2InputBox&&(this.v2InputBox.setBtnText(this.text.input_button_value),this.v2InputBox.setPlaceholderText(this.text.input_placeholder)),this.v2OperatorInputBox&&(this.v2OperatorInputBox.setBtnText(this.text.input_button_value),this.v2OperatorInputBox.setPlaceholderText(this.text.input_placeholder,this.text.line_break_placeholder)),2===this.config.widget_version&&this.menu&&(0===this.config.gpt_mode&&(this.text.gpt_doc_mode=this.text.gpt_mode),this.menu.setText({restartText:this.text.tooltip_restart_button,gptText:this.text.gpt_mode,gptDocText:this.text.gpt_doc_mode,translateText:this.text.translate_select})),void o.setAttribute("lang",this.config.translate_target_lang)))},o.prototype.setSelectedCid=function(e){this.stash.selectedCid=e,this.stash.suggest&&this.stash.suggest.setOptions({selectedCid:e})},o.prototype.enterOperatorMode=function(e,t,n,i,o,s){var a=this,r="first"===e;t=t||"",n=n||0===n?n:"",i=i||0===i?i:"",o=o||0===o?o:"",s=s||function(){};var l=2===this.config.widget_version&&-1!==[648,2807,2808].indexOf(this.config.id)&&-1!==["ja","en","zh-CN","zh-TW"].indexOf(this.config.translate_target_lang);!this.config.translate_target_lang||l?this.config.operator.connect_confirm?this.addConnectOperatorSelect(e,(function(){a.connectOperator(r,t,n,i,o)}),s):this.connectOperator(r,t,n,i,o):this.sendBotChatLog("Operator chat is not supported in this language")},o.prototype.addConnectOperatorSelect=function(e,t,n){var i="first"===e;this.sendBotChatLog(this.text.operator_connect_confirm,"scenario"!=e),i&&this.disableInputForm();var s=this.createElementChatLog(),a=document.createElement("ul");o.addClass(a,"chat-log-group-list"),s.appendChild(a);var r=document.createElement("li"),l=document.createElement("span");if(o.addClass(l,"text"),r.setAttribute("role","button"),r.setAttribute("tabIndex","0"),l.textContent=this.text.operator_connect_button,r.appendChild(l),a.appendChild(r),o.clickOrSimilarEvent(r,(function(){t()}),(function(){}),this.elementIframe.contentWindow.document),r.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),t())})),!i){var c=document.createElement("li"),d=document.createElement("span");o.addClass(d,"text"),c.setAttribute("tabIndex","0"),d.textContent=this.text.operator_connect_cancel_button,c.appendChild(d),a.appendChild(c),o.clickOrSimilarEvent(c,(function(){n()}),(function(){}),this.elementIframe.contentWindow.document)}var u=this.elementChatLog;u.appendChild(s);var p="scenario"===e?3:void 0;this.scrollAuto(u,u.scrollTop,this,p)},o.prototype.showExitOperatorModeModal=function(){var e=this;if(!(this.stash.operator.ws&&1!==this.stash.operator.ws.readyState||this.elementIframe.contentWindow.document.getElementById("_ul_operator_exit_modal"))){var t=document.createElement("div");t.setAttribute("id","_ul_operator_exit_modal");var n=this.elementIframe.contentWindow.document.getElementById("ul-widget-header");n||(n=this.elementIframe.contentWindow.document.getElementById("v2PopupHeader"));var i=n?n.clientHeight:0;o.addClass(t,"modal-container"),t.style.top=i+"px",t.style.width=this.elementIframe.clientWidth+"px",t.style.height=this.elementIframe.clientHeight-i+"px";var s=document.createElement("div");o.addClass(s,"modal-background"),t.appendChild(s);var a=document.createElement("div"),r=document.createElement("p"),l=document.createElement("button");l.setAttribute("role","button"),l.setAttribute("tabindex",0);var c=document.createElement("button");c.setAttribute("role","button"),c.setAttribute("tabindex",0),o.addClass(a,"operator-exit-dialog"),this.elementIframe.clientWidth<350&&o.addClass(a,"vertical-layout-btns"),r.innerText=this.text.operator_exit_confirm,l.innerText=this.text.operator_exit_button,c.innerText=this.text.operator_exit_cancel_button,a.appendChild(r),a.appendChild(l),a.appendChild(c),t.appendChild(a);var d=function(){e.removeMe(t),e.languageHeader&&(e.languageHeader.show(),e.languageHeader.changeRemoveMode()),e.modalHeader&&e.modalHeader.show(),e.closeUserWs();var n=e.elementChatLog;n.appendChild(e.createElementSystemChatLog(e.text.user_close_text)),e.config.operator.feedback_form&&(e.config.operator.custom_feedback_form.length>0?n.appendChild(e.createElementOperatorCustomFeedbackForm()):n.appendChild(e.createElementOperatorFeedbackForm())),e.exitOperatorMode(),e.scrollAuto(n,n.scrollTop,e,1)};o.clickOrSimilarEvent(l,(function(){d()}),(function(){}),this.elementIframe.contentWindow.document),l.addEventListener("keyup",(function(e){13===e.keyCode&&d()})),o.clickOrSimilarEvent(c,(function(){e.removeMe(t)}),(function(){}),this.elementIframe.contentWindow.document),c.addEventListener("keyup",(function(n){13===n.keyCode&&e.removeMe(t)})),o.clickOrSimilarEvent(s,(function(){e.removeMe(t)}),(function(){}),this.elementIframe.contentWindow.document),this.elementIframe.contentWindow.document.getElementById("_ul-widget").appendChild(t)}},o.prototype.connectOperator=function(e,t,n,i,s){if(!this.stash.operator.connecting&&!this.stash.operator.ws){e=void 0!==e&&e;var a=this,r=new WebSocket(a.config.ws_url);this.stash.operator.connecting=!0,r.onerror=function(){a.exitOperatorMode({message:a.text.operator_connect_error,useTextArea:!0})},r.onopen=function(){r.close(),a.sendConnectLog((function(t){if("error"!=t.responseText&&""!=t.responseText){var n=a.JSON3.parse(t.responseText),i=n.initial_connect,s=a.config.operator.connect_confirm,r=a.elementIframe.contentWindow.document,l=a.elementChatLog;if(a.stash.operator.operatorCount=n.operator_cnt,a.stash.operator.activeWS=!1,"failed"!==n.status)if(n.operator_cnt<1)a.exitOperatorMode({useForm:n.display_form||!1,form:n.form||[],formMessage:n.form_message,mid:n.mid,message:n.operator_first_talk||a.text.un_operator_message,useTextArea:!0});else if(n.hasOwnProperty("operator_available")&&n.operator_available<1){var c=n.operator_first_talk||"現在オペレーターが混み合っております。時間をおいて再度お試しください。";a.exitOperatorMode({message:c,useTextArea:!0})}else{if(a.stash.operator.channelId=n.channel_id,a.stash.operator.botId=n.bot_id,n.hasOwnProperty("icon_url")&&n.icon_url&&(a.stash.operator.imgSrc=n.icon_url),n.hasOwnProperty("feedback_form")&&n.feedback_form.length>0&&(a.config.operator.custom_feedback_form=n.feedback_form,a.config.operator.custom_feedback_form_message=n.feedback_form_message),a.enableInputForm(a.text.input_placeholder),2===a.config.widget_version)a.languageHeader&&a.languageHeader.hide(),a.modalHeader&&a.modalHeader.hide(),a.v2ResizeChatLogHeight(),a.appendElementTooltip(a.v2InputBox.getElementImageBtn(),a.text.tooltip_attach_image_button,"top"),r.getElementById("v2OperatorInputBox")?(a.v2InputBox.hide(),a.quickSearchMenu&&a.quickSearchMenu.hide(),a.v2OperatorInputBox.show(),a.adjustSendInputHeight("init"),a.appendElementTooltip(a.v2OperatorInputBox.getElementImageBtn(),a.text.tooltip_attach_image_button,"top")):(a.v2InputBox.showInput(),a.quickSearchMenu&&a.quickSearchMenu.hide(),a.v2ResizeChatLogHeight()),a.v2Header.changeOperatorMode(),a.v2InputBox.changeOperatorMode();else{a.stash.suggest&&(a.stash.suggest.display=!1),a.config.reload_btn&&(r.getElementById("_ul-chat-restart-btn").style.display="none");var d=r.getElementById("_ul-chat-widget-chat-send"),u=d.querySelector(".sendBox");if(a.config.operator.send_img_flag){var p=document.createElement("div"),h=a.html2dom(a.iconImageSvg);o.addClass(p,"attach-image-btn"),u.style.width=u.clientWidth-30+"px",p.appendChild(h),d.insertBefore(p,u),o.clickOrSimilarEvent(p,(function(){a.displayImageUploader()}),(function(){}),r),a.appendElementTooltip(p,a.text.tooltip_attach_image_button,"top")}}if(a.disableBeforeChatLogs(),n.hasOwnProperty("operator_first_talk")&&n.operator_first_talk){var g={};a.stash.operator.imgSrc&&(g.img_src=a.stash.operator.imgSrc),l.appendChild(a.sendBot(n.operator_first_talk,g)),setTimeout((function(){a.scrollAuto(l,l.scrollTop,a)}),300)}if(n.hasOwnProperty("logs")&&n.logs.length>0){var m=!1;n.hasOwnProperty("icon_url")&&n.icon_url&&(m=n.icon_url),a.addOperatorModeLog(n.logs,m)}if(a.setDisplayWaitingCnt(),!e||i||s)a.stash.operator.activeWS=!0,a.stash.operator.ws=new WebSocket(a.config.ws_url),a.setWS(),a.surveillanceWs();else{var _=a.elementIframe.contentWindow;o.addEventListener(_,"focus",(function(){a.stash.operator.ws||(a.stash.operator.activeWS=!0,a.stash.operator.ws=new WebSocket(a.config.ws_url),a.setWS((function(){a.postReadStatusUpdate(a.stash.operator.channelId,a.stash.operator.botId)})),a.surveillanceWs())}))}}else{var f=n.operator_first_talk||"エラーが発生しました。";a.exitOperatorMode({message:f,useTextArea:!0})}}}),t,n,i,s)}}},o.prototype.setWS=function(e){e=e||function(){};var t=this,n=t.stash.operator,i=this.elementIframe.contentWindow.document;if(t.stash.operator.ws.onopen=function(){t.stash.operator.reconnectRetryCnt=0},t.stash.operator.ws.onclose=function(){var e=document.visibilityState,n=Date.now()-t.stash.operator.lastVisibleTime,o=t.stash.operator.ws&&t.stash.operator.reconnectRetryCnt<5;if(t.stash.operator.ws&&n<500&&"visible"===e||o){if(1===t.stash.operator.ws.readyState)return;var s=i.querySelector(".modal-container");s&&t.removeMe(s),t.reconnectOperator()}t.stash.operator.ws&&t.sendSurveyLog({event_type:"background",visibility:document.visibilityState})},t.stash.operator.ws.onmessage=function(i){t.stash.operator.lastMessageTime=Date.now();var s=JSON.parse(i.data);if(s.hasOwnProperty("message")&&s.message.hasOwnProperty("operator_cnt")&&(t.stash.operator.operatorCount=s.message.operator_cnt),"welcome"!==s.type||t.stash.operator.ws.talk||(t.stash.operator.welcome=!0,t.stash.operator.ws.send(JSON.stringify({command:"subscribe",data:JSON.stringify({uid_h:n.channelId,bot_id:n.botId}),identifier:JSON.stringify({channel:"OperatorChatChannel"})}))),"confirm_subscription"===s.type&&t.stash.operator.welcome&&(t.stash.operator.welcome=!1,t.stash.operator.ws.send(JSON.stringify({command:"message",data:JSON.stringify({action:"user_open",session_id:t.sessionId,uid_h:n.channelId,bot_id:n.botId,connect_type:n.connectType}),identifier:JSON.stringify({channel:"OperatorChatChannel"})})),e()),"ping"!==s.type&&s.hasOwnProperty("message")&&s.message.hasOwnProperty("message")){var a=t.elementIframe.contentWindow.document;t.removeWritingStatus();var r=(k=t.elementChatLog).scrollTop;if(2!==t.config.widget_version){var l=a.getElementById("submit");l.hasAttribute("disabled")&&(l.removeAttribute("disabled"),l.style.setProperty("cursor","pointer"),l.style.setProperty("background",t.config.submit_bg_color));var c=a.getElementById("send");c.hasAttribute("disabled")&&(c.removeAttribute("disabled"),c.setAttribute("placeholder",t.text.input_placeholder),c.style.setProperty("background",t.config.input_bg_color));var d=a.getElementsByClassName("ul-widget-lamp")[0];d&&d.childNodes[0].style.setProperty("background",t.config.lamp_color,"important")}var u=a.getElementById("__ul_operator_announce");null!==u&&(u.getElementsByTagName("p")[0].innerText=t.text.operator_response_text);var p={};s.message.hasOwnProperty("icon_url")&&s.message.icon_url&&(p.img_src=s.message.icon_url);var h=k.lastElementChild?o.data(k.lastElementChild,"mid"):null,g=s.message.mid||null;if(t.stash.operator.lastMessageId=g,!h||!g||h!==g){var m=t.sendBot(s.message.message,p);o.data(m,"mid",g),k.appendChild(m),t.scrollAuto(k,r,t),t.removeWaitingCnt()}if(n.activeWS&&(t.flag.open||t.config.site_in))t.postReadStatusUpdate(n.channelId,n.botId);else if(n.active&&!t.flag.open){var _=a.getElementById("_ul-widget");o.addClass(_,"notification"),t.stash.operator.unread++,t.stash.operator.titleText=a.getElementById("_ul-widget-head-title").innerText,a.getElementById("_ul-widget-head-title").innerText="( "+t.stash.operator.unread+" ) "+t.stash.operator.titleText}}else if("ping"!==s.type&&s.hasOwnProperty("message")&&s.message.hasOwnProperty("action_type")&&"operator_image"===s.message.action_type)a=t.elementIframe.contentWindow.document,h=(k=t.elementChatLog).lastElementChild?o.data(k.lastElementChild,"mid"):null,g=s.message.mid||null,t.stash.operator.lastMessageId=g,p={img:s.message.img_url},s.message.hasOwnProperty("icon_url")&&s.message.icon_url&&(p.img_src=s.message.icon_url),h&&g&&h===g||(m=t.sendTemplate("","chat-bot",p),o.data(m,"mid",g),k.appendChild(m),t.removeWaitingCnt());else if("ping"!==s.type&&s.hasOwnProperty("message")&&s.message.hasOwnProperty("action_type")&&"operator_form"===s.message.action_type)a=t.elementIframe.contentWindow.document,h=(k=t.elementChatLog).lastElementChild?o.data(k.lastElementChild,"mid"):null,g=s.message.mid||null,t.stash.operator.lastMessageId=g,h&&g&&h===g||(m=t.createElementOperatorCustomForm(s.message.form.tag_list,s.message.form.guide_message),o.data(m,"mid",g),k.appendChild(m),t.scrollAuto(k,r,t),t.removeWaitingCnt());else if("ping"!==s.type&&s.hasOwnProperty("message")&&s.message.hasOwnProperty("action_type")&&"save_form_answer_confirm"===s.message.action_type){a=t.elementIframe.contentWindow.document;var f=(k=t.elementChatLog).querySelector('.chat-log[data-mid="'+s.message.form_mid+'"] form'),y=f.querySelector(".sending-form");t.removeMe(y),t.disableForm(f),f.style.pointerEvents="none",f.style.opacity="0.6",k.appendChild(t.sendBot(s.message.send_form_message)),t.scrollAuto(k,k.scrollTop,t)}else if("ping"!==s.type&&s.hasOwnProperty("message")&&s.message.hasOwnProperty("action_type")&&"operator_close"===s.message.action_type)a=t.elementIframe.contentWindow.document,(k=t.elementChatLog).appendChild(t.createElementSystemChatLog(t.text.operator_close_text)),t.config.operator.feedback_form&&(t.config.operator.custom_feedback_form.length>0?k.appendChild(t.createElementOperatorCustomFeedbackForm()):k.appendChild(t.createElementOperatorFeedbackForm())),t.exitOperatorMode(),t.scrollAuto(k,k.scrollTop,t);else if("ping"!==s.type&&s.hasOwnProperty("message")&&s.message.hasOwnProperty("action_type")&&"session_close"===s.message.action_type)a=t.elementIframe.contentWindow.document,(k=t.elementChatLog).appendChild(t.createElementSystemChatLog(t.text.operator_session_close_text)),t.exitOperatorMode(),t.scrollAuto(k,k.scrollTop,t),t.sendSurveyLog({event_type:"error",error_message:"operator session close"});else if("ping"!==s.type&&s.hasOwnProperty("message")&&s.message.hasOwnProperty("action_type")&&"operator_confirm"===s.message.action_type&&s.message.hasOwnProperty("operator_cnt")&&s.message.operator_cnt<1)t.exitOperatorMode({useForm:s.message.display_form||!1,form:s.message.form||[],mid:s.message.mid,message:s.message.no_operator_message||t.text.un_operator_message});else if(s.hasOwnProperty("message")&&s.message.hasOwnProperty("action_type")&&"operator_typing"===s.message.action_type)if(s.message.status){a=t.elementIframe.contentWindow.document;var v=(k=t.elementChatLog).getElementsByClassName("writing"),b=k.scrollHeight-(k.clientHeight+k.scrollTop)==0;if(0===v.length){var x=document.createElement("div");o.addClass(x,"writing");var w=document.createTextNode("オペレーター入力中"),C=document.createElement("div");o.addClass(C,"chat-log"),o.addClass(C,"input-icon"),x.appendChild(w),C.appendChild(x),k.appendChild(C),b&&t.scrollAuto(k,k.scrollTop,t),t.stash.operator.writingAnimation||(t.stash.operator.writingAnimation=!0,t.stash.operator.writingIntervalAnimation=setInterval((function(){v[0].innerText+=".","オペレーター入力中...."===v[0].innerText&&(v[0].innerText="オペレーター入力中")}),1e3))}}else t.removeWritingStatus();else if(s.hasOwnProperty("message")&&s.message.hasOwnProperty("action_type")&&"operator_cancel"===s.message.action_type){a=t.elementIframe.contentWindow.document;var k=t.elementChatLog,I=(g=s.message.mid||null,k.querySelector('.chat-log[data-mid="'+g+'"] .chat-bot'));if(I){var B=document.createElement("span");if(B.style.fontStyle="italic",B.textContent="["+t.text.operator_cancel_chat_text+"]",t.config.chat_display_send_time){var E=I.querySelector(".time-stamp").outerHTML;I.innerHTML="",I.appendChild(B),I.appendChild(t.html2dom(E))}else I.innerHTML="",I.appendChild(B);if(I.parentNode.style.opacity="0.6",o.addClass(k.querySelector('.chat-log[data-mid="'+g+'"]'),"post-cancel"),t.stash.operator.lastMessageId===g){var S=k.querySelectorAll(".chat-log:not(.post-cancel)[data-mid]");t.stash.operator.lastMessageId=S.length>0?o.data(S[S.length-1],"mid"):""}}}},!t.stash.operator.checkIntervalFlag){t.stash.operator.checkIntervalFlag=!0;var s=setInterval((function(){var e=t.elementIframe.contentWindow.document.getElementById("loading-modal");if(e&&t.removeMe(e),1===t.stash.operator.ws.readyState){var n=t.elementIframe.contentWindow.document.querySelector(".reconnect-modal");n&&(t.removeMe(n),t.stash.operator.reconnect=!1)}Date.now()-t.stash.operator.lastMessageTime>5e3&&!1===t.stash.operator.reconnect&&1!==t.stash.operator.ws.readyState&&(t.stash.operator.reconnect=!0,t.removeWritingStatus(),clearInterval(t.stash.operator.displayWaitingInterval),t.displayModalDialog(t.text.operator_network_error,t.text.operator_reconnect,"reconnect-modal",(function(){var e=document.createElement("div"),n=t.elementIframe.contentWindow.document.getElementById("ul-widget-header"),i=n?n.clientHeight:0;e.setAttribute("id","loading-modal"),o.addClass(e,"modal-container"),e.style.top=i+"px",e.style.width=t.elementIframe.clientWidth+"px",e.style.height=t.elementIframe.clientHeight-i+"px";var a=document.createElement("div");o.addClass(a,"modal-background"),e.appendChild(a);var r=document.createElement("div");o.addClass(r,"connection-loader"),e.appendChild(r),t.elementIframe.contentWindow.document.getElementById("_ul-widget").appendChild(e),clearInterval(s),t.stash.operator.checkIntervalFlag=!1,t.reconnectOperator(),t.sendSurveyLog({event_type:"ws_reconnect_modal"})}),!1))}),1e3)}if(null===t.elementIframe.contentWindow.document.getElementById("__ul_operator_announce")&&t.stash.operator.operatorCount>0){var a=(i=t.elementIframe.contentWindow.document).createElement("div");a.setAttribute("id","__ul_operator_announce");var r=i.createElement("p"),l=i.createTextNode(t.text.operator_connect_text),c=t.elementChatLog;c.firstChild&&c.firstChild.style.setProperty("margin","28px 16px 4px"),2===t.config.widget_version?t.config.site_in?t.flag.popup_modal?a.style.width="100%":a.style.width="calc(100% - 2px)":a.style.width="100%":a.style.width="calc(100% - 2px)",o.addClass(a,"operator-header"),r.style.setProperty("color",t.config.operator.header_text_color),r.style.setProperty("background-color",t.config.operator.header_bg_color),r.appendChild(l),a.appendChild(r);var d=i.createElement("button");d.textContent=t.text.operator_disconnect_button_text,d.setAttribute("role","button"),d.setAttribute("tabindex",0),o.clickOrSimilarEvent(d,(function(){t.showExitOperatorModeModal()}),(function(){}),i),d.addEventListener("keyup",(function(e){13===e.keyCode&&t.showExitOperatorModeModal()})),a.appendChild(d),this.config.site_in?i.getElementById("_ul-widget").appendChild(a):i.getElementById("_ul-chat-widget").appendChild(a),!t.config.site_in&&t.mobileFlag&&(t.stash.operator.mobilePopupActiveAnnounce=!0)}},o.prototype.sendWS=function(e){var t=this,n=t.stash.operator;if(this.stash.operator.talk=!0,!this.stash.operator.ws)return!1;if(1!==this.stash.operator.ws.readyState)return this.sendSurveyLog({event_type:"error",error_message:"ws post error"}),this.createElementSystemChatLog("送信に失敗しました");try{return t.config.no_cookie||(o.updateCookieExpires("__ulfps",1800,t.fp_domains,t.config.cross_domain),t.lastSessionUpdateTime=(new Date).getTime()),t.stash.operator.ws.send(JSON.stringify({command:"message",data:JSON.stringify({message:e,action:"user_post",session_id:t.sessionId,uid_h:n.channelId,bot_id:n.botId}),identifier:JSON.stringify({channel:"OperatorChatChannel"})})),this.sendUser(e,{log_type:"operator"})}catch(e){return!1}},o.prototype.sendImageWS=function(e){var t=this.stash.operator;if(this.stash.operator.talk=!0,!this.stash.operator.ws)return!1;if(1!==this.stash.operator.ws.readyState)return this.sendSurveyLog({event_type:"error",error_message:"ws post img error"}),this.createElementSystemChatLog("送信に失敗しました");try{return this.config.no_cookie||(o.updateCookieExpires("__ulfps",1800,this.fp_domains,this.config.cross_domain),this.lastSessionUpdateTime=(new Date).getTime()),this.stash.operator.ws.send(JSON.stringify({command:"message",data:JSON.stringify({image:e,action:"user_post_image",session_id:this.sessionId,uid_h:t.channelId,bot_id:t.botId}),identifier:JSON.stringify({channel:"OperatorChatChannel"})})),this.sendUser("",{img:e,log_type:"operator"})}catch(e){return!1}},o.prototype.sendFormWS=function(e,t){var n=this,i=n.stash.operator;if(n.stash.operator.talk=!0,!n.stash.operator.ws)return!1;if(1!==n.stash.operator.ws.readyState)return n.sendSurveyLog({event_type:"error",error_message:"ws post form error"}),n.createElementSystemChatLog("送信に失敗しました");try{n.config.no_cookie||(o.updateCookieExpires("__ulfps",1800,n.fp_domains,n.config.cross_domain),n.lastSessionUpdateTime=(new Date).getTime()),n.stash.operator.ws.send(JSON.stringify({command:"message",data:JSON.stringify({form_data:e,form_mid:t,action:"user_post_form",session_id:n.sessionId,uid_h:i.channelId,bot_id:i.botId}),identifier:JSON.stringify({channel:"OperatorChatChannel"})}))}catch(e){return!1}return!1},o.prototype.surveillanceWs=function(){var e=this,t=e.stash.operator;if(!t.ws)return!1;var n=this.elementIframe.contentWindow;o.addEventListener(n,"focus",(function(){(e.flag.open||e.config.site_in)&&e.stash.operator.ws&&(e.stash.operator.activeWS=!0,e.postReadStatusUpdate(t.channelId,t.botId))})),o.addEventListener(n,"blur",(function(){e.stash.operator.activeWS=!1}))},o.prototype.closeUserWs=function(){var e=this.stash.operator;e.ws&&!this.stash.operator.exit&&(this.stash.operator.exit=!0,this.stash.operator.mobilePopupActiveAnnounce=!1,this.stash.operator.ws.send(JSON.stringify({command:"message",data:JSON.stringify({action:"user_close",session_id:this.sessionId,uid_h:e.channelId,bot_id:e.botId}),identifier:JSON.stringify({channel:"OperatorChatChannel"})})))},o.prototype.reconnectOperator=function(){var e=this;if(0===this.stash.operator.ws.readyState)return!1;this.stash.operator.ws&&1===this.stash.operator.ws.readyState&&(this.stash.operator.ws.close(),this.stash.operator.ws=!1),this.stash.operator.ws=new WebSocket(this.config.ws_url),this.setWS(this.sendReconnectLog((function(t){if("error"!=t.responseText&&""!=t.responseText){var n=e.elementIframe.contentWindow.document.querySelector(".reconnect-modal");n&&(e.removeMe(n),e.stash.operator.reconnect=!1);var i=e.JSON3.parse(t.responseText);if(i.hasOwnProperty("logs")&&i.logs.length>0){var o=!1;i.hasOwnProperty("icon_url")&&i.icon_url&&(o=connectData.icon_url),e.addOperatorModeLog(i.logs,o),e.removeWaitingCnt()}if(e.stash.operator.waitingCntLog&&e.setDisplayWaitingCnt(),e.postReadStatusUpdate(e.stash.operator.channelId,e.stash.operator.botId),i.hasOwnProperty("session_close")&&i.session_close){var s=e.elementChatLog;s.appendChild(e.createElementSystemChatLog(e.text.operator_session_close_text)),e.exitOperatorMode(),e.scrollAuto(s,s.scrollTop,e),e.sendSurveyLog({event_type:"error",error_message:"operator session close reconnect"})}}}),this.stash.operator.lastMessageId)),this.stash.operator.reconnect=!1,this.stash.operator.connectType="reconnect",this.stash.operator.reconnectRetryCnt++},o.prototype.setDisplayWaitingCnt=function(){if(this.config.operator.connect_display_waiting){var e=this,t=e.elementChatLog;this.displayWaitingCnt(t),clearInterval(this.stash.operator.displayWaitingInterval),this.stash.operator.displayWaitingInterval=setInterval((function(){e.displayWaitingCnt(t)}),15e3)}},o.prototype.displayWaitingCnt=function(e){var t=this,n=function(){t.sendSurveyLog({event_type:"error",error_message:"request error - operatorCheckWaiting"}),clearInterval(t.stash.operator.displayWaitingInterval)},i={uid_h:t.stash.operator.channelId},o=this.getRequestParams(i),s=this.config.bot_url+"operatorCheckWaiting";this.sendRequest(s,this.AnalyticsTagCommon.encodeHTMLForm({json:this.JSON3.stringify(o)}),{callback:function(i){if("error"!=i.responseText&&""!=i.responseText){var o=t.JSON3.parse(i.responseText),s=o.sessionClose,a=o.waitingCnt,r="";if(s)return t.removeWaitingCnt(),r=t.text.operator_session_close_text,e.appendChild(t.createElementSystemChatLog(r)),t.exitOperatorMode(),void t.scrollAuto(e,e.scrollTop,t);if(0===a)t.stash.operator.waitingCntLog&&(t.removeMe(t.stash.operator.waitingCntLog),t.stash.operator.waitingCntLog=null),clearInterval(t.stash.operator.displayWaitingInterval);else if(r="現在の待機人数: "+a+"人",t.stash.operator.waitingCntLog)t.stash.operator.waitingCntLog.children[0].textContent=r;else{var l=t.createElementSystemChatLog(r);t.stash.operator.waitingCntLog=l,e.appendChild(l),t.scrollAuto(e,e.scrollTop,t)}}else n()},errorFunction:n})},o.prototype.removeWaitingCnt=function(){this.config.operator.connect_display_waiting&&(this.stash.operator.waitingCntLog&&(this.removeMe(this.stash.operator.waitingCntLog),this.stash.operator.waitingCntLog=null),clearInterval(this.stash.operator.displayWaitingInterval))},o.prototype.removeMe=function(e){e&&e.parentElement&&e.parentElement.removeChild(e)},o.prototype.addOperatorModeLog=function(e,t){void 0===t&&(t=!1),e.reverse();var n=this.elementIframe.contentWindow.document,i=this.elementChatLog;for(var s in e)if(e.hasOwnProperty(s)){var a=!1,r={backlogDate:new Date(e[s].created_at),log_type:"operator"};if("operator"===e[s].chat_type?(e[s].hasOwnProperty("icon_url")&&(r.img_src=e[s].icon_url),e[s].hasOwnProperty("img_url")&&e[s].img_url.length>0&&(r.img=e[s].img_url,e[s].message=""),a=this.sendBot(e[s].message,r),e[s].hasOwnProperty("mid")&&e[s].mid.length>0&&(o.data(a,"mid",e[s].mid),this.stash.operator.lastMessageId=e[s].mid)):"user"===e[s].chat_type&&(a=this.sendUser(e[s].message,r)),a&&i.appendChild(a),!this.config.default_open&&e[s].hasOwnProperty("read_status")&&0===e[s].read_status){var l=n.getElementById("_ul-widget");o.addClass(l,"notification"),this.stash.operator.unread++}}this.stash.operator.unread>0&&n.getElementById("_ul-widget-head-title")&&(this.stash.operator.titleText=n.getElementById("_ul-widget-head-title").innerText,n.getElementById("_ul-widget-head-title").innerText="( "+this.stash.operator.unread+" ) "+this.stash.operator.titleText);var c=i.scrollTop;this.scrollAuto(i,c,this)},o.prototype.displayImageUploader=function(){var e=this,t=document.createElement("div"),n=this.elementIframe.contentWindow.document.getElementById("ul-widget-header"),i=n?n.clientHeight:0;o.addClass(t,"image-uploader"),t.style.top=i+"px",t.style.width=this.elementIframe.clientWidth+"px",t.style.height=this.elementIframe.clientHeight-i+"px";var s=document.createElement("div");o.addClass(s,"image-uploader-background"),t.appendChild(s);var a=document.createElement("div"),r=document.createElement("p"),l=document.createElement("input"),c=document.createElement("label"),d=document.createElement("button");o.addClass(a,"image-uploader-dialog"),r.textContent="画像を送信する",l.id="imageUploaderInput",l.type="file",l.accept="image/png, image/jpeg, image/gif",l.style.display="none",c.textContent="ファイルを選択",c.setAttribute("for","imageUploaderInput"),c.setAttribute("role","button"),c.setAttribute("tabindex",0),o.addClass(d,"image-uploader-close-btn"),d.setAttribute("role","button"),d.setAttribute("tabindex",0),d.appendChild(this.html2dom(this.iconCloseSvg)),a.appendChild(r),a.appendChild(c),a.appendChild(l),a.appendChild(d),t.appendChild(a),o.addEventListener(l,"change",(function(n){var i=n.target.files[0],o=new FileReader;o.onload=function(){var n=this.result,i=e.elementChatLog;e.removeMe(t);var o=e.sendImageWS(n);if(!o)return!1;i.appendChild(o)},o.readAsDataURL(i)})),o.clickOrSimilarEvent(s,(function(){e.removeMe(t)}),(function(){}),this.elementIframe.contentWindow.document),o.clickOrSimilarEvent(d,(function(){e.removeMe(t)}),(function(){}),this.elementIframe.contentWindow.document),c.addEventListener("keyup",(function(e){13===e.keyCode&&l.click()})),this.elementIframe.contentWindow.document.getElementById("_ul-widget").appendChild(t)},o.prototype.exitOperatorMode=function(e){e=e||{};var t=this.elementIframe.contentWindow.document,n=this.elementChatLog;if(e.message&&n.appendChild(this.sendBot(e.message)),e.useForm&&(e.form.length>0?n.appendChild(this.sendCustomFormTemplate(e.form,e.mid,e.formMessage)):n.appendChild(this.sendFormTemplate(this.config.form))),2===this.config.widget_version)this.v2OperatorInputBox.isShown()&&this.v2OperatorInputBox.hide(),this.config.translate_target_lang||this.v2InputBox.show(),this.v2InputBox.changeUnOperatorMode();else{var i=t.getElementById("_ul-chat-widget-chat-send"),o=i.querySelector(".sendBox"),s=i.querySelector(".attach-image-btn");s&&(this.removeMe(s),o.style.width=o.clientWidth+30+"px"),this.stash.suggest&&(this.stash.suggest.display=!0)}var a=t.getElementById("__ul_operator_announce");if(a&&this.removeMe(a),this.removeWaitingCnt(),!e.hasOwnProperty("useTextArea")||!e.useTextArea){this.disableInputForm(e.placeholderMessage||""),2===this.config.widget_version&&this.v2InputBox.hideInput();var r=t.getElementsByClassName("ul-widget-lamp")[0];r&&r.childNodes[0].style.setProperty("background","#e0e0e0","important")}if(2===this.config.widget_version&&this.v2ResizeChatLogHeight(),this.stash.operator.ws){var l=this.stash.operator.ws;this.stash.operator.ws=!1,setTimeout((function(){l.close()}),1e3)}this.stash.operator.reconnect=!0,this.stash.operator.connecting=!1,this.scrollAuto(n,n.scrollTop,this,void 0)},o.prototype.enterGptMode=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this;"custom_chat"===(e=e||"gpt")?n&&n.id&&(i.stash.custom_chat_id=n.id,"gpt"===n.type?i.flag.gpt_mode=!0:i.flag.gpt_doc_mode=!0):"gpt_doc"===e?i.flag.gpt_doc_mode=!0:i.flag.gpt_mode=!0,i.flag.import_marked||i.importMarkedScript(),i.disableBeforeChatLogs(),i.cookieBanner&&i.cookieBanner.hide();var s="gpt_doc"===e?i.text.gpt_doc_mode:i.text.gpt_mode;"custom_chat"===e&&n&&n.name&&(s=n.name);var a=i.elementIframe.contentWindow.document;if(null===i.elementIframe.contentWindow.document.getElementById("__chat_gpt_announce")&&5!==i.config.gpt_doc_mode){var r=a.createElement("div");r.setAttribute("id","__chat_gpt_announce");var l=a.createElement("p"),c=a.createTextNode(s),d=i.elementChatLog;d.firstChild&&d.firstChild.style.setProperty("margin","28px 16px 4px"),2===i.config.widget_version?i.config.site_in?i.flag.popup_modal?r.style.width="100%":r.style.width="calc(100% - 2px)":r.style.width="100%":r.style.width="calc(100% - 2px)",o.addClass(r,"chat-gpt-header"),l.appendChild(c),r.appendChild(l);var u=a.createElement("button");u.textContent=i.text.exit,u.setAttribute("role","button"),u.setAttribute("tabindex",0),o.clickOrSimilarEvent(u,(function(){i.exitGptMode(e)}),(function(){}),a),u.addEventListener("keyup",(function(t){13===t.keyCode&&i.exitGptMode(e)})),r.appendChild(u),i.config.site_in?a.getElementById("_ul-widget").appendChild(r):a.getElementById("_ul-chat-widget").appendChild(r)}i.v2Header.changeGptMode(),i.languageHeader&&i.languageHeader.hide(),i.modalHeader&&5!==i.config.gpt_doc_mode&&i.modalHeader.hide(),a.getElementById("v2OperatorInputBox")?(i.v2InputBox.hide(),i.quickSearchMenu&&i.quickSearchMenu.hide(),i.v2OperatorInputBox.show(),i.adjustSendInputHeight("init"),i.appendElementTooltip(i.v2OperatorInputBox.getElementImageBtn(),i.text.tooltip_attach_image_button,"top")):(i.v2InputBox.showInput(),i.quickSearchMenu&&i.quickSearchMenu.hide(),i.v2ResizeChatLogHeight()),i.v2OperatorInputBox.changeGptMode(),i.v2InputBox.changeGptMode();var p=i.elementChatLog;5!==i.config.gpt_doc_mode&&p.appendChild(i.createElementSystemChatLog(s)),"gpt"===e?p.appendChild(i.sendBot(i.text.gpt_mode_first_talk,{icon_id:i.config.icon_id,gpt_mode_first_talk:!0})):"gpt_doc"===e?t?p.appendChild(i.sendBot(t+i.text.gpt_doc_mode_file_first_talk,{icon_id:i.config.icon_id})):(i.stash.gpt_doc_file_hs=[],p.appendChild(i.sendBot(i.text.gpt_doc_mode_first_talk,{icon_id:i.config.icon_id}))):"custom_chat"===e&&(i.stash.gpt_doc_file_hs=[],p.appendChild(i.sendBot(n.first_talk||i.text.gpt_mode_first_talk,{icon_id:i.config.icon_id}))),i.scrollAuto(p,p.scrollTop,i)},o.prototype.exitGptMode=function(e){this.flag.gpt_doc_mode=!1,this.flag.gpt_mode=!1,this.stash.custom_chat_id=null;var t=this.elementIframe.contentWindow.document.getElementById("__chat_gpt_announce");t&&this.removeMe(t),this.disableBeforeChatLogs(),this.scrollAuto(this.elementChatLog,this.elementChatLog.scrollTop,this),this.restartTalk(500),this.v2Header.changeUnGptMode(),this.v2OperatorInputBox.hide(),this.v2OperatorInputBox.changeUnGptMode(),this.v2InputBox.changeUnGptMode(),this.v2InputBox.show(),this.quickSearchMenu&&this.quickSearchMenu.show(),this.config.translate_target_lang&&this.v2InputBox.hideInput(),this.languageHeader&&this.languageHeader.show(),this.modalHeader&&this.modalHeader.show(),this.v2ResizeChatLogHeight()},o.prototype.disableInputForm=function(e){e=e||"";var t=this.elementIframe.contentWindow.document;if(2==this.config.widget_version)this.v2InputBox.disableInputForm(e);else{var n=t.getElementById("send");n&&(n.style.setProperty("background-color","#e0e0e0"),n.setAttribute("placeholder",e),n.setAttribute("disabled","disabled"));var i=t.getElementById("submit");i&&(i.style.setProperty("background-color","#e0e0e0","important"),i.style.setProperty("cursor","auto"),i.setAttribute("disabled","disabled"))}},o.prototype.enableInputForm=function(e){e=e||"";var t=this.elementIframe.contentWindow.document;if(2==this.config.widget_version)this.v2InputBox.enableInputForm(e);else{var n=t.getElementById("send");n&&n.hasAttribute("disabled")&&(n.removeAttribute("disabled"),n.setAttribute("placeholder",e),n.style.setProperty("background-color",this.config.input_bg_color));var i=t.getElementById("submit");i&&i.hasAttribute("disabled")&&(i.removeAttribute("disabled"),i.style.removeProperty("cursor"),i.style.removeProperty("background-color"))}},o.prototype.sendUserTyping=function(e){var t=this.stash.operator,n=this.elementIframe.contentWindow.document,i=n.getElementById("send");2===this.config.widget_version&&(i=n.getElementById("v2InputBoxSend"),this.v2OperatorInputBox.isShown()&&(i=n.getElementById("v2OperatorInputBoxSend")));var o=i.value;this.stash.operator.ws.send(JSON.stringify({command:"message",data:JSON.stringify({action:"user_typing",session_id:this.sessionId,uid_h:t.channelId,bot_id:t.botId,message:o,status:e}),identifier:JSON.stringify({channel:"OperatorChatChannel"})}))},o.prototype.isUserInput=function(){return!(this.stash.operator.timeLastKeypress+this.config.operator.timeKeyInterval<(new Date).getTime())},o.prototype.postReadStatusUpdate=function(e,t){this.stash.operator.ws.send(JSON.stringify({command:"message",data:JSON.stringify({action:"read_status_update",session_id:this.sessionId,uid_h:e,bot_id:t}),identifier:JSON.stringify({channel:"OperatorChatChannel"})}))},o.prototype.getBotIcon=function(e){var t=document.createElement("div"),n=document.createElement("img");return n.src=e,n.alt="",o.addClass(t,"_ul-chat-chip"),t.appendChild(n),t},o.prototype.removeWritingStatus=function(){var e=this.elementChatLog;e.getElementsByClassName("writing").length>0&&this.removeMe(e.getElementsByClassName("writing")[0]),e.getElementsByClassName("input-icon").length>0&&this.removeMe(e.getElementsByClassName("input-icon")[0]),this.stash.operator.writingAnimation&&(clearInterval(this.stash.operator.writingIntervalAnimation),this.stash.operator.writingAnimation=!1)},o.prototype.checkerUserInput=function(){this.isUserInput()||(this.sendUserTyping(0),this.stash.operator.flagTyping=!1,clearInterval(this.stash.operator.intervalCheckerUserInput))},o.prototype.setChatlogBalloonWidth=function(){var e="calc(100% - 32px)";"windows"==o.checkDesktopOs()&&(this.setCssStyle("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-log","margin: 4px 28px 4px 16px;"),e="calc(100% - 26px)");var t=72;this.config.site_in&&(t=this.mobileFlag?88:120),t+=4;var n=this.config.site_in&&!this.mobileFlag?84:60;this.config.bot_img&&""!=this.config.bot_img[0]||(n=4),n+=4,this.config.chat_display_send_time&&(t+=46),this.config.bot_icon_border_width&&(t+=2*parseInt(this.config.bot_icon_border_width),n+=2*parseInt(this.config.bot_icon_border_width));var i="calc(100% - "+t+"px)",s="calc(100% - "+n+"px)";1==this.config.widget_version&&this.config.site_in?(this.setCssStyle("#_ul-widget #_ul-chat-widget-chat-log .chat-log","max-width: "+e),this.setCssStyle("#_ul-widget #_ul-chat-widget-chat-log .chat-log .funnel-question","max-width: "+s),this.setCssStyle("#_ul-widget #_ul-chat-widget-chat-log .chat-log .chat-bot","max-width: "+i),this.setCssStyle("#_ul-widget #_ul-chat-widget-chat-log .chat-log .chat-user","max-width: "+i)):(this.setCssStyle("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-log","max-width: "+e),this.setCssStyle("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-log .funnel-question","max-width: "+s),this.setCssStyle("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-log .ai-label","max-width: "+s),this.setCssStyle("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-log .chat-bot","max-width: "+i),this.setCssStyle("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-log .chat-user","max-width: "+i))},o.prototype.openPcWidget=function(){var e=this;if(e.stash.operator.ws)e.showExitOperatorModeModal();else{var t=e.elementIframe.contentWindow.document,n=t.getElementById("_ul-widget"),i=t.getElementById("send"),s=e.elementChatLog;if(e.flag.check_open=!0,e.config.scroll_open=!1,o.hasClass(n,"notification")&&o.removeClass(n,"notification"),e.stash.operator.unread>0&&(e.stash.operator.unread=0,t.getElementById("_ul-widget-head-title").innerText=e.stash.operator.titleText),o.toggleClass(e.elementIframe,"ul-widget-hide"),t.getElementById("_ul-widget"),o.hasClass(e.elementIframe,"ul-widget-hide")){if(e.flag.open=!1,e.config.reload_btn&&(c=t.getElementById("_ul-chat-restart-btn"),o.hasClass(c,"hidden")||o.addClass(c,"hidden")),e.config.close_icon.use&&(u=t.getElementById("closeBtn"),p=t.getElementsByClassName("ul-widget-close-btn")[0],o.addClass(p,"hidden"),o.hasClass(u,"hidden")&&o.removeClass(u,"hidden"),!e.flag.check_close&&e.config.default_open&&e.config.popup.pc_icon_url)){d=t.getElementById("closeBtn");var a=e.getRect(d);d.style.setProperty("bottom",e.stash.imgPopupPc.height-a.height+"px")}e.flag.check_close=!0,e.config.popup.pc_icon_url?e.displayPcPopupIcon():(e.elementIframe.style.bottom=e.styleHideBottom+"px",e.elementIframe.style.boxShadow="0 1px 1px 0 rgba(0, 0, 0, .20)");var r=t.getElementById("tooltipRestartButton"),l=t.getElementById("tooltipMinimizeButton");r&&e.removeMe(r),l&&e.removeMe(l),e.execCustomEvent("popup_close")}else{if(e.flag.open=!0,e.config.reload_btn){var c=t.getElementById("_ul-chat-restart-btn");o.hasClass(c,"hidden")&&o.removeClass(c,"hidden"),e.appendElementTooltip(c,e.text.tooltip_restart_button,"bottom","tooltipRestartButton")}var d;if((d=t.querySelector(".ul-widget-close-btn"))&&e.appendElementTooltip(d,e.text.tooltip_minimize_button,"bottom","tooltipMinimizeButton"),e.config.display_input_box&&i&&(i.focus(),e.stash.operator.active&&e.postReadStatusUpdate(e.stash.operator.channelId,e.stash.operator.botId)),e.config.close_icon.use){var u=t.getElementById("closeBtn"),p=t.getElementsByClassName("ul-widget-close-btn")[0];o.addClass(u,"hidden"),o.hasClass(p,"hidden")&&o.removeClass(p,"hidden")}var h=parseInt(e.config.popup.pc_header_border_radius);e.elementIframe.style.setProperty("border-radius",h+"px "+h+"px 0 0"),e.elementIframe.style.bottom=0,e.elementIframe.style.boxShadow="rgba(0, 0, 0, 0.12) 0px 1px 10px 0px, rgba(0, 0, 0, 0.3) 0px 1px 4px -1px",e.config.popup.pc_icon_url&&e.hiddenPcPopupIcon();var g=s.scrollTop;if(e.flag.first_open){var m=0;e.config.operator_mode||5===e.config.gpt_doc_mode||(""!==e.params.first_talk&&void 0!==e.params.first_talk&&e.AnalyticsTagCommon.isArray(e.params.first_list)&&e.params.first_list.length>0&&m++,e.config.backlog.view&&"xmlHttp"===e.createHttpRequest()[1]&&m++),e.scrollAuto(s,g,e,m),e.flag.first_open=!1}if(this.config.display_input_box&&"tab"===this.Utils.getDevice()){var _=this.config.no_viewport?this.config.no_viewport_scale:1,f=t.getElementById("_ul-widget").clientHeight-(v=t.getElementById("ul-widget-header").clientHeight);t.getElementById("_ul-chat-widget").style.height=f+"px",e.elementChatLog.style.height=f-88*_+"px",t.getElementById("_ul-chat-widget-chat-send").style.padding=4*_+"px",t.getElementById("_ul-chat-widget-chat-send").style.paddingBottom=52*_+"px"}var y=t.getElementById("preChat");if(y){var v=t.getElementById("ul-widget-header").clientHeight;y.style.width=t.body.clientWidth-2+"px",y.style.height=t.body.clientHeight-v+"px",y.style.top=v+"px"}e.execCustomEvent("popup_open")}}},o.prototype.canFullScreenOnAndrid=function(){if(!o.Os.Android)return!1;if(this.config.no_viewport)return!1;var e=window.navigator.userAgent;return!(parseFloat(e.slice(e.indexOf("Android")+8))<5)},o.prototype.openSpWidget=function(){var e=this.elementIframe,t=e.contentWindow.document,n=this.elementChatLog;this.flag.check_open=!0,this.config.scroll_open=!1,this.widgetPositionY=e.getBoundingClientRect().top;var i=t.getElementById("_ul-main-window");this.elementIframe.style.boxShadow="rgba(0, 0, 0, 0.12) 0px 1px 10px 0px, rgba(0, 0, 0, 0.3) 0px 1px 4px -1px",o.removeClass(this.elementIframe,"ul-widget-hide"),o.toggleClass(i,"hidden"),o.toggleClass(t.getElementById("_ul-widget-btn"),"hidden");var s=t.getElementById("_ul-main-window").clientHeight,a=t.getElementById("ul-widget-header").clientHeight,r=s-a,l=r-6;if(this.config.close_icon.use){var c=t.getElementById("closeBtn");o.addClass(c,"hidden")}this.flag.open=!0;var d=e.style;d.position="fixed",d.bottom=0,d.left=0,d.width="100%",d.height=parseInt(400)+"px",this.config.no_viewport&&(d.height=parseInt(d.height)*this.config.no_viewport_scale+"px");var u=o.getWindowSize().height,p=o.getWindowSize().width;if(this.canFullScreenOnAndrid()||o.Os.iOs||this.config.mobilePreview){this.stash.parentScroll.x=window.scrollX,this.stash.parentScroll.y=window.scrollY;var h=document.querySelector("body");this.parentBodyStyle=h.getAttribute("style"),h.setAttribute("style","display: block; position: fixed; overflow-y: hidden; -webkit-text-size-adjust: 100%; min-width: 100%; min-height: 100%; margin: 0px;"),d.top=0,d.bottom=null,d.width="100%",d.minHeight="100%",d.maxHeight="100%",d.height="100%",d.backgroundColor="#dddddd",t.scrolling="",t.getElementById("_ul-widget").style.height=u+"px",t.getElementById("_ul-widget").style.width=p+"px",t.getElementById("_ul-main-window").style.height="100%",t.getElementById("_ul-main-window").style.height=u+"px",t.getElementById("_ul-main-window").style.width=p+"px";var g=this.config.no_viewport?this.config.no_viewport_scale:1;if(l=r=(s=t.getElementById("_ul-main-window").clientHeight)-(a=t.getElementById("ul-widget-header").clientHeight),this.config.display_input_box){var m=40*g,_=4*g,f=o.Os.iOs?40*g:68*g;o.Os.iOs&&navigator.userAgent.indexOf("GSA")>0&&(f+=120),t.getElementById("_ul-chat-widget-chat-send").style.padding=_+"px",t.getElementById("_ul-chat-widget-chat-send").style.paddingBottom=f+"px",l=r-(m+_+f)}else this.config.powered_by&&(l-=24*g);t.getElementById("_ul-chat-widget").style.height=r+"px",this.elementChatLog.style.height=l+"px"}o.Os.Android&&o.Browser.DefaultBrowser&&(l=(r=(s=t.getElementById("_ul-main-window").clientHeight)-(a=t.getElementById("ul-widget-header").clientHeight))-6,t.getElementById("_ul-chat-widget").style.height=r+"px",this.config.display_input_box?(t.getElementById("_ul-chat-widget-chat-send").style.padding="4px 4px 52px",this.config.powered_by&&(t.getElementById("_ul-chat-widget-chat-send").style.padding="4px 4px 42px")):(r+=80,t.getElementById("_ul-chat-widget").style.height=r+"px",l=r,this.config.powered_by&&(l-=24)),this.elementChatLog.style.height=l+"px");var y=t.getElementById("_ul-main-window").clientWidth;if(this.config.display_input_box?t.getElementById("_ul-chat-widget-chat-send").style.width=y-8+"px":o.Browser.Firefox&&(l=(r=s=t.getElementById("_ul-main-window").clientHeight)+24,this.elementChatLog.style.height=l+"px"),this.config.powered_by){var v=t.createElement("a"),b=t.createElement("p"),x=t.createTextNode(this.poweredBy.text),w=t.createElement("img");if(this.config.site_in&&!this.mobileFlag?w.src=this.currentUrl+"/img/logo_black.png":w.src=this.currentUrl+"/img/logo_black_176.png",w.alt="UserLocal",b.appendChild(x),v.appendChild(b),v.appendChild(w),this.config.display_input_box)o.addClass(t.getElementById("_ul-chat-widget-chat-send"),"powered-by");else{var C=t.createElement("div");C.id="_ul-chat-widget-chat-send"}}if(o.Os.iOs||this.canFullScreenOnAndrid()||this.config.mobilePreview){if(this.config.powered_by)if(this.config.display_input_box)t.getElementById("_ul-chat-widget-chat-send").appendChild(v);else{if(!t.getElementById("_ul-chat-widget-chat-send")){var k=t.getElementById("_ul-main-window").clientWidth;C.style.width=k-6+"px",C.appendChild(v),C.style.position="fixed",t.getElementById("_ul-chat-widget").appendChild(C),o.addClass(t.getElementById("_ul-chat-widget-chat-send"),"powered-by"),o.addClass(t.getElementById("_ul-chat-widget-chat-send"),"non-text-box")}o.Browser.Chrome&&(this.elementChatLog.style.height=l+"px",C.style.bottom=0)}}else o.Browser.DefaultBrowser||(this.config.powered_by?(r=parseInt(t.getElementById("_ul-main-window").clientHeight)+16,this.elementChatLog.style.height=r+"px",this.config.display_input_box&&(this.elementChatLog.style.height=r-48+"px")):(r=parseInt(t.getElementById("_ul-main-window").clientHeight)+16,this.elementChatLog.style.height=r+24+"px",this.config.display_input_box&&(this.elementChatLog.style.height=r-24+"px"))),this.config.powered_by&&(this.config.display_input_box?t.getElementById("_ul-chat-widget-chat-send").appendChild(v):t.getElementById("_ul-chat-widget-chat-send")||(k=parseInt(this.elementIframe.clientWidth),C.style.width=k-6+"px",C.appendChild(v),C.style.position="fixed",t.getElementById("_ul-chat-widget").appendChild(C),t.getElementById("_ul-chat-widget-chat-send").style.width=k-6+"px",this.params.send_box_color&&this.isColor(this.params.send_box_color)&&(t.getElementById("_ul-chat-widget-chat-send").style.background=this.params.send_box_color),o.addClass(t.getElementById("_ul-chat-widget-chat-send"),"powered-by"),o.addClass(t.getElementById("_ul-chat-widget-chat-send"),"non-text-box")));var I=n.scrollTop;if(this.flag.first_open){this.flag.first_open=!1;var B=0;if(""!==this.params.first_talk&&void 0!==this.params.first_talk&&this.AnalyticsTagCommon.isArray(this.params.first_list)&&this.params.first_list.length>0&&B++,this.config.backlog.view&&"xmlHttp"===this.createHttpRequest()[1]&&B++,!(this.config.remove_space&&B>0)){var E=n.getElementsByClassName("initWhiteSpace")[0];(this.mobileFlag&&o.Os.iOs||this.config.mobilePreview)&&(E=n.firstChild),E&&(E.style.height=this.getRect(n).height+"px")}0===B?this.scrollAuto(n,I,this):this.scrollAuto(n,n.scrollTop,this,B)}if(this.stash.operator.mobilePopupActiveAnnounce){var S=(t=this.elementIframe.contentWindow.document).getElementsByTagName("body")[0],T=this.getRect(S);t.getElementById("__ul_operator_announce").style.width=T.width+"px"}var L=t.getElementById("preChat");return L&&(L.style.width=t.body.clientWidth-2+"px",L.style.height=r+"px",L.style.top=t.getElementById("ul-widget-header").clientHeight+"px"),this.execCustomEvent("popup_open"),!1},o.prototype.closeSpWidget=function(){if(!this.stash.operator.ws){var e=this.elementIframe,t=e.contentWindow.document,n=t.getElementById("_ul-main-window");if(o.addClass(this.elementIframe,"ul-widget-hide"),o.toggleClass(n,"hidden"),o.toggleClass(t.getElementById("_ul-widget-btn"),"hidden"),this.flag.open=!1,this.config.close_icon.use){var i=t.getElementById("closeBtn");o.hasClass(i,"hidden")&&o.removeClass(i,"hidden")}var s=e.style;if(s.position="fixed",s.bottom=this.styleHideBottom+"px",s.left="",s.right="",s.backgroundColor="",this.mobileFlag?s.right=this.config.popup.space.sp.width:s.right=this.config.popup.space.pc.width,s.boxShadow="","left"==this.config.position&&(s.right="",this.mobileFlag?s.left=this.config.popup.space.sp.width:s.left=this.config.popup.space.pc.width),s.width=this.config.widget_button_size+"px",s.height=this.config.widget_button_size+"px",this.stash.imgPopupSp.width>0&&(s.width=this.stash.imgPopupSp.width+"px"),this.config.popup.sp_wait_image_origin_size&&this.stash.imgPopupSp.height>0&&(s.height=this.stash.imgPopupSp.height+"px"),this.isCustomSizePopupIcon()&&(s.width=this.stash.imgPopupSp.width+"px",s.height=this.stash.imgPopupSp.height+"px"),this.config.close_icon.use){var a=4;this.config.popup.icon_url&&(a=16);var r=this.stash.imgPopupSp.width>0?this.stash.imgPopupSp.width+a:68;s.width=r+"px";var l=this.stash.imgPopupSp.height>0?this.stash.imgPopupSp.height+a:68;s.height=l+"px"}return s.minHeight="",s.maxHeight="",(o.Os.iOs||this.canFullScreenOnAndrid()||this.config.mobilePreview)&&(s.top="",document.querySelector("body").setAttribute("style",this.parentBodyStyle),this.parentBodyStyle=!1,!1!==this.stash.parentScroll.x&&!1!==this.stash.parentScroll.y&&window.scrollTo(this.stash.parentScroll.x,this.stash.parentScroll.y)),this.execCustomEvent("popup_close"),!1}this.showExitOperatorModeModal()},o.prototype.restartBtnEvent=function(){this.config.pre_chat.use&&!this.flag.completed_pre_chat||this.flag.use_reload_btn||(this.flag.use_reload_btn=!0,this.restartTalk(20),this.flag.use_reload_btn=!1)},o.prototype.displayPcPopupIcon=function(){var e=this.elementIframe.contentWindow.document;e.getElementById("_ul-widget").style.setProperty("display","none"),this.elementIframe.style.boxShadow="none",this.elementIframe.style.setProperty("border-radius","0 0 0 0"),this.elementIframe.style.setProperty("width",this.stash.imgPopupPc.width+"px"),this.elementIframe.style.setProperty("height",this.stash.imgPopupPc.height+"px"),e.getElementById("popupIcon").style.setProperty("display","block");var t=this.config.popup.space.pc;parseInt(t.width)>=0&&("left"===this.config.position?this.elementIframe.style.setProperty("left",t.width):this.elementIframe.style.setProperty("right",t.width)),parseInt(t.height)>=0&&this.elementIframe.style.setProperty("bottom",t.height)},o.prototype.hiddenPcPopupIcon=function(){var e=this.elementIframe.contentWindow.document,t=e.getElementById("_ul-widget");this.elementIframe.style.setProperty("width",this.config.out.width),this.elementIframe.style.setProperty("height",this.config.out.height),t.style.setProperty("display","block"),e.getElementById("popupIcon").style.setProperty("display","none");var n=this.config.popup.space.pc;(n.width>=0||n.height>=0)&&("left"===this.config.position?this.elementIframe.style.setProperty("left",n.width):this.elementIframe.style.setProperty("right",n.width),this.elementIframe.style.setProperty("bottom","0"))},o.prototype.isCustomSizePopupIcon=function(){return this.mobileFlag&&this.config.popup.icon.sp.size_custom||!this.mobileFlag&&this.config.popup.icon.pc.size_custom},o.prototype.isText=function(e){return e&&""!==e&&void 0!==e},o.prototype.isColor=function(e){if(!e)return!1;var t=document.createElement("div");return t.style.backgroundColor=e,""!==t.style.backgroundColor},o.prototype.isTrue=function(e){return!0===e||"true"===e||1===e||"1"===e},o.prototype.isFalse=function(e){return!1===e||"false"===e||0===e||"0"===e},o.prototype.isFontFamily=function(e){if(!e)return!1;var t=document.createElement("div");return this.setStyle(t,{fontFamily:e}),""!==t.style.fontFamily},o.prototype.loadPopupImg=function(){var e=this.elementIframe.contentWindow.document,t=this.getRect(e.getElementById("_ul-img-popup-icon"));if(this.stash.imgPopupSp.width=t.width,this.config.popup.sp_wait_image_origin_size&&(this.stash.imgPopupSp.height=t.height),this.elementIframe.style.width=this.stash.imgPopupSp.width+"px",(this.config.popup.sp_wait_image_origin_size||this.isCustomSizePopupIcon())&&(this.elementIframe.style.height=this.stash.imgPopupSp.height+"px"),this.config.close_icon.use){this.elementIframe.style.width=this.stash.imgPopupSp.width+16+"px";var n=e.getElementById("_ul-img-popup-icon"),i=0;this.config.popup.icon_url&&(i=16);var o=this.stash.imgPopupSp.height>0?this.stash.imgPopupSp.height+i:76;this.elementIframe.style.setProperty("height",o+"px");var s=e.getElementById("closeBtn");s.style.setProperty("position","fixed"),s.style.setProperty("bottom","0");var a=this.getRect(s);if(s.style.setProperty("bottom",o-a.height+"px"),n.style.setProperty("position","absolute"),n.style.setProperty("bottom","0"),n.style.setProperty("left","0"),n.style.setProperty("width",this.stash.imgPopupSp.width+"px"),this.isCustomSizePopupIcon()||(n.style.setProperty("object-fit","cover"),n.style.setProperty("object-position","0 0")),this.isCustomSizePopupIcon())t=this.getRect(e.getElementById("_ul-img-popup-icon")),this.stash.imgPopupSp.width=t.width,this.elementIframe.style.width=this.stash.imgPopupSp.width+16+"px",this.stash.imgPopupSp.height=t.height,this.elementIframe.style.height=this.stash.imgPopupSp.height+16+"px";else if(!this.config.popup.sp_wait_image_origin_size){var r=window.innerHeight>window.innerWidth?this.windowSize.width:this.windowSize.height;n.style.setProperty("width","auto"),n.style.setProperty("height",parseInt(.16*r)+"px"),t=this.getRect(e.getElementById("_ul-img-popup-icon")),this.stash.imgPopupSp.width=t.width,this.elementIframe.style.width=this.stash.imgPopupSp.width+16+"px",this.stash.imgPopupSp.height=t.height,this.elementIframe.style.height=this.stash.imgPopupSp.height+16+"px"}}},o.prototype.html2dom=function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild},o.prototype.textElement=function(e,t,n){n||(n=!1);var i=document.createElement(e);if(n){if(n.class_name&&("string"==typeof n.class_name&&(n.class_name=[n.class_name]),this.AnalyticsTagCommon.isArray(n.class_name)))for(var s=0;s<n.class_name.length;s++)n.class_name.hasOwnProperty(s)&&o.addClass(i,n.class_name[s]);n.id&&"string"==typeof n.id&&i.setAttribute("id",n.id)}return n&&"escape"in n&&!1===n.escape?i.innerHTML=t:this.addText(i,t),i},o.prototype.addText=function(e,t){try{e.appendChild(document.createTextNode(t))}catch(e){}},o.prototype.sendFileList=function(e){return this.sendFileListTemplate(e)},o.prototype.sendFileListTemplate=function(e){var t=this,n=this.createElementChatLog();n.style.position="relative";var i=document.createElement("div");i.textContent=this.text.file_list_title;var s=this.Utils.blackOrWhite(this.config.chat_bg_color);i.style.color=s,i.style.borderColor=s,o.addClass(i,"file-list-title"),n.appendChild(i);var a=document.createElement("ul");o.addClass(a,"chat-log-group-file-carousel");var r=this.createElementCarouselSlideNextBtn(),l=this.createElementCarouselSlidePrevBtn();for(var c in o.addEventListener(r,"click",(function(){t.nextSlideCarousel(a,e.length)})),o.addEventListener(l,"click",(function(){t.prevSlideCarousel(a,e.length)})),o.addEventListener(a,"scroll",(function(){a.scrollLeft<=0?l.style.display="none":Math.floor(t.getScrollLeft(a))<=0?r.style.display="none":(l.style.display="block",r.style.display="block")})),n.appendChild(r),n.appendChild(l),e)if(e.hasOwnProperty(c)){var d=e[c],u=document.createElement("li"),p=document.createElement("div");o.addClass(p,"file-title");var h=document.createElement("img"),g=d.thumbnail;"pdf"===d.file_extension?g=this.currentUrl+"/img/filetype/pdf.svg":"txt"!==d.file_extension&&g||(g=this.currentUrl+"/img/filetype/blank.svg"),h.setAttribute("src",g),o.addEventListener(h,"error",(function(e){e.currentTarget.setAttribute("src",t.currentUrl+"/img/filetype/blank.svg")})),p.appendChild(h);var m=document.createElement("p");d.filename_highlight?m.innerHTML=t.textEncoder.convertToSelectionText(d.filename_highlight):m.innerText=d.filename;var _=document.createElement("div");_.setAttribute("class","file-title-tooltip"),_.innerText=d.filename,p.appendChild(_),p.appendChild(m),u.appendChild(p);var f=document.createElement("div");o.addClass(f,"file-context"),f.innerHTML=t.textEncoder.convertToSelectionText(d.context),u.appendChild(f);var y=document.createElement("div");o.addClass(y,"file-img-container");var v=document.createElement("img");v.setAttribute("src",d.thumbnail),o.addClass(v,"pdf"===d.file_extension?"pdf":"icon"),o.addEventListener(v,"error",(function(e){var n=e.currentTarget;o.addClass(n,"blank");var i=n.parentNode;n.setAttribute("src",t.currentUrl+"/img/filetype/blank.svg");var s=i.getElementsByClassName("extension")[0];o.removeClass(s,"hidden")}));var b=this.textElement("div",d.file_extension,{class_name:["extension","hidden"]});if(y.appendChild(b),y.appendChild(v),u.appendChild(y),2===this.config.widget_version&&0!=this.config.gpt_doc_mode&&(1===d.cb_gpt_search_status||1===d.ulgpt_search_status)){var x=document.createElement("a");x.dataset.fileH=d.file_h,x.dataset.fileName=d.filename,o.addClass(x,"enter-gpt-doc"),x.textContent=this.text.file_gpt_doc,x.addEventListener("click",(function(){t.stash.gpt_doc_file_hs=[],t.stash.gpt_doc_file_hs.push(this.dataset.fileH),t.enterGptMode("gpt_doc",this.dataset.fileName)})),u.appendChild(x)}var w=document.createElement("a");w.setAttribute("href",d.preview_link),w.setAttribute("target","_blank"),w.setAttribute("tabIndex","0"),o.addClass(w,"file-preview"),w.textContent=this.text.file_preview,u.appendChild(w),a.appendChild(u)}return n.appendChild(a),n},o.prototype.createElementCarouselSlideNextBtn=function(){var e=document.createElement("a");e.setAttribute("class","carousel_arrow");var t=document.createElement("span");return t.setAttribute("class","carousel_slide_icon next_slide_icon"),e.appendChild(t),e},o.prototype.createElementCarouselSlidePrevBtn=function(){var e=document.createElement("a");e.setAttribute("class","carousel_arrow prev");var t=document.createElement("span");return t.setAttribute("class","carousel_slide_icon prev_slide_icon"),e.appendChild(t),e.style.display="none",e},o.prototype.getCustomFormLabel=function(e){if("string"==typeof e)return document.createTextNode(e);var t=document.createElement("span");return this.addText(t,e.text),delete e.text,this.setStyle(t,e)},o.prototype.setStyle=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n]);return e},o.prototype.createElementChatLog=function(){var e=document.createElement("div");if(o.addClass(e,"chat-log"),this.config.site_in&&(e.style.width=parseInt(this.elementIframe.width)-32+"px","windows"==o.checkDesktopOs())){var t=o.hasClass(this.elementChatLog,"windows-scrollbar")?32:52;e.style.width=parseInt(this.elementIframe.width)-t+"px"}return e},o.prototype.getRandomStr=function(e){for(var t="",n=0;n<e;n++)t+="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz".charAt(Math.floor(58*Math.random()));return t},o.prototype.showChatWidget=function(){this.elementIframe.style.setProperty("display","block"),this.elementIframe.style.setProperty("visibility","")},o.prototype.hideChatWidget=function(){this.config.site_in?this.elementIframe.style.setProperty("display","none"):this.elementIframe.style.setProperty("visibility","hidden"),-1==[648,2320,2531,2607,2716,3056].indexOf(this.config.id)||this.config.site_in||this.elementIframe.style.setProperty("display","none")},o.prototype.execCustomEvent=function(e,t){if(e)try{switch(e){case"initialized":this.customEvent.onInitialized();break;case"chat":this.customEvent.onChat(t);break;case"popup_open":this.customEvent.onPopupOpen();break;case"popup_close":this.customEvent.onPopupClose();break;case"popup_remove":this.customEvent.onPopupRemove();break;case"init_error":this.customEvent.onInitError()}}catch(e){console.error(e)}},o.prototype.setCustomEvent=function(e,t){switch(e){case"initialized":this.customEvent.onInitialized=t.bind(window);break;case"chat":this.customEvent.onChat=t.bind(window);break;case"popup_open":this.customEvent.onPopupOpen=t.bind(window);break;case"popup_close":this.customEvent.onPopupClose=t.bind(window);break;case"popup_remove":this.customEvent.onPopupRemove=t.bind(window);break;case"init_error":this.customEvent.onInitError=t.bind(window)}},o.prototype.popupOpen=function(e){var t=this;e=e||{},this.config.site_in||("modal"!==this.config.popup_open_type||2!==this.config.widget_version?(this.flag.open&&!e.scrollCall||(2===this.config.widget_version?(this.v2Header.togglePopup(),this.quickSearchMenu&&setTimeout((function(){t.quickSearchMenu.controlSlideBtn()}),500),this.mobileFlag?this.v2OpenSpWidget():this.v2OpenPcWidget(e),(this.flag.gpt_mode||this.flag.gpt_doc_mode)&&this.adjustSendInputHeight()):this.mobileFlag?this.openSpWidget():this.openPcWidget()),this.elementIframe.style.zIndex=2147483647):this.popupOpenModal())},o.prototype.popupClose=function(e){if(e=e||{},!this.config.site_in)if("modal"!==this.config.popup_open_type){if(this.flag.open||e.scrollCall){if(this.stash.operator.ws)return void this.showExitOperatorModeModal();2===this.config.widget_version?(this.v2Header.togglePopup(),this.mobileFlag?this.v2CloseSpWidget():this.v2OpenPcWidget(e)):this.mobileFlag?this.closeSpWidget():this.openPcWidget()}this.elementIframe.style.zIndex=this.config.z_index}else this.popupCloseModal()},o.prototype.poopupToggle=function(e){var t=this.elementIframe;this.mobileFlag&&(t=this.elementIframe.contentWindow.document.getElementById("_ul-main-window")),o.hasClass(t,"ul-widget-hide")?this.popupOpen(e):this.popupClose(e)},o.prototype.removePopup=function(){this.removeMe(this.elementIframe),this.balloonIframe&&(this.removeMe(this.balloonIframe),this.balloonIframe=null),this.config.close_icon.redisplay_flag||o.setCookie("__ulcb_closed_at_"+this.config.hid,this.getRandomStr(16),1800,this.fp_domains,this.config.cross_domain),this.execCustomEvent("popup_remove")},o.prototype.popupOpenModal=function(){var e=this;if(!this.flag.open){this.flag.open=!0,this.flag.popup_modal_opened=!0;var t=document.querySelector("body");this.parentBodyStyle=t.getAttribute("style"),t.setAttribute("style","overflow: hidden;");var n=document.getElementById("modal_"+this.stash.popupModalWidgetId);if(n)n.style.display="flex",this.stash.children[this.stash.popupModalWidgetId]&&this.stash.children[this.stash.popupModalWidgetId].resizeInlineWidget();else{this.stash.popupModalWidgetId="ulAiWidget_"+this.getRandomStr(16),(n=document.createElement("div")).setAttribute("id","modal_"+this.stash.popupModalWidgetId),n.setAttribute("style","position:fixed; display: flex; justify-content: center; align-items: center; top: 0px; left:0px; width: 100%; height: 100%; margin: 0px; padding: 0px; background: rgba(0, 0, 0, .5); z-index: 2147483647;"),o.addEventListener(n,"click",(function(){e.popupCloseModal()})),document.body.appendChild(n);var i=document.createElement("div");i.setAttribute("id",this.stash.popupModalWidgetId),this.mobileFlag?(i.style.width="calc(100% - 16px)",i.style.height="calc(100% - 64px)"):(i.style.width="800px",i.style.height="650px",i.style.maxWidth="calc(100% - 16px)",i.style.maxHeight="calc(100% - 16px)"),n.appendChild(i);var s=this.Utils.copyObject(this.originParams);s.target_id=this.stash.popupModalWidgetId,s.site_in=!0,s.popup_modal=!0,s.popup_modal_parent=this,this.push(["init",s])}e.execCustomEvent("popup_open")}},o.prototype.popupCloseModal=function(){var e=this.flag.popup_modal?this.stash.popupModalParent:this,t=e.stash.children[e.stash.popupModalWidgetId];if(t&&t.stash.operator.ws)t.showExitOperatorModeModal();else if(e.flag.open){e.flag.open=!1,e.flag.popup_modal_opened=!1;var n=document.getElementById("modal_"+e.stash.popupModalWidgetId);n&&(n.style.display="none",document.querySelector("body").setAttribute("style",e.parentBodyStyle)),e.execCustomEvent("popup_close")}},o.prototype.createFontFamilySetting=function(e,t){var n="BlinkMacSystemFont, Segoe UI, ";if("windows"===o.checkDesktopOs())switch(e){case"Meiryo":default:n+="";break;case"YuGothic":n+='YuGothic,"Yu Gothic", ';break;case"YuMincho":n+='"Yu Mincho Light", "YuMincho", "Yu Mincho", "游明朝体", ';break;case"HGMaruGothicMPRO":n+='"HG丸ｺﾞｼｯｸM-PRO", HGMaruGothicMPRO, '}if("Mac"===o.checkDesktopOs()||o.Os.iOs)switch(t){case"HiraginoKakuGothicProN":default:n+="";break;case"HiraginoSans":n+='"ヒラギノ角ゴシック", "Hiragino Sans", ';break;case"YuGothic":n+='YuGothic, "Yu Gothic", ';break;case"HiraginoMinchoProN":n+='"ヒラギノ明朝 ProN","Hiragino Mincho ProN", ';break;case"HiraginoMaruGothicProN":n+='"ヒラギノ丸ゴ ProN","Hiragino Maru Gothic ProN", '}return n+'"Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "メイリオ", Meiryo, Verdana, ＭＳ Ｐゴシック, Roboto, Droid Sans, sans-serif'},o.prototype.createSuggest=function(){var e=this,t=this.elementIframe.contentWindow.document;e.stash.suggest||e.getSuggest((function(n){if("error"!=n.responseText&&""!=n.responseText){var i=e.JSON3.parse(n.responseText);e.config.suggest=i.suggest,2===e.config.widget_version?e.stash.suggest=new e.Suggest.Local(e.v2InputBox.getElementSend(),e.v2InputBox.getElementSuggest(),e.elementChatLog,e.config.suggest,{displayMax:e.config.suggestConf.displayMax,recommendFunnelFlag:e.config.recommend_funnel_flag,selectedCid:e.stash.selectedCid,parent:e},t):e.config.display_input_box&&(e.stash.suggest=new e.Suggest.Local("send","suggest",e.elementChatLog,e.config.suggest,{displayMax:e.config.suggestConf.displayMax,recommendFunnelFlag:e.config.recommend_funnel_flag,selectedCid:e.stash.selectedCid,parent:e},t))}else e.sendSurveyLog({event_type:"error",error_message:"request error - suggest"})}))},o.prototype.createLinkCss=function(){var e=document.createElement("link");if(e.setAttribute("rel","stylesheet"),this.config.site_in)if(this.mobileFlag){var t="chatbot_sp_in";e.setAttribute("href",this.currentUrl+"/"+t+".css?t="+this.cssTimestamp+"0")}else e.setAttribute("href",this.currentUrl+"/chatbot_pc_in.css?t="+this.cssTimestamp);else this.mobileFlag?(t="chatbot_sp",e.setAttribute("href",this.currentUrl+"/"+t+".css?t="+this.cssTimestamp)):e.setAttribute("href",this.currentUrl+"/chatbot_pc.css?t="+this.cssTimestamp);return e},o.prototype.v2Init=function(e,t){if(!o.Browser.IE9&&!o.Browser.IE10){var n=this;if(o.Browser.DefaultBrowser&&(n.config.display_input_box=!1,n.config.powered_by=!1),o.Browser.DefaultBrowser){if(!n.config.site_in)return;n.config.animation=!1,n.params.first_talk=n.text.un_support_android,n.params.hasOwnProperty("response_message_no")&&""!==n.params.response_message_no&&(n.params.first_talk=n.params.response_message_no),n.params.suggest=[],n.params.first_list="",n.config.remove_space=!0,n.params.maintenance=!1}if(n.config.id){"maintenance"in n.params&&n.params.maintenance.status&&(n.flag.maintenance=!!n.params.maintenance.status,"message"in n.params.maintenance&&n.params.maintenance.message&&(n.text.maintenance=n.params.maintenance.message),"image"in n.params.maintenance&&n.params.maintenance.image&&!n.params.maintenance.image&&(n.config.maintenance.image=n.params.maintenance.image));var i=n.config.site_in?0:n.config.popup.display_delay_time;setTimeout((function(){var i=n.elementIframe=document.createElement("iframe");if(i.scrolling="no",i.frameBorder=0,i.marginWidth=0,i.marginHeight=0,i.title="AI Chat Support",o.addClass(i,"ul-widget-main-window"),n.renderedIframe=!0,n.runPushBeforeEvent(),!n.insertWidgetForPage())return!1;var s=i.contentWindow.document;s.open(),s.close(),n.flag.popup_modal&&(i.style.borderRadius="12px",s.body.style.border="none"),o.Os.iOs&&s.body.style.setProperty("-webkit-text-size-adjust","100%");var a=document.createElement("div");a.setAttribute("id","_ul-widget");var r=document.createElement("div");r.setAttribute("id","_ul-chat-widget"),n.config.site_in||r.setAttribute("class","hidden");var l=document.createElement("div");if(l.setAttribute("id","_ul-chat-widget-chat-log"),l.setAttribute("lang",n.config.lang),n.config.site_in||l.setAttribute("class","hidden"),-1!==[648,3442].indexOf(n.config.id)&&l.setAttribute("wovn-ignore",""),"windows"!==o.checkDesktopOs()||o.Browser.IE||o.Browser.Firefox||o.addClass(l,"windows-scrollbar"),n.elementChatLog=l,!n.config.operator_mode&&n.config.quick_search_keywords.length>0&&5!==n.config.gpt_doc_mode&&!n.flag.maintenance&&(n.quickSearchMenu=new n.QuickSearchMenu({keywords:n.config.quick_search_keywords,sendKeywords:function(e){n.sendUserChatLog(e)},restartTalk:function(){n.restartTalk()},controlSlideBtn:function(){if(n.quickSearchMenu){var e=n.quickSearchMenu.getElement(),t=n.quickSearchMenu.getMenuElement();t.offsetWidth<=e.offsetWidth?(0===t.scrollLeft?n.quickSearchMenu.hidePrevBtn():n.quickSearchMenu.showPrevBtn(),t.scrollWidth<=t.scrollLeft+4+e.offsetWidth?n.quickSearchMenu.hideNextBtn():n.quickSearchMenu.showNextBtn()):(n.quickSearchMenu.hideNextBtn(),n.quickSearchMenu.hidePrevBtn())}}})),"textarea"!==n.config.input_box_type?n.v2InputBox=new n.InputBox({siteIn:n.config.site_in,mobileFlag:n.mobileFlag,currentUrl:n.currentUrl,translateBtnFlag:n.isTranslateEnabled(),reloadBtnFlag:n.config.reload_btn,menuEnabledFlag:n.isMenuEnabled(),reloadBtnIcon:n.config.reload_btn_icon,poweredByFlag:n.config.powered_by,displayImageBtn:n.config.operator.send_img_flag,displayInputBoxFlag:n.config.display_input_box,sendIcon:n.config.send_icon,inputPlaceholder:n.text.input_placeholder,inputTextColor:e.input_text_color,inputButtonValue:n.text.input_button_value,submitTextColor:e.send_text_color,submitBgColor:e.send_bg_color,inputBgColor:e.input_bg_color,quickSearchMenu:n.quickSearchMenu,clickReloadBtn:function(e){return e.stopPropagation(),n.restartBtnEvent(),!1},clickSubmitBtn:function(){n.sendChat(n.v2InputBox.getElementSend(),n.elementChatLog,n)},clickSendInput:function(){n.changeLogSize()},clickImageBtn:function(){n.displayImageUploader()},keyPressSendInput:function(e){n.config.error?n.v2InputBox.getElementSend().setAttribute("disabled","disabled"):13===e.keyCode&&(e.shiftKey||n.sendChat(n.v2InputBox.getElementSend(),n.elementChatLog,n))},keyUpSendInput:function(e){if(13===e.keyCode)return!1;if(n.stash.operator.ws){var t=new Date;n.stash.operator.timeLastKeypress=t.getTime(),n.stash.operator.flagTyping||(n.stash.operator.flagTyping=!0,n.sendUserTyping(1),n.stash.operator.intervalCheckerUserInput=setInterval((function(){n.checkerUserInput()}),n.config.timeCheckerUserInput))}},inputSendInput:function(){n.scrollToInputBox()},clickMenuBtn:function(e){n.toggleMenu()},focusSendInput:function(e){e.preventDefault(),n.v2ResizeChatLogHeight(),n.scrollToInputBox(),n.createSuggest()},blurSendInput:function(e){},setSuggestDisplayFlag:function(e){n.stash.suggest&&(n.stash.suggest.display=e)}}):n.v2InputBox=new n.NewLineInputBox({siteIn:n.config.site_in,mobileFlag:n.mobileFlag,currentUrl:n.currentUrl,translateBtnFlag:n.isTranslateEnabled(),reloadBtnFlag:n.config.reload_btn,menuEnabledFlag:n.isMenuEnabled(),reloadBtnIcon:n.config.reload_btn_icon,poweredByFlag:n.config.powered_by,displayImageBtn:n.config.operator.send_img_flag,displayInputBoxFlag:n.config.display_input_box,sendIcon:n.config.send_icon,inputPlaceholder:n.text.input_placeholder,inputTextColor:e.input_text_color,inputButtonValue:n.text.input_button_value,submitTextColor:e.send_text_color,submitBgColor:e.send_bg_color,inputBgColor:e.input_bg_color,quickSearchMenu:n.quickSearchMenu,clickReloadBtn:function(e){return e.stopPropagation(),n.restartBtnEvent(),!1},clickSubmitBtn:function(){n.sendChat(n.v2InputBox.getElementSend(),n.elementChatLog,n)},clickSendInput:function(){n.changeLogSize()},clickImageBtn:function(){n.displayImageUploader()},keyPressSendInput:function(e){if(n.config.error)n.v2InputBox.getElementSend().setAttribute("disabled","disabled");else if(13===e.keyCode)if(e.shiftKey);else{if(n.mobileFlag)return!1;e.preventDefault(),n.sendChat(n.v2InputBox.getElementSend(),n.elementChatLog,n),n.v2ResizeChatLogHeight()}},keyUpSendInput:function(e){if(13===e.keyCode)return!1;if(n.stash.operator.ws){var t=new Date;n.stash.operator.timeLastKeypress=t.getTime(),n.stash.operator.flagTyping||(n.stash.operator.flagTyping=!0,n.sendUserTyping(1),n.stash.operator.intervalCheckerUserInput=setInterval((function(){n.checkerUserInput()}),n.config.timeCheckerUserInput))}},clickMenuBtn:function(e){n.toggleMenu()},focusSendInput:function(e){e.preventDefault(),n.v2ResizeChatLogHeight(),n.scrollToInputBox(),n.createSuggest()},inputSendInput:function(){n.v2ResizeChatLogHeight(!0),n.v2InputBox.scrollInputBoxBottom(),n.scrollToInputBox()},blurSendInput:function(e){n.v2ResizeChatLogHeight(),n.v2InputBox.scrollInputBoxBottom()},setSuggestDisplayFlag:function(e){n.stash.suggest&&(n.stash.suggest.display=e)}}),e.input_text_color&&n.isColor(e.input_text_color)){var c="b3";n.setCssStyle("#_ul-chat-widget #v2InputBoxSend:placeholder-shown","color: "+e.input_text_color+c+";"),n.setCssStyle("#_ul-chat-widget #v2InputBoxSend::placeholder","color: "+e.input_text_color+c+";"),n.setCssStyle("#_ul-chat-widget #v2InputBoxSend:-ms-input-placeholder","color: "+e.input_text_color+c+";"),n.setCssStyle("#_ul-chat-widget #v2InputBoxSend::-ms-input-placeholder","color: "+e.input_text_color+c+";"),n.setCssStyle("#v2InputBoxSend:placeholder-shown","color: "+e.input_text_color+c+";"),n.setCssStyle("#v2InputBoxSend::placeholder","color: "+e.input_text_color+c+";"),n.setCssStyle("#v2InputBoxSend:-ms-input-placeholder","color: "+e.input_text_color+c+";"),n.setCssStyle("#v2InputBoxSend::-ms-input-placeholder","color: "+e.input_text_color+c+";")}var d=new n.NewLineInputBox({operatorFlag:!0,currentUrl:n.currentUrl,poweredByFlag:n.config.powered_by,mobileFlag:n.mobileFlag,displayInputBoxFlag:!0,siteIn:n.config.site_in,displayImageBtn:n.config.operator.send_img_flag,sendIcon:n.config.send_icon,inputPlaceholder:n.text.input_placeholder,lineBreakPlaceholder:n.text.line_break_placeholder,inputTextColor:e.input_text_color,inputButtonValue:n.text.input_button_value,submitTextColor:e.send_text_color,submitBgColor:e.send_bg_color,inputBgColor:e.input_bg_color,clickSubmitBtn:function(){n.sendChat(d.getElementSend(),n.elementChatLog,n),n.adjustSendInputHeight("init"),d.getElementSend().focus()},clickSendInput:function(){n.changeLogSize(),n.adjustSendInputHeight()},clickImageBtn:function(){n.displayImageUploader()},keyPressSendInput:function(e){if(n.config.error)d.getElementSend().setAttribute("disabled","disabled");else if(13===e.keyCode)if(e.shiftKey);else{if(n.mobileFlag)return!1;e.preventDefault(),n.sendChat(d.getElementSend(),n.elementChatLog,n),n.adjustSendInputHeight("init")}},inputSendInput:function(){n.adjustSendInputHeight(),n.scrollToInputBox()},keyUpSendInput:function(e){if(13===e.keyCode)return!1;if(n.stash.operator.ws){var t=new Date;n.stash.operator.timeLastKeypress=t.getTime(),n.stash.operator.flagTyping||(n.stash.operator.flagTyping=!0,n.sendUserTyping(1),n.stash.operator.intervalCheckerUserInput=setInterval((function(){n.checkerUserInput()}),n.config.timeCheckerUserInput))}},blurSendInput:function(e){n.adjustSendInputHeight("init")}});e.input_text_color&&n.isColor(e.input_text_color)&&(c="b3",n.setCssStyle("#_ul-chat-widget #v2OperatorInputBoxSend:placeholder-shown","color: "+e.input_text_color+c+";"),n.setCssStyle("#_ul-chat-widget #v2OperatorInputBoxSend::placeholder","color: "+e.input_text_color+c+";"),n.setCssStyle("#_ul-chat-widget #v2OperatorInputBoxSend:-ms-input-placeholder","color: "+e.input_text_color+c+";"),n.setCssStyle("#_ul-chat-widget #v2OperatorInputBoxSend::-ms-input-placeholder","color: "+e.input_text_color+c+";"),n.setCssStyle("#v2OperatorInputBoxSend:placeholder-shown","color: "+e.input_text_color+c+";"),n.setCssStyle("#v2OperatorInputBoxSend::placeholder","color: "+e.input_text_color+c+";"),n.setCssStyle("#v2OperatorInputBoxSend:-ms-input-placeholder","color: "+e.input_text_color+c+";"),n.setCssStyle("#v2OperatorInputBoxSend::-ms-input-placeholder","color: "+e.input_text_color+c+";")),n.v2OperatorInputBox=d,5!==n.config.gpt_doc_mode||n.flag.maintenance||(o.Browser.IE||(n.v2InputBox=d),n.v2InputBox.changeGptMode(),n.v2InputBox.show()),n.v2Header=new n.Header({reloadBtnFlag:n.config.reload_btn,reloadBtnIcon:n.config.reload_btn_icon,translateBtnFlag:n.isTranslateEnabled(),menuEnabledFlag:n.isMenuEnabled(),mobileFlag:n.mobileFlag,gptModeFlag:n.config.gpt_mode,gptDocModeFlag:n.config.gpt_doc_mode,siteIn:n.config.site_in,title:n.config.title,closeIconUse:n.config.close_icon.use,pcIconUrl:n.config.popup.pc_icon_url,headerTopHeight:n.mobileFlag?"55px":n.config.popup.pc_header_height,titleTextColor:e.title_text_color,headerTopBgColor:e.widget_bg_color,closeBtnColor:e.widget_close_color,clickHeader:function(){n.stash.operator.ws?n.showExitOperatorModeModal():(n.v2Header&&n.v2Header.getFullScreenFlag()&&(n.v2SwitchFullScreenPcWidget(!1),n.v2Header.removeEventDraggable()),n.elementIframe.style.top="",n.elementIframe.style.left="",n.poopupToggle())},mouseDownHeader:function(e){var t=n.elementIframe.contentWindow.document,i=e.pageX,o=e.pageY,s=n.elementIframe,a=n.elementIframe.style.maxHeight;n.elementIframe.style.maxHeight="";var r=n.elementIframe.style.transition;n.elementIframe.style.transition="";var l=150,c=t.getElementById("_ul-widget");c.classList.add("mouse-move"),c.style.borderRadius=parseInt(n.config.popup.pc_header_border_radius)+"px",c.style.overflow="hidden";var d=document.createElement("div");function u(e){n.elementIframe.style.transition="",s.style.opacity=.6;var t=s.offsetTop+e.pageY-l-4-o,a=s.offsetLeft+e.pageX-4-i;t+l+8>0&&(s.style.top=t+"px"),s.style.left=a+"px"}function p(){s.style.opacity=1,t.body.removeChild(d),s.style.top=parseInt(s.style.top)+l+4+"px",s.style.left=s.offsetLeft+4+"px",c.classList.remove("mouse-move"),c.style.borderRadius="",c.style.overflow="",n.elementIframe.style.height=n.config.out.height,n.elementIframe.style.width=n.config.out.width,n.elementIframe.style.maxHeight=a,n.elementIframe.style.boxShadow="0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.3)",t.body.removeEventListener("mousemove",u),t.body.removeEventListener("mouseup",p),t.body.removeEventListener("mouseleave",p),setTimeout((function(){n.elementIframe.style.transition=r}),100)}d.style.height=l+"px",t.body.insertBefore(d,c),s.style.height=parseInt(n.config.out.height)+l+8+"px",s.style.width=parseInt(n.config.out.width)+8+"px",s.style.boxShadow="",s.style.top?(s.style.top=s.offsetTop-l-4+"px",s.style.left=s.offsetLeft-4+"px"):(s.style.top=s.offsetTop+4+"px",s.style.left=s.offsetLeft+4+"px"),t.body.addEventListener("mousemove",u),t.body.addEventListener("mouseup",p),t.body.addEventListener("mouseleave",p)},clickReloadBtn:function(e){return e.stopPropagation(),n.restartBtnEvent(),!1},clickTranslateBtn:function(e){return e.stopPropagation(),n.toggleLanguageMenu(),!1},updateAriaEvent:function(e){var t=s.getElementById("_ul-widget"),i=s.getElementById("_ul-widget-btn"),o=s.getElementById("popupIcon");n.config.popup.pc_icon_url&&t.setAttribute("aria-hidden",!e),n.mobileFlag&&i?i.setAttribute("aria-expanded",e):n.config.popup.pc_icon_url&&o&&o.setAttribute("aria-expanded",e)},clickMenuBtn:function(e){n.languageMenu&&n.languageMenu.hide(),n.toggleMenu()},clickFullScreenBtn:function(e){var t=n.v2Header.getFullScreenBtn(),i=s.getElementById("tooltipFullScreenButton");i&&(n.removeMe(i),e?n.appendElementTooltip(t,n.text.tooltip_fullscreen_button,"bottom","tooltipFullScreenButton"):n.appendElementTooltip(t,n.text.tooltip_exit_fullscreen_button,"bottom","tooltipFullScreenButton")),e?o.removeClass(n.elementChatLog,"portrait-lg"):n.v2ResizePopupFullScreen(),n.v2SwitchFullScreenPcWidget(!e)},addResizePopupFullScreenEvent:function(){var e;o.addEventListener(window,"resize",(function(){!e&&n.v2Header.getFullScreenFlag()&&(e=setTimeout((function(){e=0,n.v2ResizePopupFullScreen()}),500))}))}}),n.config.site_in&&n.isTranslateEnabled()?n.languageHeader=new n.LanguageHeader({mobileFlag:n.mobileFlag,reloadBtnFlag:n.config.reload_btn,reloadBtnIcon:n.config.reload_btn_icon,popupModalFlag:n.flag.popup_modal,clickTranslateBtn:function(e){return e.stopPropagation(),n.toggleLanguageMenu(),!1},clickReloadBtn:function(e){return e.stopPropagation(),n.restartBtnEvent(),!1},clickCloseBtn:function(e){return e.stopPropagation(),n.popupCloseModal(),!1}}):n.flag.popup_modal&&(n.modalHeader=new n.ModalHeader({clickCloseBtn:function(e){return e.stopPropagation(),n.popupCloseModal(),!1}})),n.config.site_in||(a.appendChild(n.v2Header.getElement()),n.config.popup.pc_icon_url&&a.setAttribute("aria-hidden",!0)),n.config.site_in&&n.isTranslateEnabled()?r.appendChild(n.languageHeader.getElement()):n.flag.popup_modal&&r.appendChild(n.modalHeader.getElement()),r.appendChild(n.elementChatLog),n.quickSearchMenu&&r.appendChild(n.quickSearchMenu.getElement()),r.appendChild(n.v2InputBox.getElement()),o.Browser.IE||r.appendChild(d.getElement()),a.appendChild(r);var u=document.createElement("div");u.setAttribute("id","ariaLive"),u.setAttribute("aria-live","assertive"),u.setAttribute("aria-atomic","true"),u.style.clip="rect(0px, 0px, 0px, 0px)",u.style.height="1px",u.style.margin="-1px",u.style.overflow="hidden",u.style.padding="0px",u.style.width="1px",u.style.position="absolute",a.appendChild(u);var p,h=n.createLinkCss();if(s.body.appendChild(h),n.config.site_in||!n.mobileFlag&&!n.config.popup.pc_icon_url&&"modal"!==n.config.popup_open_type)n.v2PopupIcon=new n.DefaultPopupIcon({title:n.config.title,popupMessage:n.textEncoder.convertToSelectionText(n.config.popup.message),closeIconUse:n.config.close_icon.use,botImg:n.config.bot_img,botIconCircle:n.config.bot_icon.circle,headerTopBgColor:e.widget_bg_color,titleTextColor:e.title_text_color,closeBtnColor:e.widget_close_color,clickIcon:function(){n.popupOpen()},clickCloseBtn:function(){n.removePopup()},displayPcPopupIcon:function(){n.elementIframe.contentWindow.document.getElementById("_ul-widget").style.setProperty("display","none"),n.elementIframe.style.setProperty("width",n.config.out.width+"px"),n.elementIframe.style.setProperty("height",n.v2PopupIcon.getHeaderBottomHeight()+64+"px");var e=n.config.popup.space.pc;parseInt(e.width)>=0&&("left"===n.config.position?n.elementIframe.style.setProperty("left",e.width):n.elementIframe.style.setProperty("right",e.width)),parseInt(e.height)>=0&&n.elementIframe.style.setProperty("bottom",e.height)},hiddenPcPopupIcon:function(){var e=n.elementIframe.contentWindow.document.getElementById("_ul-widget");n.elementIframe.style.setProperty("width",n.config.out.width),n.elementIframe.style.setProperty("height",n.config.out.height),e.style.setProperty("display","block");var t=n.config.popup.space.pc;(t.width>=0||t.height>=0)&&("left"===n.config.position?n.elementIframe.style.setProperty("left",t.width):n.elementIframe.style.setProperty("right",t.width),n.elementIframe.style.setProperty("bottom","0"))}});else{var g=o.Browser.IE?n.currentUrl+"/img/default_popup_icon.png":n.currentUrl+"/img/default_popup_icon.svg";n.v2PopupIcon=new n.PopupIcon({siteIn:n.config.site_in,mobileFlag:n.mobileFlag,defaultIconFlag:n.config.popup.default_icon,modalFlag:"modal"===n.config.popup_open_type,closeIconUse:n.config.close_icon.use,isCustomSizePopupIcon:n.isCustomSizePopupIcon(),defaultPcIconUrl:g,pcIconUrl:n.config.popup.pc_icon_url,pcIconWidth:n.config.popup.icon.pc.width,pcIconHeight:n.config.popup.icon.pc.height,spIconUrl:n.config.popup.icon_url,spIconWidth:n.config.popup.icon.sp.width,spIconHeight:n.config.popup.icon.sp.height,closeIconSpSize:n.config.close_icon.sp_size,spWaitImageOriginSize:n.config.popup.sp_wait_image_origin_size,pcIconBalloonStatus:n.config.popup.icon.pc.balloon.status,pcIconBalloonMessage:n.textEncoder.convertToSelectionText(n.config.popup.icon.pc.balloon.message),clickIcon:function(){n.popupOpen()},clickCloseBtn:function(){n.removePopup()},keyupCloseBtn:function(e){13===e.keyCode&&n.removePopup()},initImgPopupPcSize:function(){var e=n.v2PopupIcon.getImgElement();n.stash.imgPopupPc={width:n.isCustomSizePopupIcon()?parseInt(n.config.popup.icon.pc.width):e.width,height:n.isCustomSizePopupIcon()?parseInt(n.config.popup.icon.pc.height):e.height}},loadPcImage:function(){var e=n.v2PopupIcon.getImgElement();n.v2PopupIcon.initImgPopupPcSize(),n.config.close_icon.use&&(e.style.setProperty("position","absolute"),e.style.setProperty("bottom","0")),n.config.popup.icon.pc.balloon.status&&(e.style.setProperty("position","absolute"),e.style.setProperty("bottom","0"),n.config.close_icon.use&&"right"==n.config.position?e.style.setProperty(n.config.position,"10px"):e.style.setProperty(n.config.position,"0px")),n.config.default_open?e.style.setProperty("display","none"):n.v2PopupIcon.setPopupIconPosition()},errorPcImage:function(){n.v2PopupIcon.getElement().setAttribute("src",g)},loadSpImage:function(){n.loadPopupImg()},errorSpImage:function(){var e=n.v2PopupIcon.getElement(),t=n.v2PopupIcon.getImgElement();e.removeChild(t),e.appendChild(n.html2dom(n.mobilePopupSvg))},loadIntervalSpImg:function(){var e=setInterval((function(){0===parseInt(n.elementIframe.style.width)?n.loadPopupImg():clearInterval(e)}),100)},displayPcPopupIcon:function(){n.elementIframe.contentWindow.document.getElementById("_ul-widget").style.setProperty("display","none"),n.elementIframe.style.boxShadow="none",n.elementIframe.style.setProperty("border-radius","0 0 0 0"),n.elementIframe.style.setProperty("width",n.stash.imgPopupPc.width+"px"),n.elementIframe.style.setProperty("height",n.stash.imgPopupPc.height+"px");var e=n.config.popup.space.pc;parseInt(e.width)>=0&&("left"===n.config.position?n.elementIframe.style.setProperty("left",e.width):n.elementIframe.style.setProperty("right",e.width)),parseInt(e.height)>=0&&n.elementIframe.style.setProperty("bottom",e.height)},hiddenPcPopupIcon:function(){var e=n.elementIframe.contentWindow.document.getElementById("_ul-widget");n.elementIframe.style.setProperty("width",n.config.out.width),n.elementIframe.style.setProperty("height",n.config.out.height),e.style.setProperty("display","block");var t=n.config.popup.space.pc;(t.width>=0||t.height>=0)&&("left"===n.config.position?n.elementIframe.style.setProperty("left",t.width):n.elementIframe.style.setProperty("right",t.width),n.elementIframe.style.setProperty("bottom","0"))},setPopupIconPosition:function(){n.v2PopupIcon.getImgElement().style.setProperty("display","block");var e=n.stash.imgPopupPc.width,t=n.stash.imgPopupPc.height;if(n.config.close_icon.use){n.stash.imgPopupPc.width=n.stash.imgPopupPc.width+10,n.stash.imgPopupPc.height=n.stash.imgPopupPc.height+10;var i=n.v2PopupIcon.getCloseBtnElement(),o=n.getRect(i);i.style.setProperty("bottom","0");var s=setInterval((function(){if((o=n.getRect(i)).left>0){clearInterval(s);var a=t+10-o.height;i.style.setProperty("bottom",a+"px"),"left"===n.config.position&&i.style.setProperty("left",e-18+"px")}}),16)}n.elementIframe.style.setProperty("width",n.stash.imgPopupPc.width+"px"),n.elementIframe.style.setProperty("height",n.stash.imgPopupPc.height+"px"),setTimeout((function(){if(n.config.popup.icon.pc.balloon.status&&n.v2PopupIcon.ballonOpenedFlag&&"none"!==n.elementIframe.style.display&&"hidden"!==n.elementIframe.style.visibility){n.balloonIframe=document.createElement("iframe"),n.balloonIframe.setAttribute("style","margin:0px; position: fixed; box-shadow: none; border: none;"),n.balloonIframe.style.zIndex=n.config.z_index,n.balloonIframe.scrolling="no",document.body.appendChild(n.balloonIframe);var i=n.balloonIframe.contentWindow.document;i.open(),i.close();var o=n.createLinkCss();i.body.appendChild(o),i.body.setAttribute("style","margin: 0px; padding:1px;");var s=n.v2PopupIcon.getPopupBalloonElement();i.body.appendChild(s),o.onload=function(){var i=setInterval((function(){var o=n.getRect(s);if(o.height>0&&o.width>0){clearInterval(i);var a=0;n.config.close_icon.use&&(a=10),"top"===n.config.popup.icon.pc.balloon.position?(n.balloonIframe.width=o.width+4+"px",n.balloonIframe.height=o.height+8+4+"px",n.balloonIframe.style.bottom=n.styleHideBottom+t+10+"px","right"===n.config.position?(n.balloonIframe.style.right=parseInt(n.config.popup.space.pc.width)+a+"px",s.classList.add("top-right")):(n.balloonIframe.style.left=parseInt(n.config.popup.space.pc.width)+"px",s.classList.add("top-left"))):(n.balloonIframe.width=o.width+8+4+"px",n.balloonIframe.height=o.height+4+"px",n.balloonIframe.style.bottom=n.styleHideBottom+n.elementIframe.offsetHeight/2-o.height/2+"px","right"===n.config.position?(n.balloonIframe.style.right=parseInt(n.config.popup.space.pc.width)+e+a+10+"px",s.classList.add("side-right")):(n.balloonIframe.style.left=parseInt(n.config.popup.space.pc.width)+e+10+"px",s.classList.add("side-left"))),s.style.visibility="visible"}}),16)}}}),500)},clickBalloonCloseBtn:function(){this.hiddenBalloonElement()},hiddenBalloonElement:function(){n.balloonIframe&&(n.removeMe(n.balloonIframe),n.balloonIframe=null),this.setBalloonOpenedFlag(!1)}})}if(n.config.site_in)s.body.appendChild(a);else if(n.mobileFlag){s.body.appendChild(n.v2PopupIcon.getElement()),n.config.close_icon.use&&s.body.appendChild(n.v2PopupIcon.getCloseBtnElement());var m=document.createElement("div");m.setAttribute("id","_ul-main-window"),m.setAttribute("class","hidden"),m.appendChild(a),s.body.appendChild(m)}else s.body.appendChild(a),s.body.appendChild(n.v2PopupIcon.getElement()),n.config.close_icon.use&&"image"===n.v2PopupIcon.getType()&&s.body.appendChild(n.v2PopupIcon.getCloseBtnElement());s.body.style.visibility="hidden",o.addEventListener(h,"load",(function(){s.body.style.visibility="",n.config.site_in||n.mobileFlag||"default"!==n.v2PopupIcon.getType()||n.flag.open||(I.height=n.v2PopupIcon.getHeaderBottomHeight()+64+"px")})),n.languageHeader&&n.languageHeader.resize(),"mousewheel"in document.body||"onmousewheel"in document.body?o.addEventListener(document.body,"mousewheel",(function(e){n.scrollEvent(e)})):"DOMMouseScroll"in document.body?o.addEventListener(document.body,"DOMMouseScroll",(function(e){n.scrollEvent(e)})):"onwheel"in document.body&&o.addEventListener(document.body,"wheel",(function(e){n.scrollEvent(e)})),o.addEventListener(n.elementChatLog,"scroll",(function(e){p||(p=setTimeout((function(){p=0,n.chatLogScrollEvent(n.elementChatLog)}),500))})),"onpagehide"in window&&o.addEventListener(window,"pagehide",(function(e){n.stash.operator.ws&&n.closeUserWs()})),"onbeforeunload"in window&&o.addEventListener(window,"beforeunload",(function(e){n.stash.operator.ws&&n.closeUserWs()})),o.addEventListener(document,"visibilitychange",(function(){var e=document.visibilityState;n.stash.operator.ws&&"visible"===e&&(n.stash.operator.lastVisibleTime=Date.now(),1!==n.stash.operator.ws.readyState&&n.reconnectOperator())}));var _=n.setCssStyle.bind(n);if(n.mobileFlag){var f=document.createElement("meta");f.setAttribute("name","viewport"),f.setAttribute("content","width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"),s.getElementsByTagName("head").item(0).appendChild(f)}if(n.config.site_in&&!n.mobileFlag&&(450<=i.width&&i.width<600?o.addClass(n.elementChatLog,"portrait-md"):i.width<450&&o.addClass(n.elementChatLog,"portrait-sm")),!n.config.site_in&&n.mobileFlag&&(o.addClass(i,"mobile-layout"),0==n.config.widget_button_size&&(n.config.widget_button_size=parseInt(.16*n.windowSize.width)),i.style.width=n.config.widget_button_size+"px",i.style.height=n.config.widget_button_size+"px",_("#_ul-widget-btn","line-height: "+n.config.widget_button_size+"px; font-size: "+n.config.widget_button_size+"px;"),_("#_ul-widget-btn i","line-height: "+n.config.widget_button_size+"px;")),n.config.site_in)e.chat_bg_color&&n.isColor(e.chat_bg_color)&&(n.elementChatLog.style.background=e.chat_bg_color);else{var y=s.getElementById("_ul-widget"),v=s.getElementById("_ul-chat-widget");e.widget_bg_color&&n.isColor(e.widget_bg_color)&&(y.style.background=e.widget_bg_color),e.chat_bg_color&&n.isColor(e.chat_bg_color)&&(v.style.background=e.chat_bg_color)}n.config.chat_bg_img_url&&(_("#_ul-chat-widget-chat-log",'background-image: url("'+n.config.chat_bg_img_url+'") !important'),_("#_ul-chat-widget-chat-log","background-repeat: repeat !important")),e.send_bg_color&&n.isColor(e.send_bg_color)&&(n.config.submit_bg_color=e.send_bg_color);var b="",x=n.config.no_viewport?n.config.no_viewport_scale:1;if(n.config.site_in?n.mobileFlag?"sp_in_font_size"in e&&n.isFontSize(e.sp_in_font_size)&&(b=parseInt(e.sp_in_font_size)*x+"px"):"pc_in_font_size"in e&&n.isFontSize(e.pc_in_font_size)&&(b=parseInt(e.pc_in_font_size)*x+"px"):n.mobileFlag?"sp_font_size"in e&&n.isFontSize(e.sp_font_size)&&(b=parseInt(e.sp_font_size)*x+"px"):"pc_font_size"in e&&n.isFontSize(e.pc_font_size)&&(b=parseInt(e.pc_font_size)*x+"px"),b&&(_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-log","font-size: "+b),_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-log table","font-size: "+b)),"chat_font_family"in e&&n.isFontFamily(e.chat_font_family))_("body #_ul-widget","font-family: "+e.chat_font_family),_("button, input, select, textarea","font-family:"+e.chat_font_family);else{var w=e.chat_font_family_win||"meiryo",C=e.chat_font_family_mac||"HiraginoKakuGothicProN",k=n.createFontFamilySetting(w,C);_("body #_ul-widget","font-family:"+k),_("button, input, select, textarea","font-family:"+k)}if(e.chat_bot_bg_color&&n.isColor(e.chat_bot_bg_color)&&(_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot:before","border-color: transparent "+e.chat_bot_bg_color+" transparent transparent;"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-bot:before","border-color: transparent "+e.chat_bot_bg_color+" transparent transparent;")),e.chat_user_bg_color&&n.isColor(e.chat_user_bg_color)&&(_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-user:before","border-color: transparent transparent transparent "+e.chat_user_bg_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-user:before","border-color: transparent transparent transparent "+e.chat_user_bg_color+";")),e.chat_list_bg_color&&n.isColor(e.chat_list_bg_color)&&_(".chat-log > ul li","background: "+e.chat_list_bg_color+" !important"),e.chat_list_hover_bg_color&&n.isColor(e.chat_list_hover_bg_color)&&_(".chat-log > ul li:hover","background: "+e.chat_list_hover_bg_color+" !important"),e.chat_list_active_bg_color&&n.isColor(e.chat_list_active_bg_color)&&_(".chat-log > ul li:active","background: "+e.chat_list_active_bg_color+" !important"),e.chat_list_checkbox_text_color&&n.isColor(e.chat_list_checkbox_text_color)&&_(".chat-log > ul li .check-box","color: "+e.chat_list_checkbox_text_color+" !important"),e.chat_list_text_color&&n.isColor(e.chat_list_text_color)&&_(".chat-log > ul li .text","color: "+e.chat_list_text_color+" !important"),e.endcheck_hr_color&&n.isColor(e.endcheck_hr_color)&&(_("#_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot hr","border-top: 1px solid "+e.endcheck_hr_color+";"),_("#_ul-chat-widget-chat-log .chat-bot hr","border-top: 1px solid "+e.endcheck_hr_color+";")),e.endcheck_no_btn_bg_color&&n.isColor(e.endcheck_no_btn_bg_color)&&_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li","background: "+e.endcheck_no_btn_bg_color+";"),e.endcheck_no_btn_hover_bg_color&&n.isColor(e.endcheck_no_btn_hover_bg_color)&&_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li:hover","background: "+e.endcheck_no_btn_hover_bg_color+";"),e.endcheck_no_btn_active_bg_color&&n.isColor(e.endcheck_no_btn_active_bg_color)&&_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li:active","background: "+e.endcheck_no_btn_active_bg_color+";"),e.endcheck_yes_btn_bg_color&&n.isColor(e.endcheck_yes_btn_bg_color)&&_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li.success","background: "+e.endcheck_yes_btn_bg_color+";"),e.endcheck_yes_btn_hover_bg_color&&n.isColor(e.endcheck_yes_btn_hover_bg_color)&&_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li.success:hover","background: "+e.endcheck_yes_btn_hover_bg_color+";"),e.endcheck_yes_btn_text_color&&n.isColor(e.endcheck_yes_btn_text_color)&&_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li.success span.text","color: "+e.endcheck_yes_btn_text_color),e.endcheck_no_btn_text_color&&n.isColor(e.endcheck_no_btn_text_color)&&_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li span.text","color: "+e.endcheck_no_btn_text_color),e.endcheck_yes_btn_active_bg_color&&n.isColor(e.endcheck_yes_btn_active_bg_color)&&_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li.success:active","background: "+e.endcheck_yes_btn_active_bg_color+";"),"bot_icon_border_color"in e&&n.isColor(e.bot_icon_border_color)&&_("#_ul-widget #_ul-chat-widget-chat-log ._ul-chat-chip > img","border-color: "+e.bot_icon_border_color),"bot_icon_border_width"in e&&n.isSize(e.bot_icon_border_width)&&_("#_ul-widget #_ul-chat-widget-chat-log ._ul-chat-chip > img","border-width: "+e.bot_icon_border_width),"chat_list_underline"in e&&n.isFalse(e.chat_list_underline)&&(_("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li span.text","text-decoration: none !important;"),_("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li span.text","text-decoration: none !important;"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-bot .end-question ul li span.text","text-decoration: none !important;")),"chat_list_border_radius"in e&&n.isSize(e.chat_list_border_radius)&&(_("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li","border-radius: "+e.chat_list_border_radius+";"),_("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li","border-radius: "+e.chat_list_border_radius+";"),_("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li div","border-radius: "+e.chat_list_border_radius+" "+e.chat_list_border_radius+" 0 0;")),"chat_list_border_color"in e&&n.isColor(e.chat_list_border_color)&&(_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li","border-color: "+e.chat_list_border_color+";"),_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li","border-color: "+e.chat_list_border_color+";"),_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li div","border-color: "+e.chat_list_border_color+";")),"chat_list_border_width"in e&&n.isSize(e.chat_list_border_width)&&(_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li","border-width: "+e.chat_list_border_width+";"),_("#_ul-widget #_ul-chat-widget #_ul-chat-widget-chat-log ul.chat-log-group-carousel li","border-width: "+e.chat_list_border_width+";")),"chat_list_padding"in e&&n.isSize(e.chat_list_padding)&&_("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li","padding: "+e.chat_list_padding+" !important;"),"chat_list_icon_color"in e&&n.isColor(e.chat_list_icon_color)&&_("#_ul-widget #_ul-chat-widget-chat-log ul.chat-log-group-list li span.list-layout-before","border-color: transparent transparent transparent "+e.chat_list_icon_color+" !important;"),"form_bg_color"in e&&n.isColor(e.form_bg_color)&&_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form","background: "+e.form_bg_color+";"),"form_q_text_color"in e&&n.isColor(e.form_q_text_color)&&(_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form label","color: "+e.form_q_text_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form .file-upload-size-note","color: "+e.form_q_text_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form .file-upload-size-note","opacity: 0.7;")),"form_a_bg_color"in e&&n.isColor(e.form_a_bg_color)&&(_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input","background: "+e.form_a_bg_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form textarea","background: "+e.form_a_bg_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form select","background: "+e.form_a_bg_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form .file-upload-button","background: "+e.form_a_bg_color+";")),"form_a_text_color"in e&&n.isColor(e.form_a_text_color)&&(_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input","color: "+e.form_a_text_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form textarea","color: "+e.form_a_text_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form select","color: "+e.form_a_text_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form .file-upload-button svg","fill: "+e.form_a_text_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form .file-upload-button span","color: "+e.form_a_text_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form svg.calendar-icon","fill: "+e.form_a_text_color+";")),"form_a_placeholder_color"in e&&n.isColor(e.form_a_placeholder_color)&&(_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input::placeholder","color: "+e.form_a_placeholder_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input:-ms-input-placeholder","color: "+e.form_a_placeholder_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input::-ms-input-placeholder","color: "+e.form_a_placeholder_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form textarea::placeholder","color: "+e.form_a_placeholder_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form textarea:-ms-input-placeholder","color: "+e.form_a_placeholder_color+";"),_("#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form textarea::-ms-input-placeholder","color: "+e.form_a_placeholder_color+";")),"form_send_bg_color"in e&&n.isColor(e.form_send_bg_color)&&_('#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input[type="submit"]',"background: "+e.form_send_bg_color+"!important;"),"form_send_text_color"in e&&n.isColor(e.form_send_text_color)&&_('#_ul-widget #_ul-chat-widget-chat-log .chat-log form.designed-form input[type="submit"]',"color: "+e.form_send_text_color+"!important;"),n.setChatlogBalloonWidth(),!n.config.site_in){var I=n.elementIframe.style;I.setProperty("margin","0"),I.setProperty("max-width","100%"),I.position="fixed";var B=s.getElementById("_ul-chat-widget");if(B.style.width="100%",B.style.height="calc(100% - "+n.v2Header.getHeaderTopHeight()+"px)",n.mobileFlag){n.styleHideBottom=parseInt(n.config.popup.space.sp.height);var E=o.Browser;if(o.Os.Android&&E.DefaultBrowser&&(n.styleHideBottom+=40),I.right=n.config.popup.space.sp.width,"left"==n.config.position&&(I.right="",I.left=n.config.popup.space.sp.width),I.bottom=n.styleHideBottom+"px",n.isCustomSizePopupIcon()&&(I.width=parseInt(n.config.popup.icon.sp.width)+"px",I.height=parseInt(n.config.popup.icon.sp.height)+"px",n.stash.imgPopupSp.width=parseInt(n.config.popup.icon.sp.width),n.stash.imgPopupSp.height=parseInt(n.config.popup.icon.sp.height)),n.config.close_icon.use){var S=s.getElementById("_ul-widget-btn"),T=s.getElementById("closeBtn");T.style.setProperty("position","absolute"),T.style.setProperty("top","0");var L=n.getRect(S),P=4;n.config.popup.icon_url&&(P=16),I.width=L.width+P+"px",I.height=L.height+P+"px",n.stash.imgPopupSp.width=L.width,n.stash.imgPopupSp.height=L.height,S.style.setProperty("position","absolute"),S.style.setProperty("height",L.height+"px"),S.style.setProperty("width",L.width+"px"),S.style.setProperty("bottom","0"),o.Os.iOs&&_("#closeBtn > p","line-height: 90%;");var A=28;n.config.popup.icon_url&&(A=L.height/2),T.style.setProperty("bottom",parseInt(I.height)-A+"px")}o.addClass(i,"ul-widget-hide")}else{I.right=parseInt(n.config.popup.space.pc.width)+"px","left"==n.config.position&&(I.right="",I.left=parseInt(n.config.popup.space.pc.width)+"px"),I.cursor="pointer",I.width=n.config.out.width,I.height="105px",I.bottom=parseInt(n.config.popup.space.pc.height)+"px",I.boxShadow="0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.3)";var F=s.getElementById("_ul-widget");F.style.height=s.body.style.height=I.height,F.style.width=s.body.style.width=I.width,n.v2ResizeChatLogHeight(),i.style.setProperty("border-radius",n.config.popup.pc_header_border_radius+"px"),n.styleHideBottom=105+parseInt(n.config.popup.space.pc.height)-parseInt(I.height),n.config.default_open?(I.bottom=parseInt(n.styleHideBottom)+"px",o.addClass(i,"ul-widget-hide"),n.flag.first_open=!1,n.popupOpen()):(s.getElementById("_ul-widget").style.setProperty("display","none"),o.addClass(i,"ul-widget-hide"),"image"===n.v2PopupIcon.getType()?(n.elementIframe.style.boxShadow="none",n.elementIframe.style.setProperty("border-radius","0 0 0 0")):I.bottom=parseInt(n.styleHideBottom)+"px"),setTimeout((function(){n.config.popup.pc_open_animation&&(I.transition="0.5s")}),50)}I.zIndex=n.config.z_index}if(n.config.site_in&&(r.style.height="100%",n.v2ResizeChatLogHeight()),n.isTranslateEnabled()){var M=["ja"].concat(Object.keys(n.config.translated));n.config.translate_target_lang&&-1!==M.indexOf(n.config.translate_target_lang)?(n.setTranslateLang(),n.initTalk(n.elementChatLog)):n.addLangSelectFirstChat()}else n.config.translate_target_lang=null,n.initTalk(n.elementChatLog);if(n.flag.completed_pre_chat=!(!t&&!n.config.testMode.use),!n.config.pre_chat.use&&!n.config.pre_chat.custom_flag||n.flag.completed_pre_chat||n.flag.maintenance||n.addPreChat(),n.config.display_cookie_consent&&!n.flag.used_cookie&&!n.config.no_cookie&&(!n.config.pre_chat.use||n.flag.completed_pre_chat||n.flag.maintenance)){n.cookieBanner=new n.CookieBanner({bannerText:n.text.cookie_banner,backgroundColor:n.config.chat_bg_color,siteIn:n.config.site_in,onHidden:function(){n.elementChatLog.style.paddingBottom=""}});var O=n.elementChatLog;O.parentNode.insertBefore(n.cookieBanner.getElement(),O.nextSibling),O.style.paddingBottom="50px"}var H=s.getElementById("v2InputBoxRestartBtn");H&&n.appendElementTooltip(H,n.text.tooltip_restart_button,"top","tooltipRestartButton");var z,R=new n.BackToBottomBtn({buttonText:n.text.back_to_bottom,clickEvent:function(){o.Os.iOs&&(n.elementChatLog.style.overflowY="hidden",setTimeout((function(){n.elementChatLog.style.overflowY="auto"}),10)),n.elementChatLog.scrollTop=n.elementChatLog.scrollHeight,this.hide()}});n.backToBottomBtn=R,r.appendChild(R.getElement()),n.config.site_in||!n.config.popup.open_delay_flag||n.mobileFlag||setTimeout((function(){n.flag.open||n.flag.check_close||n.popupOpen()}),n.config.popup.open_delay_time),n.config.site_in&&o.addEventListener(window,"resize",(function(){z||(z=setTimeout((function(){z=0,n.resizeInlineWidget()}),500))})),n.mobileFlag&&!n.config.site_in&&o.addEventListener(window,"resize",(function(){n.v2ResizeSpWidget()})),n.config.sharepoint&&!n.config.site_in&&setInterval((function(){n.url!=location.href&&n.hideChatWidget()}),100),n.execCustomEvent("initialized"),setTimeout((function(){n.quickSearchMenu&&n.quickSearchMenu.controlSlideBtn(),n.runPushAfterEvent(),o.Browser.IE&&n.v2ResizeChatLogHeight()}),100)}),i)}}},o.prototype.v2OpenPcWidget=function(e){var t=(e=e||{}).scrollCall||!1,n=this,i=n.elementIframe.contentWindow.document,s=i.getElementById("_ul-widget"),a=i.getElementById("v2InputBoxSend");5!==n.config.gpt_doc_mode||o.Browser.IE||n.flag.maintenance||(a=i.getElementById("v2OperatorInputBoxSend"));var r=i.getElementById("_ul-chat-widget"),l=n.elementChatLog;if(n.flag.check_open=!0,n.config.scroll_open=!1,o.hasClass(s,"notification")&&o.removeClass(s,"notification"),o.toggleClass(n.elementIframe,"ul-widget-hide"),o.hasClass(n.elementIframe,"ul-widget-hide")){n.flag.open=!1,n.elementIframe.style.transition="",(n.config.close_icon.use||n.config.popup.icon.pc.balloon.status)&&n.config.popup.pc_icon_url&&!n.flag.check_close&&n.config.default_open&&n.v2PopupIcon.setPopupIconPosition(),o.hasClass(l,"hidden")||o.addClass(l,"hidden"),o.hasClass(r,"hidden")||o.addClass(r,"hidden"),t||(n.flag.check_close=!0),n.v2PopupIcon&&(n.v2PopupIcon.show(),"image"===n.v2PopupIcon.getType()&&(n.v2PopupIcon.initImgPopupPcSize(),n.v2PopupIcon.setPopupIconPosition()));var c=i.getElementById("tooltipRestartButton"),d=i.getElementById("tooltipMinimizeButton"),u=i.getElementById("tooltipFullScreenButton");c&&n.removeMe(c),d&&n.removeMe(d),u&&n.removeMe(u),(w=i.getElementById("preChat"))&&(w.style.display="none",w.style.height="0px"),n.menu&&n.menu.hide(),n.languageMenu&&n.languageMenu.hide(),n.execCustomEvent("popup_close")}else{if(n.flag.open=!0,!n.isMenuEnabled()){if(n.isTranslateEnabled()){var p=n.v2Header.getTranslateBtn();n.appendElementTooltip(p,"Language","bottom","tooltipChangeTranslationButton")}if(n.config.reload_btn){var h=n.v2Header.getReloadBtn();n.appendElementTooltip(h,n.text.tooltip_restart_button,"bottom","tooltipRestartButton")}}if(!o.Browser.IE){var g=n.v2Header.getFullScreenBtn();n.appendElementTooltip(g,n.text.tooltip_fullscreen_button,"bottom","tooltipFullScreenButton")}var m=n.v2Header.getCloseBtn();n.appendElementTooltip(m,n.text.tooltip_close_button,"bottom","tooltipMinimizeButton"),o.hasClass(l,"hidden")&&o.removeClass(l,"hidden"),r.style.marginLeft="0",o.removeClass(r,"hidden"),n.config.display_input_box&&(a.focus(),n.stash.operator.active&&n.postReadStatusUpdate(n.stash.operator.channelId,n.stash.operator.botId));var _=parseInt(n.config.popup.pc_header_border_radius);n.elementIframe.style.setProperty("border-radius",_+"px"),s.style.height=n.config.out.height,i.body.style.height=n.config.out.height,n.elementIframe.style.height=n.config.out.height;var f=n.config.popup.pc_widget_space_custom?parseInt(n.config.popup.pc_widget_space.width)+"px":parseInt(n.config.popup.space.pc.width)+"px";n.elementIframe.style.right=f,"left"==n.config.position&&(n.elementIframe.style.right="",n.elementIframe.style.left=f),n.elementIframe.style.bottom=n.config.popup.pc_widget_space_custom?parseInt(n.config.popup.pc_widget_space.height)+"px":parseInt(n.config.popup.space.pc.height)+"px",n.elementIframe.style.boxShadow="0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.3)",n.v2PopupIcon&&n.v2PopupIcon.hidden();var y=l.scrollTop;if(n.flag.first_open){var v=0;if(n.config.operator_mode||5===n.config.gpt_doc_mode||(""!==n.params.first_talk&&void 0!==n.params.first_talk&&n.AnalyticsTagCommon.isArray(n.params.first_list)&&n.params.first_list.length>0&&v++,n.config.backlog.view&&"xmlHttp"===n.createHttpRequest()[1]&&v++),"first_list_display_type"in n.params&&"carousel"===n.params.first_list_display_type){var b=l.childNodes[l.childNodes.length-1];if(b){var x=b.querySelector("a.carousel_arrow");x&&n.getScrollLeft(b.lastElementChild)>0&&(x.style.display="block")}}n.scrollAuto(l,y,n,v),n.flag.first_open=!1}var w,C=n.config.popup.pc_widget_space_custom?parseInt(n.config.popup.pc_widget_space.height)+"px":parseInt(n.config.popup.space.pc.height)+"px";n.elementIframe.style.maxHeight="calc(100% - "+C+")",i.body.style.maxHeight="100%",s.style.maxHeight="100%",n.v2ResizeChatLogHeight(),(w=i.getElementById("preChat"))&&(w.style.display="block",w.style.width=i.body.clientWidth+"px",w.style.height=i.body.clientHeight-(n.config.popup.pc_header_height-1)+"px"),this.v2PopupAnimation(),n.execCustomEvent("popup_open")}},o.prototype.v2ResizeChatLogHeight=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.elementChatLog,n=0;this.quickSearchMenu&&this.quickSearchMenu.isShown()&&(n=this.quickSearchMenu.getHeight());var i=0,o=0;if("newline"!==this.v2InputBox.getInputType())i=this.config.display_input_box&&this.v2InputBox.isInputShown()?this.v2InputBox.getHeight():0,o=this.v2InputBox.getPaddingBottom();else{var s=this.v2InputBox.getInputBoxHeight(!e);this.v2InputBox.setInputBoxHeight(s),i=e?this.v2InputBox.getOffsetHeight():this.v2InputBox.getHeight()}var a=0;this.config.site_in?a=1:this.mobileFlag&&(a=2);var r=this.languageHeader&&this.languageHeader.isShown()?this.languageHeader.getHeight():0,l=this.modalHeader&&this.modalHeader.isShown()?this.modalHeader.getHeight():0;t.style.height="calc(100% - "+(n+i+o+a+r+l)+"px)"},o.prototype.adjustSendInputHeight=function(e){if(this.v2OperatorInputBox&&!this.v2OperatorInputBox.isShown())return!1;var t=this.elementChatLog,n=this.v2OperatorInputBox.getInputBoxHeight("init"===e);this.v2OperatorInputBox.setInputBoxHeight(n);var i=0;this.flag.popup_modal&&5===this.config.gpt_doc_mode&&this.modalHeader&&this.modalHeader.isShown()&&(i=this.modalHeader.getHeight()),t.style.setProperty("height","calc(100% - "+(this.v2OperatorInputBox.getOffsetHeight()+i)+"px)"),t.scrollTop=t.scrollHeight,this.v2OperatorInputBox.scrollInputBoxBottom()},o.prototype.scrollToInputBox=function(){var e=this;o.Os.Android&&e.mobileFlag&&setTimeout((function(){(e.v2OperatorInputBox&&e.v2OperatorInputBox.isShown()?e.v2OperatorInputBox.getElement():e.v2InputBox.getElement()).scrollIntoView()}),200)},o.prototype.setAriaLive=function(e){var t=this.elementIframe.contentWindow.document.getElementById("ariaLive");t&&(t.innerText=this.Utils.extractText(e))},o.prototype.v2OpenSpWidget=function(){var e=this,t=this.elementIframe.contentWindow.document,n=t.getElementById("_ul-main-window"),i=t.getElementById("_ul-chat-widget"),s=this.elementChatLog;if(this.flag.open=!0,this.flag.check_open=!0,this.config.scroll_open=!1,this.widgetPositionY=this.elementIframe.getBoundingClientRect().top,o.removeClass(this.elementIframe,"ul-widget-hide"),o.toggleClass(n,"hidden"),o.toggleClass(t.getElementById("_ul-widget-btn"),"hidden"),this.config.close_icon.use){var a=t.getElementById("closeBtn");o.addClass(a,"hidden")}var r=100==this.config.out.sp_height_pct;this.stash.parentScroll.x=!!r&&window.scrollX,this.stash.parentScroll.y=!!r&&window.scrollY;var l=document.querySelector("body");this.parentBodyStyle=l.getAttribute("style"),this.v2ResizeSpWidget(),o.removeClass(s,"hidden"),o.removeClass(i,"hidden");var c=s.scrollTop;if(this.flag.first_open){this.flag.first_open=!1;var d=0;if(""!==this.params.first_talk&&void 0!==this.params.first_talk&&this.AnalyticsTagCommon.isArray(this.params.first_list)&&this.params.first_list.length>0&&d++,this.config.backlog.view&&"xmlHttp"===this.createHttpRequest()[1]&&d++,!(this.config.remove_space&&d>0)&&""!==this.params.first_talk){var u=s.getElementsByClassName("initWhiteSpace")[0];(u=s.firstChild)&&(u.style.height=this.getRect(s).height+"px")}if("first_list_display_type"in e.params&&"carousel"===e.params.first_list_display_type){var p=s.childNodes[s.childNodes.length-1];if(p){var h=p.querySelector("a.carousel_arrow");h&&e.getScrollLeft(p.lastElementChild)>0&&(h.style.display="block")}}0===d?this.scrollAuto(s,c,this):this.scrollAuto(s,s.scrollTop,this,d)}navigator.userAgent.indexOf("GSA")>0&&setTimeout((function(){e.v2ResizeSpWidget()}),200),this.v2PopupAnimation(),this.execCustomEvent("popup_open")},o.prototype.v2CloseSpWidget=function(){if(!this.stash.operator.ws){var e=this.elementIframe,t=e.contentWindow.document,n=t.getElementById("_ul-main-window");if(o.addClass(this.elementIframe,"ul-widget-hide"),o.toggleClass(n,"hidden"),o.toggleClass(t.getElementById("_ul-widget-btn"),"hidden"),this.flag.open=!1,this.config.close_icon.use){var i=t.getElementById("closeBtn");o.hasClass(i,"hidden")&&o.removeClass(i,"hidden")}var s=e.style;if(s.position="fixed",s.bottom=this.styleHideBottom+"px",s.left="",s.right="",s.backgroundColor="",this.mobileFlag?s.right=this.config.popup.space.sp.width:s.right=this.config.popup.space.pc.width,s.boxShadow="","left"==this.config.position&&(s.right="",this.mobileFlag?s.left=this.config.popup.space.sp.width:s.left=this.config.popup.space.pc.width),s.width=this.config.widget_button_size+"px",s.height=this.config.widget_button_size+"px",this.stash.imgPopupSp.width>0&&(s.width=this.stash.imgPopupSp.width+"px"),this.config.popup.sp_wait_image_origin_size&&this.stash.imgPopupSp.height>0&&(s.height=this.stash.imgPopupSp.height+"px"),this.isCustomSizePopupIcon()&&(s.width=this.stash.imgPopupSp.width+"px",s.height=this.stash.imgPopupSp.height+"px"),this.config.close_icon.use){var a=4;this.config.popup.icon_url&&(a=16);var r=this.stash.imgPopupSp.width>0?this.stash.imgPopupSp.width+a:68;s.width=r+"px";var l=this.stash.imgPopupSp.height>0?this.stash.imgPopupSp.height+a:68;s.height=l+"px"}return s.minHeight="",s.maxHeight="",this.elementIframe.style.transition="",(this.mobileFlag||this.config.mobilePreview)&&(s.top="",document.querySelector("body").setAttribute("style",this.parentBodyStyle),this.parentBodyStyle=!1,!1!==this.stash.parentScroll.x&&!1!==this.stash.parentScroll.y&&window.scrollTo(this.stash.parentScroll.x,this.stash.parentScroll.y)),this.menu&&this.menu.hide(),this.languageMenu&&this.languageMenu.hide(),this.execCustomEvent("popup_close"),!1}this.showExitOperatorModeModal()},o.prototype.v2PopupAnimation=function(){var e=this,t=e.elementIframe.contentWindow.document.getElementById("_ul-widget"),n=100==e.config.out.sp_height_pct,i=document.querySelector("body");e.elementIframe.style.opacity="0",e.elementIframe.style.transition="",o.Os.iOs&&e.mobileFlag&&n&&(i.style.width=i.clientWidth+"px",i.style.height=i.clientHeight+"px",i.style.position="fixed",i.style.top=-e.stash.parentScroll.y+"px",i.style.left=-e.stash.parentScroll.x+"px"),setTimeout((function(){e.elementIframe.style.transition="0.25s ease-in-out",e.elementIframe.style.opacity="1",o.addClass(t,"animation-open"),e.mobileFlag&&n&&setTimeout((function(){i.setAttribute("style","display: block; position: fixed; overflow-y: hidden; -webkit-text-size-adjust: 100%; margin: 0px;")}),250)}),50)},o.prototype.v2ResizeSpWidget=function(){if(this.flag.open&&!this.v2InputBox.getSendInputFocusFlag()&&!this.v2OperatorInputBox.getSendInputFocusFlag()&&!this.flag.popup_modal_opened){var e=this.elementIframe.contentWindow.document,t=e.getElementById("_ul-main-window"),n=e.getElementById("_ul-widget");this.elementIframe.style.position="fixed",this.elementIframe.style.left=0,this.elementIframe.style.bottom=0,this.elementIframe.style.width="100%",this.elementIframe.style.height=this.config.out.sp_height_pct+"%",this.elementIframe.style.boxShadow="rgba(0, 0, 0, 0.12) 0px 1px 10px 0px, rgba(0, 0, 0, 0.3) 0px 1px 4px -1px",e.scrolling="",n.style.width="100%",n.style.height="100%",t.style.width="100%",t.style.height="100%",this.v2ResizeChatLogHeight(),this.v2OperatorInputBox.isShown()&&this.adjustSendInputHeight("init");var i=e.getElementById("preChat");i&&(i.style.display="block",i.style.width="100%",i.style.height="calc(100% - "+this.v2Header.getHeaderTopHeight()+"px)",i.style.top=this.v2Header.getHeaderTopHeight()+"px")}},o.prototype.v2SwitchFullScreenPcWidget=function(e){var t=this,n=this.elementIframe.contentWindow.document,i=n.getElementById("_ul-widget");e?(this.v2Header.setFullScreenBtnIcon(!0),this.v2Header.removeEventDraggable(),this.stash.popupFullScreen.iframeStyle=this.elementIframe.getAttribute("style"),this.stash.popupFullScreen.documentBodyStyle=n.body.getAttribute("style"),this.stash.popupFullScreen.ulWidgetStyle=i.getAttribute("style"),this.elementIframe.style.position="fixed",this.elementIframe.style.left=0,this.elementIframe.style.top=0,this.elementIframe.style.width="100%",this.elementIframe.style.borderRadius="",this.elementIframe.style.height="100%",this.elementIframe.style.maxHeight="",n.body.style="",n.scrolling="",i.style.width="100%",i.style.height="100%",this.v2Header.setFullScreenFlag(!0)):(this.v2Header.setFullScreenBtnIcon(!1),this.v2Header.addEventDraggable(),this.elementIframe.style=this.stash.popupFullScreen.iframeStyle,n.body.style=this.stash.popupFullScreen.documentBodyStyle,i.style=this.stash.popupFullScreen.ulWidgetStyle,this.elementIframe.style.transition="",setTimeout((function(){t.elementIframe.style.transition="0.25s ease-in-out"}),500),this.v2Header.setFullScreenFlag(!1)),this.v2ResizeChatLogHeight(),this.v2OperatorInputBox.isShown()&&this.adjustSendInputHeight("init")},o.prototype.v2ResizePopupFullScreen=function(){600<window.innerWidth?o.addClass(this.elementChatLog,"portrait-lg"):o.removeClass(this.elementChatLog,"portrait-lg")},o.prototype.Suggest={},o.prototype.Suggest.Key={TAB:9,RETURN:13,ESC:27,UP:38,DOWN:40},o.prototype.Suggest.extend=n(110).X,o.prototype.Suggest.Local=function(){this.initialize.apply(this,arguments)},o.prototype.Suggest.Local.prototype={initialize:function(e,t,i,s,a,r){this.document=document,r&&(this.document=r),this.input=this._getElement(e),this.suggestArea=this._getElement(t),this.candidateList=s,this.chatLogArea=i,this.oldText=this.getInputText(),this.textEncoder=n(445),a&&this.setOptions(a),this.candidateList&&this.candidateList.length<3e3&&o.addEventListener(this.input,"input",this._bind(this.checkLoop)),o.addEventListener(this.input,"focus",this._bind(this.checkLoop)),o.addEventListener(this.input,"blur",this._bind(this.inputBlur)),o.addEventListener(this.suggestArea,"blur",this._bind(this.inputBlur)),o.addEventListener(this.input,"keydown",this._bindEvent(this.keyEvent)),this.clearSuggestArea()},interval:500,displayMax:20,listTagName:"div",listInTagName:"span",prefix:!1,ignoreCase:!0,highlight:!1,dispAllKey:!1,classMouseOver:"over",classSelect:"select",mobileFlag:!1,display:!0,recommendFunnelFlag:!1,selectedCid:null,hookBeforeSearch:function(){},setOptions:function(e){o.prototype.Suggest.extend(this,e)},inputBlur:function(){setTimeout(this._bind((function(){document.activeElement!=this.suggestArea&&document.activeElement!=this.input&&(this.changeUnactive(),this.oldText=this.getInputText(),this.timerId&&clearTimeout(this.timerId),this.timerId=null,setTimeout(this._bind(this.clearSuggestArea),500))}),500))},checkLoop:function(){var e=this.getInputText();e!=this.oldText&&(this.oldText=e,this.search()),this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(this._bind(this.checkLoop),this.interval)},search:function(){if(this.display){this.clearSuggestArea();var e=this.getInputText();if(""==e||null==e)return;this.hookBeforeSearch(e);var t=this._search(e);0!=t.length&&this.createSuggestArea(t)}},_search:function(e){var t=this,n=[],i=this._splitText(e);if(this.suggestIndexList=[],0==i.length)return[];for(var o=0,s=this.candidateList.length;o<s;o++)if(!this.recommendFunnelFlag||!this.selectedCid||this.isBelowScenario(this.candidateList[o])){var a=this.isMatch(this.candidateList[o].text,i[0]);null!=a&&(n.push(a),this.suggestIndexList.push(o)),null!=(a=this.isSynonymMatch(this.candidateList[o],i[0]))&&-1==n.indexOf(a)&&(n.push(a),this.suggestIndexList.push(o))}for(o=1;o<i.length;o++){var r=[];n=n.filter((function(e,n){var s=t.suggestIndexList[n];return!(!t.isMatch(e,i[o])&&!t.isSynonymMatch(t.candidateList[s],i[o])&&(r.push(s),1))})),t.suggestIndexList=t.suggestIndexList.filter((function(e){return-1==r.indexOf(e)}))}return this.displayMax>0&&(this.suggestIndexList=this.suggestIndexList.slice(0,this.displayMax),n=n.slice(0,this.displayMax)),n},isMatch:function(e,t){if(null==e)return null;var n=this._katakanaToHiragana(this._hankakuToZenkaku(e));t=this._katakanaToHiragana(this._hankakuToZenkaku(t));var i=this.ignoreCase?n.toLowerCase().indexOf(t.toLowerCase()):n.indexOf(t);return-1==i||this.prefix&&0!=i?null:this.highlight?this._escapeHTML(e.substr(0,i))+"<strong>"+this._escapeHTML(e.substr(i,t.length))+"</strong>"+this._escapeHTML(e.substr(i+t.length)):this._escapeHTML(e)},isSynonymMatch:function(e,t){if(null==e.synonym||null==e.text)return null;for(var n=0;n<e.synonym.length;n++){var i=this._katakanaToHiragana(this._hankakuToZenkaku(e.synonym[n]));if(t=this._katakanaToHiragana(this._hankakuToZenkaku(t)),-1!=(this.ignoreCase?i.toLowerCase().indexOf(t.toLowerCase()):i.indexOf(t)))return this._escapeHTML(e.text)}},isBelowScenario:function(e){var t=e.cid||"",n=this.selectedCid+"_";return t.substring(0,n.length)===n&&t.split("_").length>n.split("_").length},clearSuggestArea:function(){this.suggestArea.innerHTML="",this.suggestArea.style.display="none",this.suggestList=null,this.suggestIndexList=null,this.activePosition=null},createSuggestArea:function(e){var t=this;this.suggestList=[],this.inputValueBackup=this.input.value;for(var n=e.length-1;n>=0;n--){var i,o=document.createElement(this.listTagName),s=document.createElement(this.listInTagName),a=t.textEncoder.prototype.unescapeHTML(e[n]),r=t.textEncoder.prototype.convertToSelectionText(a),l=[],c=[];this._splitText(this.input.value).forEach((function(e){l.push(e),l.push(t._katakanaToHiragana(e)),l.push(t._hiraganaToKatakana(e)),l.push(t._hankakuToZenkaku(e)),l.push(t._katakanaToHiragana(t._hankakuToZenkaku(e))),l.push(t._zenkakuToHankaku(t._hiraganaToKatakana(e)))})),l=l.map((function(e){return t._escapeRegExp(e)})),i=r.replace(/<span(.*?)>(.*?)<\/span>/g,(function(e,t,n){return c.push(t),"{{$$"+n+"}}"})).replace(/<br>/g,(function(){return"{{$}}"})).replace(new RegExp(l.join("|"),"gi"),(function(e){return"<strong>"+e+"</strong>"})).replace(/\{\{\$\$(.*?)\}\}/g,(function(e,t){return"<span "+c.shift()+">"+t+"</span>"})).replace(/\{\{\$\}\}/g,(function(){return"<br>"})),s.innerHTML=i,o.appendChild(s),this.suggestArea.appendChild(o),o.addEventListener("click",this._bindEvent(this.listClick,n)),this.suggestList.push(o)}var d=this.chatLogArea;this.suggestArea.style.maxHeight=d.clientHeight-2+"px",this.suggestArea.style.display="block",this.suggestArea.scrollTop=this.suggestArea.scrollHeight},getInputText:function(){return this.input.value},setInputText:function(e){this.input.value=this._removeTag(e)},keyEvent:function(e){this.timerId||(this.timerId=setTimeout(this._bind(this.checkLoop),this.interval)),this.dispAllKey&&e.ctrlKey&&""==this.getInputText()&&!this.suggestList&&e.keyCode==o.prototype.Suggest.Key.DOWN?(this._stopEvent(e),this.keyEventDispAll()):e.keyCode==o.prototype.Suggest.Key.UP||e.keyCode==o.prototype.Suggest.Key.DOWN?this.suggestList&&0!=this.suggestList.length&&(this._stopEvent(e),this.keyEventMove(e.keyCode)):e.keyCode==o.prototype.Suggest.Key.RETURN&!e.shiftKey?this.suggestList&&0!=this.suggestList.length&&(this._stopEvent(e),this.keyEventReturn()):e.keyCode==o.prototype.Suggest.Key.ESC?this.suggestList&&0!=this.suggestList.length&&(this._stopEvent(e),this.keyEventEsc()):this.keyEventOther(e)},keyEventDispAll:function(){this.clearSuggestArea(),this.oldText=this.getInputText(),this.suggestIndexList=[];for(var e=0,t=this.candidateList.length;e<t;e++)this.suggestIndexList.push(e);this.createSuggestArea(this.candidateList)},keyEventMove:function(e){if(this.changeUnactive(),e==o.prototype.Suggest.Key.UP){if(null==this.activePosition)this.activePosition=this.suggestList.length-1;else if(this.activePosition--,this.activePosition<0)return this.activePosition=null,this.input.value=this.inputValueBackup,void(this.suggestArea.scrollTop=0)}else if(null==this.activePosition?this.activePosition=0:this.activePosition++,this.activePosition>=this.suggestList.length)return this.activePosition=null,this.input.value=this.inputValueBackup,void(this.suggestArea.scrollTop=0);this.changeActive(this.activePosition)},keyEventReturn:function(){if(null!==this.activePosition){var e=this.parent,t=this.chatLogArea,n=this.candidateList[this.suggestIndexList[this.suggestList.length-1-this.activePosition]],i=n.text||"",o={replySid:n.id};setTimeout((function(){t.appendChild(e.sendUser(i)),e.config.chat_bot_loading||e.scrollAuto(t,t.scrollTop,e),e.addBotText(i,t,o,"knowledge")}),100),this.input.value=""}this.clearSuggestArea(),this.moveEnd()},keyEventEsc:function(){this.clearSuggestArea(),this.input.value=this.inputValueBackup,this.oldText=this.getInputText(),window.opera&&setTimeout(this._bind(this.moveEnd),5)},keyEventOther:function(e){},changeActive:function(e){this.setStyleActive(this.suggestList[e]),e=this.suggestList.length-1-e,this.setInputText(this.candidateList[this.suggestIndexList[e]].text),this.oldText=this.getInputText(),this.input.focus()},changeUnactive:function(){null!=this.suggestList&&this.suggestList.length>0&&null!=this.activePosition&&this.setStyleUnactive(this.suggestList[this.activePosition])},listClick:function(e,t){if(e.preventDefault(),this.changeUnactive(),t=this.suggestList.length-1-t,this.activePosition=t,this.changeActive(t),this.parent.config.suggestConf.autoSend){var n=this.parent,i=this.chatLogArea,o=this.candidateList[this.suggestIndexList[this.suggestList.length-1-this.activePosition]],s=o.text||"",a={replySid:o.id};setTimeout((function(){i.appendChild(n.sendUser(s)),n.config.chat_bot_loading||n.scrollAuto(i,i.scrollTop,n),n.addBotText(s,i,a,"knowledge")}),100),this.input.value=""}this.clearSuggestArea(),this.moveEnd()},listMouseOver:function(e,t){this.setStyleMouseOver(this._getEventElement(e))},listMouseOut:function(e,t){if(this.suggestList){var n=this._getEventElement(e);t==this.activePosition?this.setStyleActive(n):this.setStyleUnactive(n)}},setStyleActive:function(e){e.className=this.classSelect;var t=e.offsetTop,n=t+e.clientHeight;this.suggestArea.scrollTop>t?this.suggestArea.scrollTop=t:this.suggestArea.scrollTop+this.suggestArea.clientHeight<n&&(this.suggestArea.scrollTop=n-this.suggestArea.clientHeight)},setStyleUnactive:function(e){e.className=""},setStyleMouseOver:function(e){e.className=this.classMouseOver},moveEnd:function(){if(this.input.createTextRange){this.input.focus();var e=this.input.createTextRange();e.move("character",this.input.value.length),e.select()}else this.input.setSelectionRange&&this.input.setSelectionRange(this.input.value.length,this.input.value.length)},_getElement:function(e){return"string"==typeof e?this.document.getElementById(e):e},_stopEvent:function(e){e.preventDefault?e.stopPropagation():(e.returnValue=!1,e.cancelBubble=!0)},_getEventElement:function(e){return e.target||e.srcElement},_bind:function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return function(){e.apply(t,n)}},_bindEvent:function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return function(i){i=i||window.event,e.apply(t,[i].concat(n))}},_escapeHTML:function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML},_katakanaToHiragana:function(e){return e.replace(/[\u30a1-\u30f6]/g,(function(e){var t=e.charCodeAt(0)-96;return String.fromCharCode(t)}))},_hiraganaToKatakana:function(e){return e.replace(/[\u3041-\u3096]/g,(function(e){var t=e.charCodeAt(0)+96;return String.fromCharCode(t)}))},_hankakuToZenkaku:function(e){var t=e.replace(/[A-Za-z0-9]/g,(function(e){var t=e.charCodeAt(0)+65248;return String.fromCharCode(t)}));return this._hankanaToZenkana(t)},_hankanaToZenkana:function(e){var t={ｶﾞ:"ガ",ｷﾞ:"ギ",ｸﾞ:"グ",ｹﾞ:"ゲ",ｺﾞ:"ゴ",ｻﾞ:"ザ",ｼﾞ:"ジ",ｽﾞ:"ズ",ｾﾞ:"ゼ",ｿﾞ:"ゾ",ﾀﾞ:"ダ",ﾁﾞ:"ヂ",ﾂﾞ:"ヅ",ﾃﾞ:"デ",ﾄﾞ:"ド",ﾊﾞ:"バ",ﾋﾞ:"ビ",ﾌﾞ:"ブ",ﾍﾞ:"ベ",ﾎﾞ:"ボ",ﾊﾟ:"パ",ﾋﾟ:"ピ",ﾌﾟ:"プ",ﾍﾟ:"ペ",ﾎﾟ:"ポ",ｳﾞ:"ヴ",ﾜﾞ:"ヷ",ｦﾞ:"ヺ",ｱ:"ア",ｲ:"イ",ｳ:"ウ",ｴ:"エ",ｵ:"オ",ｶ:"カ",ｷ:"キ",ｸ:"ク",ｹ:"ケ",ｺ:"コ",ｻ:"サ",ｼ:"シ",ｽ:"ス",ｾ:"セ",ｿ:"ソ",ﾀ:"タ",ﾁ:"チ",ﾂ:"ツ",ﾃ:"テ",ﾄ:"ト",ﾅ:"ナ",ﾆ:"ニ",ﾇ:"ヌ",ﾈ:"ネ",ﾉ:"ノ",ﾊ:"ハ",ﾋ:"ヒ",ﾌ:"フ",ﾍ:"ヘ",ﾎ:"ホ",ﾏ:"マ",ﾐ:"ミ",ﾑ:"ム",ﾒ:"メ",ﾓ:"モ",ﾔ:"ヤ",ﾕ:"ユ",ﾖ:"ヨ",ﾗ:"ラ",ﾘ:"リ",ﾙ:"ル",ﾚ:"レ",ﾛ:"ロ",ﾜ:"ワ",ｦ:"ヲ",ﾝ:"ン",ｧ:"ァ",ｨ:"ィ",ｩ:"ゥ",ｪ:"ェ",ｫ:"ォ",ｯ:"ッ",ｬ:"ャ",ｭ:"ュ",ｮ:"ョ","｡":"。","､":"、",ｰ:"ー","｢":"「","｣":"」","･":"・"},n=new RegExp("("+Object.keys(t).join("|")+")","g");return e.replace(n,(function(e){return t[e]})).replace(/ﾞ/g,"゛").replace(/ﾟ/g,"゜")},_zenkakuToHankaku:function(e){var t=e.replace(/[Ａ-Ｚａ-ｚ０-９]/g,(function(e){var t=e.charCodeAt(0)-65248;return String.fromCharCode(t)}));return this._zenkanaToHankana(t)},_zenkanaToHankana:function(e){var t={ガ:"ｶﾞ",ギ:"ｷﾞ",グ:"ｸﾞ",ゲ:"ｹﾞ",ゴ:"ｺﾞ",ザ:"ｻﾞ",ジ:"ｼﾞ",ズ:"ｽﾞ",ゼ:"ｾﾞ",ゾ:"ｿﾞ",ダ:"ﾀﾞ",ヂ:"ﾁﾞ",ヅ:"ﾂﾞ",デ:"ﾃﾞ",ド:"ﾄﾞ",バ:"ﾊﾞ",ビ:"ﾋﾞ",ブ:"ﾌﾞ",ベ:"ﾍﾞ",ボ:"ﾎﾞ",パ:"ﾊﾟ",ピ:"ﾋﾟ",プ:"ﾌﾟ",ペ:"ﾍﾟ",ポ:"ﾎﾟ",ヴ:"ｳﾞ",ヷ:"ﾜﾞ",ヺ:"ｦﾞ",ア:"ｱ",イ:"ｲ",ウ:"ｳ",エ:"ｴ",オ:"ｵ",カ:"ｶ",キ:"ｷ",ク:"ｸ",ケ:"ｹ",コ:"ｺ",サ:"ｻ",シ:"ｼ",ス:"ｽ",セ:"ｾ",ソ:"ｿ",タ:"ﾀ",チ:"ﾁ",ツ:"ﾂ",テ:"ﾃ",ト:"ﾄ",ナ:"ﾅ",ニ:"ﾆ",ヌ:"ﾇ",ネ:"ﾈ",ノ:"ﾉ",ハ:"ﾊ",ヒ:"ﾋ",フ:"ﾌ",ヘ:"ﾍ",ホ:"ﾎ",マ:"ﾏ",ミ:"ﾐ",ム:"ﾑ",メ:"ﾒ",モ:"ﾓ",ヤ:"ﾔ",ユ:"ﾕ",ヨ:"ﾖ",ラ:"ﾗ",リ:"ﾘ",ル:"ﾙ",レ:"ﾚ",ロ:"ﾛ",ワ:"ﾜ",ヲ:"ｦ",ン:"ﾝ",ァ:"ｧ",ィ:"ｨ",ゥ:"ｩ",ェ:"ｪ",ォ:"ｫ",ッ:"ｯ",ャ:"ｬ",ュ:"ｭ",ョ:"ｮ","。":"｡","、":"､",ー:"ｰ","「":"｢","」":"｣","・":"･"},n=new RegExp("("+Object.keys(t).join("|")+")","g");return e.replace(n,(function(e){return t[e]})).replace(/゛/g,"ﾞ").replace(/゜/g,"ﾟ")},_removeTag:function(e){return this.textEncoder.prototype.unescapeHTML(e),(e=e.replace(/<br>/g," \n")).replace(/<span(.*?)>(.*?)<\/span>/g,(function(e,t,n){return n}))},_splitText:function(e){return e.split(/[\x20\u3000\r\n]/).filter((function(e){return""!==e}))},_escapeRegExp:function(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}},e.exports=o},871:function(e){"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;this._buttonText=t.buttonText||"一番下に移動",this._onClickFunc=t.clickEvent||function(){},this.elementBackToBottomBtn=null,this.elementBackToBottomBtn=document.createElement("div"),this.elementBackToBottomBtn.setAttribute("id","backToBottomBtn"),this.elementBackToBottomBtn.setAttribute("role","button"),this.elementBackToBottomBtn.setAttribute("tabindex",1),this.elementBackToBottomBtn.setAttribute("aria-hidden",!0),this._downArrowIcon='<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24" fill="white"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"/></svg>',this.elementBackToBottomBtn.appendChild(this._html2dom(this._downArrowIcon)),this._elementButtonText=document.createElement("span"),this._elementButtonText.appendChild(document.createTextNode(this._buttonText)),this.elementBackToBottomBtn.appendChild(this._elementButtonText),this.elementBackToBottomBtn.addEventListener("click",(function(){n._onClickFunc()})),this.elementBackToBottomBtn.addEventListener("keyup",(function(e){13===e.keyCode&&n._onClickFunc()}))}return t(e,[{key:"getElement",value:function(){return this.elementBackToBottomBtn}},{key:"setTop",value:function(e){this.elementBackToBottomBtn.style.top=e}},{key:"show",value:function(){this.elementBackToBottomBtn.classList.add("active"),this.elementBackToBottomBtn.setAttribute("aria-hidden",!1)}},{key:"hide",value:function(){this.elementBackToBottomBtn.classList.remove("active"),this.elementBackToBottomBtn.setAttribute("aria-hidden",!0)}},{key:"_html2dom",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}}]),e}()},986:function(e){"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._bannerText=t.bannerText||"本サービスでは、サービスの利便向上のため、Cookieを利用します。サービスを利用することで、Cookieの使用に同意するものとします。",this._siteIn=t.siteIn||!1,this._backgroundColor=t.backgroundColor||"#ffffff",this._onHidden=t.onHidden||function(){},this._elementContainer=document.createElement("div"),this._elementContainer.setAttribute("class","cookie-banner"),this._elementContainer.style.position="absolute",this._elementContainer.style.left="0",this._elementContainer.style.width="100%",this._elementBannerText=document.createElement("p"),this._elementBannerText.style.position="absolute",this._elementBannerText.style.boxSizing="border-box",this._elementBannerText.style.width="100%",this._elementBannerText.style.bottom="-100%",this._elementBannerText.style.padding="8px",this._elementBannerText.style.margin="0",this._elementBannerText.style.color="#707070",this._elementBannerText.style.backgroundColor="#ffffff",this._elementBannerText.style.borderTop="1px solid #ccc",this._elementBannerText.style.fontSize=this._siteIn?"13px":"11.5px",this._elementBannerText.textContent=this._bannerText,this._elementContainer.appendChild(this._elementBannerText)}return t(e,[{key:"isShown",value:function(){return"none"!=this._elementContainer.style.display}},{key:"hide",value:function(){this._elementContainer.style.display="none",this._onHidden()}},{key:"setBottom",value:function(e){this._elementContainer.style.bottom=e}},{key:"getElement",value:function(){return this._elementContainer}}]),e}()},666:function(e){"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._title=void 0!==t.title?t.title:"",this._botImg=void 0!==t.botImg?t.botImg:{},this._botIconCircle=void 0!==t.botIconCircle&&t.botIconCircle,this._popupMessage=void 0!==t.popupMessage?t.popupMessage:"どのようなことにお困りでしょうか？",this._closeIconUse=t.closeIconUse||!1,this._titleTextColor=t.titleTextColor||"#FFFFFF",this._headerTopBgColor=t.headerTopBgColor||"#303030",this._closeBtnColor=t.closeBtnColor||"#FFFFFF",this._clickIcon=t.clickIcon||function(){},this._clickCloseBtn=t.clickCloseBtn||function(){},this.displayPcPopupIcon=t.displayPcPopupIcon||function(){},this.hiddenPcPopupIcon=t.hiddenPcPopupIcon||function(){},this._elementHeaderRemoveIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>');var n=this;if(this._elementDefaultPopupIconTop=document.createElement("div"),this._elementDefaultPopupIconTop.setAttribute("class","v2-default-popup-icon-top"),this._elementDefaultPopupIconTop.style.setProperty("background-color",this._headerTopBgColor),""!=this._botImg[0]){this._elementIcon=document.createElement("div"),this._elementIcon.setAttribute("class","v2-default-popup-icon-img"),this._botIconCircle&&this._elementIcon.classList.add("circle");var i=document.createElement("img");i.setAttribute("src",this._botImg[0]),i.setAttribute("alt","icon"),this._elementIcon.appendChild(i),this._elementDefaultPopupIconTop.appendChild(this._elementIcon)}this._elementDefaultPopupIconTitle=document.createElement("div"),this._elementDefaultPopupIconTitle.setAttribute("class","v2-default-popup-icon-title");var o=document.createTextNode(this._title);if(this._elementDefaultPopupIconTitle.style.setProperty("color",this._titleTextColor),""==this._botImg[0]&&this._elementDefaultPopupIconTitle.style.setProperty("padding-left","18px"),this._elementDefaultPopupIconTitle.appendChild(o),this._elementDefaultPopupIconTop.appendChild(this._elementDefaultPopupIconTitle),this._elementDefaultHeaderBtns=document.createElement("div"),this._elementDefaultHeaderBtns.setAttribute("class","v2-default-popup-header-btns"),this._elementDefaultPopupIconTop.appendChild(this._elementDefaultHeaderBtns),this._closeIconUse){this._elementRemoveBtn=document.createElement("div"),this._elementRemoveBtn.setAttribute("id","v2DefaultPopupRemoveBtn"),this._elementRemoveBtn.setAttribute("class","v2-default-popup-remove-btn"),this._elementRemoveBtn.setAttribute("role","button"),this._elementRemoveBtn.setAttribute("tabindex",0);var s=document.createElement("div");this._elementHeaderRemoveIcon.style.setProperty("fill",this._closeBtnColor),s.appendChild(this._elementHeaderRemoveIcon),this._elementRemoveBtn.appendChild(s),this._closeIconUse&&(this._elementRemoveBtn.addEventListener("click",(function(e){e.stopPropagation(),n._clickCloseBtn()})),this._elementRemoveBtn.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),n._clickCloseBtn())})),this._elementRemoveBtn.addEventListener("mousedown",(function(e){e.stopPropagation()}))),this._elementDefaultHeaderBtns.appendChild(this._elementRemoveBtn)}this._elementDefaultPopupIconBottom=document.createElement("div"),this._elementDefaultPopupIconBottom.setAttribute("class","v2-default-popup-icon-bottom");var a=document.createElement("div");a.innerHTML=this._popupMessage,this._elementDefaultPopupIconBottom.appendChild(a),this._elementContainer=document.createElement("div"),this._elementContainer.setAttribute("id","popupIcon"),this._elementContainer.setAttribute("class","v2-default-popup-icon"),this._elementContainer.setAttribute("role","button"),this._elementContainer.setAttribute("tabindex",0),this._elementContainer.setAttribute("aria-controls","_ul-widget"),this._elementContainer.setAttribute("aria-expanded",!1),this._elementContainer.appendChild(this._elementDefaultPopupIconTop),this._elementContainer.appendChild(this._elementDefaultPopupIconBottom),this._elementContainer.addEventListener("click",(function(){n._clickIcon()})),this._elementContainer.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickIcon()}))}return t(e,[{key:"getElement",value:function(){return this._elementContainer}},{key:"getHeaderBottomHeight",value:function(){return this._elementDefaultPopupIconBottom.clientHeight}},{key:"getType",value:function(){return"default"}},{key:"hidden",value:function(){this._elementContainer.style.setProperty("display","none"),this.hiddenPcPopupIcon()}},{key:"show",value:function(){this._elementContainer.style.setProperty("display","block"),this.displayPcPopupIcon()}},{key:"_html2dom",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}}]),e}()},647:function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(429);e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;this._reloadBtnFlag=t.reloadBtnFlag||!1,this._reloadBtnIcon=t.reloadBtnIcon||"home",this._mobileFlag=t.mobileFlag||!1,this._translateBtnFlag=t.translateBtnFlag||!1,this._menuEnabledFlag=t.menuEnabledFlag||!1,this._openFlag=!1,this._gptModeFlag=!1,this._operatorModeFlag=!1,this._langSelectModeFlag=!1,this._fullScreenFlag=!1,this._siteIn=void 0===t.siteIn||t.siteIn,this._title=void 0!==t.title?t.title:"",this._closeIconUse=void 0!==t.closeIconUse&&t.closeIconUse,this._pcIconUrl=void 0!==t.pcIconUrl&&t.pcIconUrl,this._headerTopHeight=parseInt(t.headerTopHeight)+"px"||0,this._titleTextColor=t.titleTextColor||"#FFFFFF",this._headerTopBgColor=t.headerTopBgColor||"#303030",this._closeBtnColor=t.closeBtnColor||"#FFFFFF",this._clickHeader=t.clickHeader||function(){},this._clickReloadBtn=t.clickReloadBtn||function(){},this._clickTranslateBtn=t.clickTranslateBtn||function(){},this._updateAriaEvent=t.updateAriaEvent||function(){},this._clickMenuBtn=t.clickMenuBtn||function(){},this._clickGptBtn=t.clickGptBtn||function(){},this._mouseDownHeader=t.mouseDownHeader||function(){},this._clickFullScreenBtn=t.clickFullScreenBtn||function(){},this._addResizePopupFullScreenEvent=t.addResizePopupFullScreenEvent||function(){},this._elementHeaderTitle=null,this._elementRestartBtn=null,this._elementMenuBtn=null,this._elementRemoveBtn=null,this._elementTranslateBtn=null,this._elementWidgetCloseBtn=null,this._elementWidgetHeaderTop=null;var i="home"===this._reloadBtnIcon?'<svg class="home" contentScriptType="text/ecmascript" contentStyleType="text/css" height="30px" preserveAspectRatio="xMidYMid meet" version="1.0" viewBox="0 0 60.000000 60.000000" width="30px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" zoomAndPan="magnify"  stroke="#000000" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"><g><polyline fill="none" points="9.0,35.0 9.0,59.0 23.0,59.0 23.0,41.0 37.0,41.0 37.0,59.0 51.0,59.0 51.0,35.0"/><polyline fill="none" points="1.0,34.0 30.0,5.0 59.0,34.0"/><polyline fill="none" points="39.0,7.0 49.0,7.0 49.0,17.0"/></g></svg>':'<svg class="reload" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 45 45"><path d="M24.1 39q-6.25 0-10.625-4.375T9.1 24q0-6.25 4.375-10.625T24.1 9q4.05 0 7.225 1.775t5.325 4.875V9h2.25v11.3H27.65V18h7.9q-1.8-3.05-4.725-4.9-2.925-1.85-6.725-1.85-5.35 0-9.05 3.7-3.7 3.7-3.7 9.05 0 5.35 3.7 9.05 3.7 3.7 9.05 3.7 4.05 0 7.4-2.325 3.35-2.325 4.7-6.175h2.35q-1.4 4.85-5.4 7.8T24.1 39Z"/></svg>';this._elementHomeIcon=this._html2dom(i),this._elementMobileCloseIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>'),this._elementHeaderCloseIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>'),this._elementTranslateIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24" width="24"><path d="M11.95 20.45 15.8 10.3h1.75l3.85 10.15h-1.75l-.9-2.575h-4.1l-.925 2.575Zm3.2-4.05h3.025L16.7 12.2h-.05Zm-9.875 1.525-1.225-1.2 4.3-4.3q-.8-.875-1.4-1.825-.6-.95-1.05-1.975h1.75q.4.75.825 1.35.425.6 1.025 1.3.95-1.025 1.575-2.087.625-1.063 1.025-2.263H2.725v-1.7H8.65V3.55h1.7v1.675h5.925v1.7H13.8q-.45 1.475-1.212 2.9-.763 1.425-1.863 2.65l2 2.075-.625 1.75-2.6-2.6Z"/></svg>'),this._elementMenuIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0,0,256,256" width="50px" height="50px" fill-rule="nonzero"><g fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(5.12,5.12)"><path d="M0,7.5v5h50v-5zM0,22.5v5h50v-5zM0,37.5v5h50v-5z"></path></g></g></svg>'),this._elementFullScreenIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M200-200v-240h80v160h160v80H200Zm480-320v-160H520v-80h240v240h-80Z"/></svg>'),this._elementExitFullScreenIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368"><path d="M440-440v240h-80v-160H200v-80h240Zm160-320v160h160v80H520v-240h80Z"/></svg>'),this._elementWidgetHeaderTop=document.createElement("div"),this._elementWidgetHeaderTop.setAttribute("id","v2PopupHeaderTop"),this._elementWidgetHeaderTop.setAttribute("class","v2-popup-header-top"),this._elementWidgetHeaderTop.style.setProperty("background-color",this._headerTopBgColor),this._elementHeaderTitle=document.createElement("div"),this._elementHeaderTitle.setAttribute("id","v2PopupHeadTitle"),this._elementHeaderTitle.setAttribute("class","v2-popup-header-title");var s=document.createTextNode(this._title);this._elementHeaderTitle.style.setProperty("color",this._titleTextColor),this._elementHeaderTitle.appendChild(s),this._elementWidgetHeaderTop.appendChild(this._elementHeaderTitle),this._elementHeaderBtns=document.createElement("div"),this._elementHeaderBtns.setAttribute("class","v2-popup-header-btns"),this._elementWidgetHeaderTop.appendChild(this._elementHeaderBtns),this._menuEnabledFlag?(this._elementMenuBtn=document.createElement("div"),this._elementMenuBtn.setAttribute("id","v2PopupMenuBtn"),this._elementMenuBtn.appendChild(this._elementMenuIcon),this._elementMenuBtn.setAttribute("role","button"),this._elementMenuBtn.setAttribute("tabindex",0),this._elementMenuIcon.style.setProperty("stroke",this._closeBtnColor),this._elementMenuIcon.style.setProperty("fill",this._closeBtnColor),this._elementMenuBtn.classList.add("hidden"),this._elementMenuBtn.addEventListener("click",(function(e){e.stopPropagation(),n._clickMenuBtn(e)})),this._elementMenuBtn.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),n._clickMenuBtn(e))})),this._elementMenuBtn.addEventListener("mousedown",(function(e){e.stopPropagation()})),this._translateBtnFlag&&(this._elementMenuBtn.style.marginLeft="0"),this._elementHeaderBtns.appendChild(this._elementMenuBtn)):(this._translateBtnFlag&&(this._elementTranslateBtn=document.createElement("div"),this._elementTranslateBtn.setAttribute("id","v2PopupTranslateBtn"),this._elementTranslateBtn.appendChild(this._elementTranslateIcon),this._elementTranslateBtn.setAttribute("role","button"),this._elementTranslateBtn.setAttribute("tabindex",0),this._elementTranslateBtn.setAttribute("aria-label","language"),this._elementTranslateBtn.setAttribute("aria-controls","languageMenu"),this._elementTranslateBtn.setAttribute("aria-expanded",!1),this._elementTranslateIcon.style.setProperty("stroke","none"),this._elementTranslateIcon.style.setProperty("fill",this._closeBtnColor),this._elementTranslateBtn.classList.add("hidden"),this._elementTranslateBtn.addEventListener("click",(function(e){n._clickTranslateBtn(e)})),this._elementTranslateBtn.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickTranslateBtn(e)})),this._elementTranslateBtn.addEventListener("mousedown",(function(e){e.stopPropagation()})),this._elementHeaderBtns.appendChild(this._elementTranslateBtn)),this._reloadBtnFlag&&(this._elementRestartBtn=document.createElement("div"),this._elementRestartBtn.setAttribute("id","v2PopupRestartBtn"),this._elementRestartBtn.setAttribute("role","button"),this._elementRestartBtn.setAttribute("tabindex",0),this._elementRestartBtn.setAttribute("aria-label","restart"),this._elementRestartBtn.appendChild(this._elementHomeIcon),this._elementHomeIcon.style.setProperty("stroke",this._closeBtnColor),this._elementHomeIcon.style.setProperty("fill",this._closeBtnColor),this._elementRestartBtn.classList.add("hidden"),this._elementRestartBtn.addEventListener("click",(function(e){n._clickReloadBtn(e)})),this._elementRestartBtn.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickReloadBtn(e)})),this._elementRestartBtn.addEventListener("mousedown",(function(e){e.stopPropagation()})),this._elementHeaderBtns.appendChild(this._elementRestartBtn))),this._mobileFlag||this._siteIn||o.Browser.IE||(this._elementFullScreenBtn=document.createElement("div"),this._elementFullScreenBtn.setAttribute("id","v2PopupFullScreenBtn"),this._elementFullScreenBtn.setAttribute("role","button"),this._elementFullScreenBtn.setAttribute("tabindex",0),this._elementFullScreenBtn.setAttribute("aria-label","fullscreen"),this._elementFullScreenBtn.appendChild(this._elementFullScreenIcon),this._elementExitFullScreenIcon.style.setProperty("stroke",this._closeBtnColor),this._elementExitFullScreenIcon.style.setProperty("fill",this._closeBtnColor),this._elementFullScreenIcon.style.setProperty("stroke",this._closeBtnColor),this._elementFullScreenIcon.style.setProperty("fill",this._closeBtnColor),this._elementFullScreenBtn.classList.add("hidden"),this._elementFullScreenBtn.addEventListener("click",(function(e){e.stopPropagation(),n._clickFullScreenBtn(n._fullScreenFlag)})),this._elementFullScreenBtn.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),n._clickFullScreenBtn(n._fullScreenFlag))})),this._addResizePopupFullScreenEvent(),this._elementFullScreenBtn.addEventListener("mousedown",(function(e){e.stopPropagation()})),this._elementHeaderBtns.appendChild(this._elementFullScreenBtn)),this._elementWidgetCloseBtn=document.createElement("div"),this._elementWidgetCloseBtn.setAttribute("class","v2-popup-close-btn"),this._elementWidgetCloseBtn.setAttribute("role","button"),this._elementWidgetCloseBtn.setAttribute("tabindex",0),this._elementWidgetCloseBtn.setAttribute("aria-label","close"),this._elementWidgetCloseBtn.setAttribute("aria-controls","_ul-widget"),this._elementWidgetCloseBtn.setAttribute("aria-expanded",!0),this._elementWidgetCloseBtn.classList.add("hidden"),this._elementWidgetCloseBtn.addEventListener("click",(function(e){e.stopPropagation(),n._clickHeader(e)})),this._elementWidgetCloseBtn.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),n._clickHeader(e))})),this._elementWidgetCloseBtn.addEventListener("mousedown",(function(e){e.stopPropagation()})),this._mobileFlag?(this._elementMobileCloseIcon.style.setProperty("fill",this._closeBtnColor),this._elementWidgetCloseBtn.appendChild(this._elementMobileCloseIcon)):(this._elementHeaderCloseIcon.style.setProperty("fill",this._closeBtnColor),this._elementWidgetCloseBtn.appendChild(this._elementHeaderCloseIcon)),this._elementHeaderBtns.appendChild(this._elementWidgetCloseBtn),this.elementWidgetHeader=document.createElement("div"),this.elementWidgetHeader.setAttribute("id","v2PopupHeader"),this.elementWidgetHeader.setAttribute("class","v2-popup-header"),this.elementWidgetHeader.setAttribute("role","button"),this.elementWidgetHeader.setAttribute("tabindex",0),this.elementWidgetHeader.setAttribute("aria-controls","_ul-widget"),this.elementWidgetHeader.setAttribute("aria-expanded",!1),this.elementWidgetHeader.appendChild(this._elementWidgetHeaderTop),this.elementWidgetHeader.addEventListener("click",n._clickHeader),this.elementWidgetHeader.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickHeader(e)}))}return i(e,[{key:"togglePopup",value:function(){this._openFlag?(this._elementWidgetHeaderTop.style.height="64px",this._gptModeFlag||this._operatorModeFlag||this._langSelectModeFlag||(this._elementMenuBtn&&this._elementMenuBtn.classList.add("hidden"),this._elementRestartBtn&&this._elementRestartBtn.classList.add("hidden"),this._elementTranslateBtn&&this._elementTranslateBtn.classList.add("hidden")),this._elementFullScreenBtn&&this._elementFullScreenBtn.classList.add("hidden"),this._elementWidgetCloseBtn.classList.add("hidden"),this._elementRemoveBtn&&this._elementRemoveBtn.classList.remove("hidden"),this._mobileFlag||(this._elementWidgetHeaderTop.style.cursor="pointer",this.elementWidgetHeader.removeEventListener("mousedown",this._mouseDownHeader),this.elementWidgetHeader.addEventListener("click",this._clickHeader)),this.elementWidgetHeader.setAttribute("aria-expanded",!1),this._elementWidgetCloseBtn.setAttribute("aria-expanded",!1),this._updateAriaEvent(!1),this._title.length>=16&&(this._elementHeaderTitle.style.fontSize=""),this._openFlag=!1):(this._elementWidgetHeaderTop.style.height=this._headerTopHeight,this._gptModeFlag||this._operatorModeFlag||this._langSelectModeFlag||(this._elementMenuBtn&&this._elementMenuBtn.classList.remove("hidden"),this._elementRestartBtn&&this._elementRestartBtn.classList.remove("hidden"),this._elementTranslateBtn&&this._elementTranslateBtn.classList.remove("hidden")),this._elementFullScreenBtn&&this._elementFullScreenBtn.classList.remove("hidden"),this._elementWidgetCloseBtn.classList.remove("hidden"),this._elementRemoveBtn&&this._elementRemoveBtn.classList.add("hidden"),this._mobileFlag||(this._elementWidgetHeaderTop.style.cursor="move",this.elementWidgetHeader.addEventListener("mousedown",this._mouseDownHeader),this.elementWidgetHeader.removeEventListener("click",this._clickHeader)),this.elementWidgetHeader.setAttribute("aria-expanded",!0),this._elementWidgetCloseBtn.setAttribute("aria-expanded",!0),this._updateAriaEvent(!0),this._title.length>=16&&(this._elementHeaderTitle.style.fontSize="0.8rem"),this._openFlag=!0)}},{key:"addEventDraggable",value:function(){this.elementWidgetHeader.addEventListener("mousedown",this._mouseDownHeader)}},{key:"getElement",value:function(){return this.elementWidgetHeader}},{key:"getElementImageBtn",value:function(){return this.elementWidgetHeader}},{key:"getHeaderTopHeight",value:function(){return parseInt(this._headerTopHeight)}},{key:"getCloseBtn",value:function(){return this._elementWidgetCloseBtn}},{key:"getReloadBtn",value:function(){return this._elementRestartBtn}},{key:"getTranslateBtn",value:function(){return this._elementTranslateBtn}},{key:"getFullScreenBtn",value:function(){return this._elementFullScreenBtn}},{key:"getFullScreenFlag",value:function(){return this._fullScreenFlag}},{key:"changeOperatorMode",value:function(){this._operatorModeFlag=!0,this._elementMenuBtn&&this._elementMenuBtn.classList.add("hidden"),this._elementRestartBtn&&this._elementRestartBtn.classList.add("hidden"),this._elementTranslateBtn&&this._elementTranslateBtn.classList.add("hidden")}},{key:"changeGptMode",value:function(){this._gptModeFlag=!0,this._elementMenuBtn&&this._elementMenuBtn.classList.add("hidden"),this._elementTranslateBtn&&this._elementTranslateBtn.classList.add("hidden"),this._elementRestartBtn&&this._elementRestartBtn.classList.add("hidden")}},{key:"changeUnGptMode",value:function(){this._gptModeFlag=!1,this._elementMenuBtn&&this._elementMenuBtn.classList.remove("hidden"),this._elementTranslateBtn&&this._elementTranslateBtn.classList.remove("hidden"),this._elementRestartBtn&&this._elementRestartBtn.classList.remove("hidden")}},{key:"changeLangSelectMode",value:function(){this._langSelectModeFlag=!0,this._elementMenuBtn&&this._elementMenuBtn.classList.add("hidden"),this._elementTranslateBtn&&this._elementTranslateBtn.classList.add("hidden"),this._elementRestartBtn&&this._elementRestartBtn.classList.add("hidden"),this._elementFullScreenBtn&&this._elementFullScreenBtn.classList.add("hidden")}},{key:"changeUnLangSelectMode",value:function(){this._langSelectModeFlag=!1,this._elementMenuBtn&&this._elementMenuBtn.classList.remove("hidden"),this._elementTranslateBtn&&this._elementTranslateBtn.classList.remove("hidden"),this._elementRestartBtn&&this._elementRestartBtn.classList.remove("hidden"),this._elementFullScreenBtn&&this._elementFullScreenBtn.classList.remove("hidden")}},{key:"removeEventDraggable",value:function(){this.elementWidgetHeader.removeEventListener("mousedown",this._mouseDownHeader)}},{key:"setFullScreenFlag",value:function(e){this._fullScreenFlag=e}},{key:"setFullScreenBtnIcon",value:function(e){this._elementFullScreenBtn.innerHTML="",e?(this._elementFullScreenBtn.appendChild(this._elementExitFullScreenIcon),this._elementFullScreenBtn.classList.add("fullscreen")):(this._elementFullScreenBtn.appendChild(this._elementFullScreenIcon),this._elementFullScreenBtn.classList.remove("fullscreen"))}},{key:"_html2dom",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}}]),e}()},571:function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(429);e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;this._siteIn=void 0===t.siteIn||t.siteIn,this._mobileFlag=t.mobileFlag||!1,this._currentUrl=t.currentUrl||"",this._translateBtnFlag=t.translateBtnFlag||!1,this._reloadBtnIcon=t.reloadBtnIcon||"home",this._reloadBtnFlag=t.reloadBtnFlag||!1,this._menuEnabledFlag=t.menuEnabledFlag||!1,this._poweredByFlag=t.poweredByFlag||!1,this._displayImageBtn=void 0===t.displayImageBtn||t.displayImageBtn,this._displayInputBoxFlag=t.displayInputBoxFlag||!1,this._gptModeFlag=t.gptModeFlag||0,this._gptDocModeFlag=t.gptDocModeFlag||0,this._sendIcon=void 0===t.sendIcon||t.sendIcon,this._inputPlaceholder=t.inputPlaceholder||"質問を入力してください。",this._inputTextColor=t.inputTextColor||"#333333",this._inputButtonValue=t.inputButtonValue||"送信",this._submitTextColor=t.submitTextColor||"#FFFFFF",this._submitBgColor=t.submitBgColor||"#4985CD",this._inputBgColor=t.inputBgColor||"#FFFFFF",this._sendInputFocusFlag=!1,this._clickReloadBtn=t.clickReloadBtn||function(){},this._clickSubmitBtn=t.clickSubmitBtn||function(){},this._clickSendInput=t.clickSendInput||function(){},this._clickImageBtn=t.clickImageBtn||function(){},this._keyPressSendInput=t.keyPressSendInput||function(){},this._keyUpSendInput=t.keyUpSendInput||function(){},this._inputSendInput=t.inputSendInput||function(){},this._clickMenuBtn=t.clickMenuBtn||function(){},this._focusSendInput=t.focusSendInput||function(){},this._blurSendInput=t.blurSendInput||function(){},this._setSuggestDisplayFlag=t.setSuggestDisplayFlag||function(){},this.quickSearchMenu=t.quickSearchMenu||null,this.elementChatSend=null,this.elementSuggest=null,this.elementSendInput=null,this.elementImageBtn=null,this._elementBottom=null,this._elementReloadBtn=null,this._elementSubmitBox=null,this._elementSubmitBtn=null,this._elementMenuBtn=null;var i="home"===this._reloadBtnIcon?'<svg class="home" contentScriptType="text/ecmascript" contentStyleType="text/css" height="30px" preserveAspectRatio="xMidYMid meet" version="1.0" viewBox="0 0 60.000000 60.000000" width="30px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" zoomAndPan="magnify"  stroke="#000000" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"><g><polyline fill="none" points="9.0,35.0 9.0,59.0 23.0,59.0 23.0,41.0 37.0,41.0 37.0,59.0 51.0,59.0 51.0,35.0"/><polyline fill="none" points="1.0,34.0 30.0,5.0 59.0,34.0"/><polyline fill="none" points="39.0,7.0 49.0,7.0 49.0,17.0"/></g></svg>':'<svg class="reload" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 45 45"><path d="M23.85 41.25Q16.7 41.25 11.65 36.2Q6.6 31.15 6.6 24Q6.6 16.85 11.65 11.775Q16.7 6.7 23.85 6.7Q28.4 6.7 31.875 8.525Q35.35 10.35 37.85 13.65V6.7H41.45V21.25H26.85V17.7H35.05Q33.1 14.9 30.35 13.175Q27.6 11.45 23.85 11.45Q18.6 11.45 14.95 15.1Q11.3 18.75 11.3 24Q11.3 29.25 14.95 32.9Q18.6 36.55 23.85 36.55Q27.75 36.55 31.075 34.3Q34.4 32.05 35.8 28.35H40.65Q39.15 34.1 34.475 37.675Q29.8 41.25 23.85 41.25Z"/></svg>';this._elementHomeIcon=this._html2dom(i),this._elementSendIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" width="18px" height="18px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3.4 20.4l17.45-7.48c.81-.35.81-1.49 0-1.84L3.4 3.6c-.66-.29-1.39.2-1.39.91L2 9.12c0 .5.37.93.87.99L17 12 2.87 13.88c-.5.07-.87.5-.87 1l.01 4.61c0 .71.73 1.2 1.39.91z"/></svg>'),this._elementImgIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>'),this._elementMenuIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0,0,256,256" width="50px" height="50px" fill-rule="nonzero"><g fill="#666666" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(5.12,5.12)"><path d="M0,7.5v5h50v-5zM0,22.5v5h50v-5zM0,37.5v5h50v-5z"></path></g></g></svg>'),this.elementChatSend=document.createElement("div"),this.elementChatSend.setAttribute("id","v2InputBox"),this._poweredByFlag&&this.elementChatSend.setAttribute("class","powered-by"),this.quickSearchMenu&&(this.elementChatSend.style.boxShadow="none"),this._siteIn&&(this._menuEnabledFlag?(this._elementMenuBtn=document.createElement("div"),this._elementMenuBtn.setAttribute("id","v2SiteInMenuBtn"),this._elementMenuBtn.appendChild(this._elementMenuIcon),this._elementMenuBtn.setAttribute("role","button"),this._elementMenuBtn.setAttribute("tabindex",0),this._elementMenuBtn.style.setProperty("background",this._inputBgColor),this._elementMenuBtn.addEventListener("click",(function(e){e.stopPropagation(),n._clickMenuBtn(e)})),this._elementMenuBtn.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),n._clickMenuBtn(e))})),this.elementChatSend.appendChild(this._elementMenuBtn)):this._reloadBtnFlag&&(this._elementReloadBtn=document.createElement("div"),this._elementReloadBtn.setAttribute("id","v2InputBoxRestartBtn"),this._elementReloadBtn.setAttribute("role","button"),this._elementReloadBtn.setAttribute("tabindex",0),this._elementReloadBtn.appendChild(this._elementHomeIcon),this._elementReloadBtn.style.setProperty("background",this._inputBgColor),this.elementChatSend.appendChild(this._elementReloadBtn),this._elementReloadBtn.addEventListener("click",(function(e){n._clickReloadBtn(e)})),this._elementReloadBtn.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickReloadBtn(e)})))),this.elementImageBtn=document.createElement("div"),this._displayImageBtn&&(this.elementImageBtn.setAttribute("class","v2-attach-image-btn"),this.elementImageBtn.setAttribute("role","button"),this.elementImageBtn.setAttribute("tabindex",0),this.elementImageBtn.appendChild(this._elementImgIcon),this.elementChatSend.appendChild(this.elementImageBtn),this.elementImageBtn.classList.add("hidden"),this.elementImageBtn.addEventListener("click",(function(e){n._clickImageBtn(e)})),this.elementImageBtn.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickImageBtn(e)}))),this._elementSendBox=document.createElement("div"),this._elementSendBox.setAttribute("class","v2-inputbox-send-box"),this.elementSuggest=document.createElement("div"),this.elementSuggest.setAttribute("id","suggest"),this.elementSendInput=document.createElement("input"),this.elementSendInput.setAttribute("id","v2InputBoxSend"),this.elementSendInput.setAttribute("type","text"),this.elementSendInput.setAttribute("autocomplete","off"),this.elementSendInput.setAttribute("placeholder",this._inputPlaceholder),this.elementSendInput.style.setProperty("color",this._inputTextColor),this.elementSendInput.style.setProperty("background",this._inputBgColor),this.elementSendInput.addEventListener("keypress",(function(e){n._keyPressSendInput(e)})),this.elementSendInput.addEventListener("keyup",(function(e){n._keyUpSendInput(e)})),this.elementSendInput.addEventListener("input",(function(){n._inputSendInput()})),this.elementSendInput.addEventListener("click",(function(){n._clickSendInput()})),this.elementSendInput.addEventListener("focus",(function(e){n._sendInputFocusFlag=!0,n._focusSendInput(e)})),this.elementSendInput.addEventListener("blur",(function(e){n._sendInputFocusFlag=!1,n._blurSendInput(e)}));var s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("name","dummy1"),s.setAttribute("value",""),s.style.display="none",s.disabled=!0;var a=document.createElement("input");if(a.setAttribute("type","text"),a.setAttribute("name","dummy2"),a.setAttribute("value",""),a.style.display="none",a.disabled=!0,this._elementSendBox.appendChild(this.elementSuggest),this._elementSendBox.appendChild(this.elementSendInput),this._elementSendBox.appendChild(s),this._elementSendBox.appendChild(a),this.elementChatSend.appendChild(this._elementSendBox),this._elementSubmitBox=document.createElement("div"),this._elementSubmitBox.setAttribute("id","v2InputboxSubmitBox"),this._elementSubmitBox.setAttribute("class","v2-inputbox-submit-box"),this._elementSubmitBox.style.setProperty("background",this._inputBgColor),this._elementSubmitBtn=document.createElement("input"),this._sendIcon&&(this._elementSubmitBtn=document.createElement("button"),this._elementSendIcon.style.setProperty("fill",this._submitTextColor),this._elementSubmitBtn.appendChild(this._elementSendIcon)),this._elementSubmitBtn.setAttribute("id","v2InputBoxSubmitBtn"),this._elementSubmitBtn.setAttribute("type","button"),this._elementSubmitBtn.setAttribute("value",this._inputButtonValue),this._elementSubmitBtn.style.setProperty("color",this._submitTextColor),this._elementSubmitBtn.style.setProperty("background",this._submitBgColor),o.clickOrSimilarEvent(this._elementSubmitBtn,(function(){n._clickSubmitBtn()}),(function(){}),this.elementChatSend),this._elementSubmitBox.appendChild(this._elementSubmitBtn),this.elementChatSend.appendChild(this._elementSubmitBox),this._elementBottom=document.createElement("div"),this._elementBottom.setAttribute("id","v2InputBoxBottom"),this._poweredByFlag){var r=document.createElement("a"),l=document.createElement("p"),c=document.createTextNode("Powered by"),d=document.createElement("img");d.alt="UserLocal",d.src=this._siteIn&&!this._mobileFlag?this._currentUrl+"/img/logo_black_176.png":this._currentUrl+"/img/logo_black.png",this._mobileFlag||(r.href="https://chatbot.userlocal.jp",r.target="_blank"),l.appendChild(c),r.appendChild(l),r.appendChild(d),this.elementChatSend.classList.add("powered-by"),this._elementBottom.appendChild(r)}this.elementChatSend.appendChild(this._elementBottom),this._displayInputBoxFlag||this.hideInput()}return i(e,[{key:"getElement",value:function(){return this.elementChatSend}},{key:"getElementSend",value:function(){return this.elementSendInput}},{key:"getElementSuggest",value:function(){return this.elementSuggest}},{key:"getElementImageBtn",value:function(){return this.elementImageBtn}},{key:"getHeight",value:function(){return this._mobileFlag?parseInt("60px"):parseInt("48px")}},{key:"getPaddingBottom",value:function(){return this._poweredByFlag?parseInt("26px"):parseInt("0px")}},{key:"getSendInputFocusFlag",value:function(){return this._sendInputFocusFlag}},{key:"getInputType",value:function(){return"default"}},{key:"changeOperatorMode",value:function(){this.elementImageBtn.classList.remove("hidden"),this._elementSubmitBtn.hasAttribute("disabled")&&(this._elementSubmitBtn.removeAttribute("disabled"),this._elementSubmitBtn.style.setProperty("cursor","pointer"),this._elementSubmitBtn.style.setProperty("background",this._submitBgColor)),this.elementSendInput.hasAttribute("disabled")&&(this.elementSendInput.removeAttribute("disabled"),this.elementSendInput.setAttribute("placeholder",this._inputPlaceholder),this.elementSendInput.style.setProperty("background",this._inputBgColor)),this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.add("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.add("hidden"),this._displayImageBtn||(this.elementSendInput.style.paddingLeft="12px")),this._setSuggestDisplayFlag(!1)}},{key:"changeUnOperatorMode",value:function(){this.elementImageBtn.classList.add("hidden"),this._displayImageBtn||(this.elementSendInput.style.paddingLeft="6px"),this._setSuggestDisplayFlag(!0)}},{key:"changeGptMode",value:function(){this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.add("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.add("hidden"),this.elementSendInput.style.paddingLeft="12px"),this._setSuggestDisplayFlag(!1)}},{key:"changeUnGptMode",value:function(){this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.remove("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.remove("hidden"),this.elementSendInput.style.paddingLeft="6px"),this._setSuggestDisplayFlag(!0)}},{key:"setBtnText",value:function(e){e=e||this._inputButtonValue,this._elementSubmitBtn.setAttribute("value",e)}},{key:"setPlaceholderText",value:function(e){e=e||this._inputPlaceholder,this.elementSendInput.setAttribute("placeholder",e)}},{key:"setPaddingBottom",value:function(e){this.elementChatSend.style.paddingBottom=(this._poweredByFlag?parseInt("26px"):parseInt("0px"))+e+"px"}},{key:"setBottomStyleBottom",value:function(e){this._elementBottom.style.bottom=e}},{key:"enableInputForm",value:function(e){e=e||this._inputPlaceholder,this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.remove("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.remove("hidden")),this.elementSendInput.style.setProperty("background-color",this._inputBgColor),this.elementSendInput.setAttribute("placeholder",e),this.elementSendInput.hasAttribute("disabled")&&this.elementSendInput.removeAttribute("disabled"),this._elementSubmitBox.style.setProperty("background",this._inputBgColor),this._elementSubmitBtn.style.setProperty("background",this._submitBgColor),this._elementSubmitBtn.style.setProperty("cursor","pointer"),this._sendIcon?this._elementSendIcon.style.setProperty("fill",this._submitTextColor):this._elementSubmitBtn.style.setProperty("color",this._submitTextColor),this._elementSubmitBtn.hasAttribute("disabled")&&this._elementSubmitBtn.removeAttribute("disabled")}},{key:"disableInputForm",value:function(e){e=e||"",this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.add("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.add("hidden")),this.elementSendInput.style.setProperty("background-color","#e0e0e0"),this.elementSendInput.setAttribute("placeholder",e),this.elementSendInput.setAttribute("disabled","disabled"),this._elementSubmitBox.style.setProperty("background","#e0e0e0"),this._elementSubmitBtn.style.setProperty("background","#d0d0d0"),this._elementSubmitBtn.style.setProperty("cursor","auto"),this._sendIcon?this._elementSendIcon.style.setProperty("fill","#bbbbbb"):this._elementSubmitBtn.style.setProperty("color","#bbbbbb"),this._elementSubmitBtn.setAttribute("disabled","disabled")}},{key:"show",value:function(){"none"==this.elementChatSend.style.display&&(this.elementChatSend.style.display="inline-flex"),this._translateBtnFlag&&(this._elementSendBox.style.display="inline-block",this._elementSubmitBox.style.display="inline-block",this.elementChatSend.style.height=this.getHeight()+"px"),this._displayInputBoxFlag||this.hideInput()}},{key:"showInput",value:function(){if(!this._displayInputBoxFlag)return!1;this._elementSendBox.style.display="inline-block",this._elementSubmitBox.style.display="inline-block",this.elementChatSend.style.height=this.getHeight()+"px",this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.remove("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.remove("hidden"))}},{key:"hide",value:function(){"none"!=this.elementChatSend.style.display&&(this.elementChatSend.style.display="none")}},{key:"hideInput",value:function(){this._elementSendBox.style.display="none",this._elementSubmitBox.style.display="none",this.elementChatSend.style.height=0,this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.add("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.add("hidden"))}},{key:"hideReloadBtn",value:function(){this._elementReloadBtn&&this._elementReloadBtn.classList.add("hidden"),this._elementBottomReloadBtn&&(this._elementBottomReloadBtn.style.display="none")}},{key:"isInputShown",value:function(){return"none"!=this._elementSendBox.style.display}},{key:"_html2dom",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}}]),e}()},613:function(e){"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._reloadBtnIcon=t.reloadBtnIcon||"home",this._reloadBtnFlag=t.reloadBtnFlag||!1,this._mobileFlag=t.mobileFlag||!1,this._popupModalFlag=t.popupModalFlag||!1,this._clickTranslateBtn=t.clickTranslateBtn||function(){},this._clickReloadBtn=t.clickReloadBtn||function(){},this._clickCloseBtn=t.clickCloseBtn||function(){};var n="home"===this._reloadBtnIcon?'<svg class="home" contentScriptType="text/ecmascript" contentStyleType="text/css" height="30px" preserveAspectRatio="xMidYMid meet" version="1.0" viewBox="0 0 60.000000 60.000000" width="30px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" zoomAndPan="magnify"  stroke="#000000" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"><g><polyline fill="none" points="9.0,35.0 9.0,59.0 23.0,59.0 23.0,41.0 37.0,41.0 37.0,59.0 51.0,59.0 51.0,35.0"/><polyline fill="none" points="1.0,34.0 30.0,5.0 59.0,34.0"/><polyline fill="none" points="39.0,7.0 49.0,7.0 49.0,17.0"/></g></svg>':'<svg class="reload" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 45 45"><path d="M23.85 41.25Q16.7 41.25 11.65 36.2Q6.6 31.15 6.6 24Q6.6 16.85 11.65 11.775Q16.7 6.7 23.85 6.7Q28.4 6.7 31.875 8.525Q35.35 10.35 37.85 13.65V6.7H41.45V21.25H26.85V17.7H35.05Q33.1 14.9 30.35 13.175Q27.6 11.45 23.85 11.45Q18.6 11.45 14.95 15.1Q11.3 18.75 11.3 24Q11.3 29.25 14.95 32.9Q18.6 36.55 23.85 36.55Q27.75 36.55 31.075 34.3Q34.4 32.05 35.8 28.35H40.65Q39.15 34.1 34.475 37.675Q29.8 41.25 23.85 41.25Z"/></svg>';this._elementHomeIcon=this._html2dom(n),this._elementTranslateIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24" width="24"><path d="M11.95 20.45 15.8 10.3h1.75l3.85 10.15h-1.75l-.9-2.575h-4.1l-.925 2.575Zm3.2-4.05h3.025L16.7 12.2h-.05Zm-9.875 1.525-1.225-1.2 4.3-4.3q-.8-.875-1.4-1.825-.6-.95-1.05-1.975h1.75q.4.75.825 1.35.425.6 1.025 1.3.95-1.025 1.575-2.087.625-1.063 1.025-2.263H2.725v-1.7H8.65V3.55h1.7v1.675h5.925v1.7H13.8q-.45 1.475-1.212 2.9-.763 1.425-1.863 2.65l2 2.075-.625 1.75-2.6-2.6Z"/></svg>'),this._elementArrowDropDownIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24"><path d="m12 15-5-5h10Z"/></svg>'),this._elementCloseIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none" stroke="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>');var i=this;if(this._elementContainer=document.createElement("div"),this._elementContainer.classList.add("language-header"),this._reloadBtnFlag){this._elementReloadBtn=document.createElement("div");var o=this._elementHomeIcon;this._elementReloadBtn.setAttribute("id","v2SiteInReloadBtn"),this._elementReloadBtn.setAttribute("role","button"),this._elementReloadBtn.setAttribute("tabindex",0),this._elementReloadBtn.classList.add(this._reloadBtnIcon),this._elementReloadBtn.appendChild(o),this._elementReloadBtnText=document.createElement("span"),this._elementReloadBtnText.textContent="Restart",this._elementReloadBtnText.style.marginLeft="6px",this._elementReloadBtn.appendChild(this._elementReloadBtnText),this._elementReloadBtn.addEventListener("click",(function(e){i._clickReloadBtn(e)})),this._elementReloadBtn.addEventListener("keyup",(function(e){13===e.keyCode&&i._clickReloadBtn(e)})),this._elementContainer.appendChild(this._elementReloadBtn)}this.elementTranslateBtn=document.createElement("div"),this.elementTranslateBtn.setAttribute("id","v2SiteInTranslateBtn"),this.elementTranslateBtn.setAttribute("role","button"),this.elementTranslateBtn.setAttribute("tabindex",0),this.elementTranslateBtn.setAttribute("aria-controls","languageMenu"),this.elementTranslateBtn.setAttribute("aria-expanded",!1),this._elementTranslateIcon.setAttribute("class","language"),this.elementTranslateBtn.appendChild(this._elementTranslateIcon);var s=document.createElement("span");s.textContent="Language",s.style.marginLeft="4px",this.elementTranslateBtn.appendChild(s);var a=this._elementArrowDropDownIcon;a.setAttribute("class","arrow"),this.elementTranslateBtn.appendChild(a),this.elementTranslateBtn.addEventListener("click",(function(e){i._clickTranslateBtn(e)})),this.elementTranslateBtn.addEventListener("keyup",(function(e){13===e.keyCode&&i._clickTranslateBtn(e)})),this._elementContainer.appendChild(this.elementTranslateBtn),this._popupModalFlag&&(this._elementCloseBtn=document.createElement("div"),this._elementCloseIcon.setAttribute("class","close"),this._elementCloseBtn.setAttribute("id","v2SiteInModalCloseBtn"),this._elementCloseBtn.setAttribute("role","button"),this._elementCloseBtn.setAttribute("tabindex",0),this._elementCloseBtn.appendChild(this._elementCloseIcon),this._elementCloseBtn.addEventListener("click",(function(e){i._clickCloseBtn(e)})),this._elementCloseBtn.addEventListener("keyup",(function(e){13===e.keyCode&&i._clickCloseBtn(e)})),this._elementContainer.appendChild(this._elementCloseBtn))}return t(e,[{key:"getElement",value:function(){return this._elementContainer}},{key:"getHeight",value:function(){return parseInt("41px")}},{key:"getButtonHeight",value:function(){return parseInt("30px")}},{key:"getButtonMarginBottom",value:function(){return(this.getHeight()-this.getButtonHeight())/2}},{key:"show",value:function(){"none"==this._elementContainer.style.display&&(this._elementContainer.style.display="flex")}},{key:"hide",value:function(){"none"!=this._elementContainer.style.display&&(this._elementContainer.style.display="none")}},{key:"isShown",value:function(){return"none"!=this._elementContainer.style.display}},{key:"changeLangSelectMode",value:function(){this._elementReloadBtn&&this._elementReloadBtn.classList.add("hidden")}},{key:"changeUnLangSelectMode",value:function(){this._elementReloadBtn&&this._elementReloadBtn.classList.remove("hidden")}},{key:"changeRemoveMode",value:function(){this._elementReloadBtn&&this._elementReloadBtn.classList.add("hidden"),this.elementTranslateBtn&&this.elementTranslateBtn.classList.add("hidden"),this._elementCloseBtn&&this._elementCloseBtn.classList.add("no-before")}},{key:"resize",value:function(){this._elementContainer.clientWidth>350?this._elementContainer.classList.remove("icon-only"):this._elementContainer.classList.add("icon-only")}},{key:"setBtnText",value:function(e){this._elementReloadBtnText.textContent=e||"Restart"}},{key:"_html2dom",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}}]),e}()},291:function(e){"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._langList=t.langList,this._clickLangEvent=t.clickLangEvent||function(){},this._updateAriaEvent=t.updateAriaEvent||function(){},this._elementContainer=document.createElement("ul"),this._elementContainer.setAttribute("id","languageMenu");var n=this;n._langList.forEach((function(e){n._elementLangText=document.createElement("li"),n._elementLangText.textContent=e.text,n._elementLangText.setAttribute("role","button"),n._elementLangText.setAttribute("tabindex",0),n._elementLangText.addEventListener("click",(function(t){t.stopPropagation(),n._clickLangEvent(e),n.hide()})),n._elementLangText.addEventListener("keyup",(function(t){13===t.keyCode&&(t.stopPropagation(),n._clickLangEvent(e),n.hide())})),n._elementLangText.addEventListener("mousedown",(function(e){e.stopPropagation()})),n._elementContainer.appendChild(n._elementLangText)})),this._updateAriaEvent(!0)}return t(e,[{key:"hide",value:function(){"none"!=this._elementContainer.style.display&&(this._elementContainer.style.display="none",this._updateAriaEvent(!1))}},{key:"toggle",value:function(){"none"==this._elementContainer.style.display?(this._elementContainer.style.display="block",this._elementContainer.setAttribute("aria-hidden",!1),this._updateAriaEvent(!0)):(this._elementContainer.style.display="none",this._elementContainer.setAttribute("aria-hidden",!0),this._updateAriaEvent(!1))}},{key:"setStyleTop",value:function(e){this._elementContainer.style.top=e}},{key:"setStyleRight",value:function(e){this._elementContainer.style.right=e}},{key:"getElement",value:function(){return this._elementContainer}}]),e}()},709:function(e){"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;this._siteInFlag=t.siteInFlag||!1,this._reloadBtnFlag=t.reloadBtnFlag||!1,this._translateBtnFlag=t.translateBtnFlag||!1,this._translatedFlag=t.translatedFlag||!1,this._gptBtnFlag=t.gptBtnFlag||!1,this._gptDocBtnFlag=t.gptDocBtnFlag||!1,this._customMenuItems=t.customMenuItems||[],this._clickReloadBtn=t.clickReloadBtn||function(){},this._clickGptBtn=t.clickGptBtn||function(){},this._clickTranslateBtn=t.clickTranslateBtn||function(){},this._clickCustomMenu=t.clickCustomMenu||function(){},this._restartText=t.restartText||"はじめから",this._gptText=t.gptText||"生成AI検索モード",this._gptDocText=t.gptDocText||"生成AI検索モード（ファイル）",this._translateText=t.translateText||"言語選択",this._elementAiSparkleSvg=t.aiSparkleSvg||'<svg version="1.1" class="ai-sparkle" height="24" width="24" fill="#6495ED"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve"><g><path d="M494.696,155.436l-75.664-19.918c-24.946-6.56-44.421-26.036-50.982-50.963L348.142,8.892 C346.769,3.647,342.032,0,336.618,0c-5.424,0-10.161,3.647-11.542,8.892l-19.908,75.664c-6.56,24.927-26.036,44.402-50.982,50.963 l-75.664,19.918c-5.245,1.381-8.892,6.109-8.892,11.533c0,5.424,3.647,10.151,8.892,11.534l75.664,19.917 c24.946,6.552,44.422,26.036,50.982,50.963l19.908,75.665c1.381,5.245,6.119,8.892,11.542,8.892c5.414,0,10.151-3.647,11.524-8.892 l19.907-75.665c6.561-24.927,26.036-44.411,50.982-50.963l75.664-19.917c5.244-1.382,8.892-6.11,8.892-11.534 C503.587,161.546,499.94,156.818,494.696,155.436z"></path> <path d="M207.001,402.949l-46.226-12.163c-15.236-4.004-27.136-15.904-31.14-31.13l-12.172-46.226 c-0.837-3.215-3.723-5.432-7.041-5.432c-3.308,0-6.203,2.218-7.04,5.432l-12.163,46.226c-4.014,15.226-15.913,27.126-31.149,31.13 l-46.226,12.163c-3.196,0.846-5.432,3.741-5.432,7.049c0,3.309,2.237,6.204,5.432,7.049l46.226,12.163 c15.236,4.004,27.136,15.904,31.149,31.131l12.163,46.226c0.836,3.215,3.732,5.433,7.04,5.433c3.318,0,6.204-2.218,7.041-5.433 l12.172-46.226c4.004-15.227,15.904-27.127,31.14-31.131l46.226-12.163c3.196-0.845,5.432-3.74,5.432-7.049 C212.434,406.69,210.197,403.795,207.001,402.949z"></path></g></svg>',this._elementListMenuItem=[],this._elementContainer=document.createElement("ul"),this._elementContainer.setAttribute("id","v2Menu"),this._reloadBtnFlag&&(this._elementRestart=document.createElement("li"),this._elementRestart.setAttribute("role","button"),this._elementRestart.setAttribute("tabindex",0),this._elementRestartText=document.createElement("span"),this._elementRestartText.textContent=this._restartText,this._elementRestart.appendChild(this._elementRestartText),this._elementRestart.addEventListener("click",(function(e){e.stopPropagation(),n._clickReloadBtn(e),n.toggle()})),this._elementRestart.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),n._clickReloadBtn(e),n.toggle())})),this._elementRestart.addEventListener("mousedown",(function(e){e.stopPropagation()})),this._elementListMenuItem.push(this._elementRestart)),this._gptBtnFlag&&(this._elementGpt=document.createElement("li"),this._elementGpt.setAttribute("role","button"),this._elementGpt.setAttribute("tabindex",0),this._elementGpt.style.display="flex",this._elementGptText=document.createElement("span"),this._elementGptText.textContent=this._gptText,this._elementGpt.appendChild(this._elementGptText),this._elementGpt.appendChild(this._html2dom(this._elementAiSparkleSvg)),this._elementGpt.addEventListener("click",(function(e){e.stopPropagation(),n._clickGptBtn("gpt"),n.toggle()})),this._elementGpt.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),n._clickGptBtn("gpt"),n.toggle())})),this._elementGpt.addEventListener("mousedown",(function(e){e.stopPropagation()})),this._elementListMenuItem.push(this._elementGpt)),this._gptDocBtnFlag&&(this._elementGptDoc=document.createElement("li"),this._elementGptDoc.setAttribute("role","button"),this._elementGptDoc.setAttribute("tabindex",0),this._elementGptDoc.style.display="flex",this._elementGptDocText=document.createElement("span"),this._elementGptDocText.textContent=this._gptDocText,this._elementGptDoc.appendChild(this._elementGptDocText),this._elementGptDoc.appendChild(this._html2dom(this._elementAiSparkleSvg)),this._elementGptDoc.addEventListener("click",(function(e){e.stopPropagation(),n._clickGptBtn("gpt_doc"),n.toggle()})),this._elementGptDoc.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),n._clickGptBtn("gpt_doc"),n.toggle())})),this._elementGptDoc.addEventListener("mousedown",(function(e){e.stopPropagation()})),this._elementListMenuItem.push(this._elementGptDoc)),!this._siteInFlag&&this._translateBtnFlag&&(this._elementTranslate=document.createElement("li"),this._elementTranslate.setAttribute("role","button"),this._elementTranslate.setAttribute("tabindex",0),this._elementTranslate.style.display="flex",this._elementTranslateText=document.createElement("span"),this._elementTranslateText.textContent=this._translateText,this._elementTranslate.appendChild(this._elementTranslateText),this._elementTranslate.addEventListener("click",(function(e){e.stopPropagation(),n._clickTranslateBtn(e),n.toggle()})),this._elementTranslate.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),n._clickTranslateBtn(e),n.toggle())})),this._elementTranslate.addEventListener("mousedown",(function(e){e.stopPropagation()})),this._elementListMenuItem.push(this._elementTranslate)),0!=this._customMenuItems.length&&this._customMenuItems.forEach((function(e){var t=document.createElement("a");t.setAttribute("role","button"),t.setAttribute("tabindex",0),t.setAttribute("href",e.url),t.setAttribute("target","_blank"),t.setAttribute("rel","nofollow noopener"),t.style.display="flex",e.url.toLowerCase().match(/j\s*a\s*v\s*a\s*s\s*c\s*r\s*i\s*p\s*t\s*:/g)&&t.setAttribute("href","#"),t.addEventListener("click",(function(e){e.stopPropagation(),n._clickCustomMenu()})),t.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),n._clickCustomMenu())})),t.addEventListener("mousedown",(function(e){e.stopPropagation()}));var i=document.createElement("span");i.textContent=e.text;var o=n._html2dom('<svg class="menu-link" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M5 21q-.825 0-1.413-.587Q3 19.825 3 19V5q0-.825.587-1.413Q4.175 3 5 3h7v2H5v14h14v-7h2v7q0 .825-.587 1.413Q19.825 21 19 21Zm4.7-5.3-1.4-1.4L17.6 5H14V3h7v7h-2V6.4Z"/></svg>');o.style.width="16px",o.style.height="16px",o.style.marginLeft="6px",o.style.verticalAlign="text-bottom",i.appendChild(o),t.appendChild(i),n._elementListMenuItem.push(t)})),this._siteInFlag&&this._elementListMenuItem.reverse(),this._elementListMenuItem.forEach((function(e){n._elementContainer.appendChild(e)}))}return t(e,[{key:"show",value:function(){"none"===this._elementContainer.style.display&&(this._elementContainer.style.display="block")}},{key:"hide",value:function(){"none"!=this._elementContainer.style.display&&(this._elementContainer.style.display="none")}},{key:"toggle",value:function(){"none"==this._elementContainer.style.display?(this._elementContainer.style.display="block",this._elementContainer.setAttribute("aria-hidden",!1)):(this._elementContainer.style.display="none",this._elementContainer.setAttribute("aria-hidden",!0))}},{key:"setText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.restartText&&this._reloadBtnFlag&&(this._restartText=e.restartText,this._elementRestartText.textContent=e.restartText),e.gptText&&this._gptBtnFlag&&(this._gptText=e.gptText,this._elementGptText.textContent=e.gptText),e.gptDocText&&this._gptDocBtnFlag&&(this._gptDocText=e.gptDocText,this._elementGptDocText.textContent=e.gptDocText),e.translateText&&!this._siteInFlag&&this._translateBtnFlag&&(this._translateText=e.translateText,this._elementTranslateText.textContent=e.translateText)}},{key:"setMaxHeight",value:function(e){this._elementContainer.style.maxHeight=e}},{key:"setStyleTop",value:function(e){this._elementContainer.style.top=e}},{key:"setStyleLeft",value:function(e){this._elementContainer.style.left=e}},{key:"setStyleRight",value:function(e){this._elementContainer.style.right=e}},{key:"getHeight",value:function(){return this._elementContainer.offsetHeight}},{key:"getElement",value:function(){return this._elementContainer}},{key:"_html2dom",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}}]),e}()},980:function(e){"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._clickCloseBtn=t.clickCloseBtn||function(){},this._elementCloseIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none" stroke="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>');var n=this;this._elementContainer=document.createElement("div"),this._elementContainer.classList.add("modal-header"),this._elementCloseBtn=document.createElement("div"),this._elementCloseIcon.setAttribute("class","close"),this._elementCloseBtn.setAttribute("id","v2SiteInModalCloseBtn"),this._elementCloseBtn.setAttribute("role","button"),this._elementCloseBtn.setAttribute("tabindex",0),this._elementCloseBtn.appendChild(this._elementCloseIcon),this._elementCloseBtn.addEventListener("click",(function(e){n._clickCloseBtn(e)})),this._elementCloseBtn.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickCloseBtn(e)})),this._elementContainer.appendChild(this._elementCloseBtn)}return t(e,[{key:"getElement",value:function(){return this._elementContainer}},{key:"getHeight",value:function(){return parseInt("41px")}},{key:"show",value:function(){"none"==this._elementContainer.style.display&&(this._elementContainer.style.display="flex")}},{key:"hide",value:function(){"none"!=this._elementContainer.style.display&&(this._elementContainer.style.display="none")}},{key:"isShown",value:function(){return"none"!=this._elementContainer.style.display}},{key:"_html2dom",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}}]),e}()},337:function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(429);e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;this._siteIn=void 0===t.siteIn||t.siteIn,this._mobileFlag=t.mobileFlag||!1,this._currentUrl=t.currentUrl||"",this._operatorFlag=t.operatorFlag||!1,this._translateBtnFlag=t.translateBtnFlag||!1,this._reloadBtnIcon=t.reloadBtnIcon||"home",this._reloadBtnFlag=t.reloadBtnFlag||!1,this._menuEnabledFlag=t.menuEnabledFlag||!1,this._poweredByFlag=t.poweredByFlag||!1,this._displayImageBtn=void 0===t.displayImageBtn||t.displayImageBtn,this._displayInputBoxFlag=t.displayInputBoxFlag||!1,this._sendIcon=void 0===t.sendIcon||t.sendIcon,this._inputPlaceholder=t.inputPlaceholder||"質問を入力してください。",this._lineBreakPlaceholder=t.lineBreakPlaceholder||"Shift + Enterで改行",this._inputTextColor=t.inputTextColor||"#333333",this._inputButtonValue=t.inputButtonValue||"送信",this._submitTextColor=t.submitTextColor||"#FFFFFF",this._submitBgColor=t.submitBgColor||"#4985CD",this._inputBgColor=t.inputBgColor||"#FFFFFF",this._sendInputFocusFlag=!1,this._clickReloadBtn=t.clickReloadBtn||function(){},this._clickSubmitBtn=t.clickSubmitBtn||function(){},this._clickSendInput=t.clickSendInput||function(){},this._clickImageBtn=t.clickImageBtn||function(){},this._keyPressSendInput=t.keyPressSendInput||function(){},this._keyUpSendInput=t.keyUpSendInput||function(){},this._clickMenuBtn=t.clickMenuBtn||function(){},this._focusSendInput=t.focusSendInput||function(){},this._blurSendInput=t.blurSendInput||function(){},this._inputSendInput=t.inputSendInput||function(){},this._setSuggestDisplayFlag=t.setSuggestDisplayFlag||function(){},this.quickSearchMenu=t.quickSearchMenu||null,this.elementChatSend=null,this.elementSuggest=null,this.elementSendInput=null,this.elementImageBtn=null,this._elementBottom=null,this._elementReloadBtn=null,this._elementSubmitBox=null,this._elementSubmitBtn=null,this._elementMenuBtn=null;var i="home"===this._reloadBtnIcon?'<svg class="home" contentScriptType="text/ecmascript" contentStyleType="text/css" height="30px" preserveAspectRatio="xMidYMid meet" version="1.0" viewBox="0 0 60.000000 60.000000" width="30px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" zoomAndPan="magnify"  stroke="#000000" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"><g><polyline fill="none" points="9.0,35.0 9.0,59.0 23.0,59.0 23.0,41.0 37.0,41.0 37.0,59.0 51.0,59.0 51.0,35.0"/><polyline fill="none" points="1.0,34.0 30.0,5.0 59.0,34.0"/><polyline fill="none" points="39.0,7.0 49.0,7.0 49.0,17.0"/></g></svg>':'<svg class="reload" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 45 45"><path d="M23.85 41.25Q16.7 41.25 11.65 36.2Q6.6 31.15 6.6 24Q6.6 16.85 11.65 11.775Q16.7 6.7 23.85 6.7Q28.4 6.7 31.875 8.525Q35.35 10.35 37.85 13.65V6.7H41.45V21.25H26.85V17.7H35.05Q33.1 14.9 30.35 13.175Q27.6 11.45 23.85 11.45Q18.6 11.45 14.95 15.1Q11.3 18.75 11.3 24Q11.3 29.25 14.95 32.9Q18.6 36.55 23.85 36.55Q27.75 36.55 31.075 34.3Q34.4 32.05 35.8 28.35H40.65Q39.15 34.1 34.475 37.675Q29.8 41.25 23.85 41.25Z"/></svg>';this._elementHomeIcon=this._html2dom(i),this._elementSendIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" width="18px" height="18px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3.4 20.4l17.45-7.48c.81-.35.81-1.49 0-1.84L3.4 3.6c-.66-.29-1.39.2-1.39.91L2 9.12c0 .5.37.93.87.99L17 12 2.87 13.88c-.5.07-.87.5-.87 1l.01 4.61c0 .71.73 1.2 1.39.91z"/></svg>'),this._elementImgIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>'),this._elementMenuIcon=this._html2dom('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0,0,256,256" width="50px" height="50px" fill-rule="nonzero"><g fill="#666666" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(5.12,5.12)"><path d="M0,7.5v5h50v-5zM0,22.5v5h50v-5zM0,37.5v5h50v-5z"></path></g></g></svg>'),this.elementChatSend=document.createElement("div"),this.elementChatSend.setAttribute("id",this._operatorFlag?"v2OperatorInputBox":"v2InputBox"),this.elementChatSend.classList.add("newline"),this._poweredByFlag&&this.elementChatSend.classList.add("powered-by"),this._operatorFlag&&this.elementChatSend.style.setProperty("display","none"),this.quickSearchMenu&&(this.elementChatSend.style.boxShadow="none"),this.elementImageBtn=document.createElement("div"),this._displayImageBtn&&(this.elementImageBtn.setAttribute("class","v2-attach-image-btn"),this.elementImageBtn.setAttribute("role","button"),this.elementImageBtn.setAttribute("tabindex",0),this.elementImageBtn.appendChild(this._elementImgIcon),this.elementChatSend.appendChild(this.elementImageBtn),this._operatorFlag||this.elementImageBtn.classList.add("hidden"),this.elementImageBtn.addEventListener("click",(function(e){n._clickImageBtn(e)})),this.elementImageBtn.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickImageBtn(e)})),this._operatorFlag&&this.elementChatSend.appendChild(this.elementImageBtn)),this._siteIn&&(this._menuEnabledFlag?(this._elementMenuBtn=document.createElement("div"),this._elementMenuBtn.setAttribute("id","v2SiteInMenuBtn"),this._elementMenuBtn.setAttribute("role","button"),this._elementMenuBtn.setAttribute("tabindex",0),this._elementMenuBtn.appendChild(this._elementMenuIcon),this._elementMenuBtn.addEventListener("click",(function(e){e.stopPropagation(),n._clickMenuBtn(e)})),this._elementMenuBtn.addEventListener("keyup",(function(e){13===e.keyCode&&(e.stopPropagation(),n._clickMenuBtn(e))})),this._operatorFlag||this.elementChatSend.appendChild(this._elementMenuBtn)):this._reloadBtnFlag&&(this._elementReloadBtn=document.createElement("div"),this._elementReloadBtn.setAttribute("id","v2InputBoxRestartBtn"),this._elementReloadBtn.setAttribute("role","button"),this._elementReloadBtn.setAttribute("tabindex",0),this._elementReloadBtn.appendChild(this._elementHomeIcon),this._elementReloadBtn.style.setProperty("background","#f9f9f9"),this._elementReloadBtn.addEventListener("click",(function(e){n._clickReloadBtn(e)})),this._elementReloadBtn.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickReloadBtn(e)})),this._operatorFlag||this.elementChatSend.appendChild(this._elementReloadBtn))),this._elementSendBox=document.createElement("div"),this._elementSendBox.setAttribute("class","v2-inputbox-send-box"),!this._displayImageBtn&&this._operatorFlag&&this._elementSendBox.classList.add("no-image-btn"),this.elementSuggest=document.createElement("div"),this.elementSuggest.setAttribute("id","suggest"),this.elementSuggest.setAttribute("class","newline"),this.elementSendInput=document.createElement("textarea"),this.elementSendInput.setAttribute("id",this._operatorFlag?"v2OperatorInputBoxSend":"v2InputBoxSend"),this.elementSendInput.setAttribute("type","text"),this.elementSendInput.setAttribute("autocomplete","off"),this._mobileFlag||(this._inputPlaceholder+="\n("+this._lineBreakPlaceholder+")"),this.elementSendInput.setAttribute("placeholder",this._inputPlaceholder),this.elementSendInput.style.setProperty("color",this._inputTextColor),this.elementSendInput.style.setProperty("background",this._inputBgColor),this.elementSendInput.addEventListener("keypress",(function(e){n._keyPressSendInput(e)})),this.elementSendInput.addEventListener("keyup",(function(e){n._keyUpSendInput(e)})),this.elementSendInput.addEventListener("click",(function(){n._clickSendInput()})),this.elementSendInput.addEventListener("focus",(function(e){n._sendInputFocusFlag=!0,n._focusSendInput(e)})),this.elementSendInput.addEventListener("blur",(function(e){n._sendInputFocusFlag=!1,n._blurSendInput(e)})),this.elementSendInput.addEventListener("input",(function(){n._inputSendInput()}));var s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("name","dummy1"),s.setAttribute("value",""),s.style.display="none",s.disabled=!0;var a=document.createElement("input");if(a.setAttribute("type","text"),a.setAttribute("name","dummy2"),a.setAttribute("value",""),a.style.display="none",a.disabled=!0,this._operatorFlag||this._elementSendBox.appendChild(this.elementSuggest),this._elementSendBox.appendChild(this.elementSendInput),this._elementSendBox.appendChild(s),this._elementSendBox.appendChild(a),this.elementChatSend.appendChild(this._elementSendBox),this._elementSubmitBox=document.createElement("div"),this._elementSubmitBox.setAttribute("id","v2InputboxSubmitBox"),this._elementSubmitBox.setAttribute("class","v2-inputbox-submit-box"),this._elementSubmitBtn=document.createElement("input"),this._sendIcon&&(this._elementSubmitBtn=document.createElement("button"),this._elementSendIcon.style.setProperty("fill",this._submitTextColor),this._elementSubmitBtn.appendChild(this._elementSendIcon)),this._elementSubmitBtn.setAttribute("id","v2InputBoxSubmitBtn"),this._elementSubmitBtn.setAttribute("type","button"),this._elementSubmitBtn.setAttribute("value",this._inputButtonValue),this._elementSubmitBtn.style.setProperty("color",this._submitTextColor),this._elementSubmitBtn.style.setProperty("background",this._submitBgColor),o.clickOrSimilarEvent(this._elementSubmitBtn,(function(){n._clickSubmitBtn()}),(function(){}),this.elementChatSend),this._elementSubmitBox.appendChild(this._elementSubmitBtn),this.elementChatSend.appendChild(this._elementSubmitBox),this._elementBottom=document.createElement("div"),this._elementBottom.setAttribute("id","v2InputBoxBottom"),this._poweredByFlag){var r=document.createElement("a"),l=document.createElement("p"),c=document.createTextNode("Powered by"),d=document.createElement("img");d.alt="UserLocal",d.src=this._siteIn&&!this._mobileFlag?this._currentUrl+"/img/logo_black_176.png":this._currentUrl+"/img/logo_black.png",this._mobileFlag||(r.href="https://chatbot.userlocal.jp",r.target="_blank"),l.appendChild(c),r.appendChild(l),r.appendChild(d),this.elementChatSend.classList.add("powered-by"),this._elementBottom.appendChild(r)}this.elementChatSend.appendChild(this._elementBottom),this._displayInputBoxFlag||this.hideInput(),this.initInputBoxHeight=this.getInputBoxHeight("init")}return i(e,[{key:"getElement",value:function(){return this.elementChatSend}},{key:"getElementSend",value:function(){return this.elementSendInput}},{key:"getElementSuggest",value:function(){return this.elementSuggest}},{key:"getElementImageBtn",value:function(){return this.elementImageBtn}},{key:"getHeight",value:function(){return this.isInputShown()?this.getInputBoxHeight("init")+this.getPaddingBottom()+8:this.getPaddingBottom()}},{key:"getOffsetHeight",value:function(){return this.isInputShown()?this.elementChatSend.offsetHeight-1:this.getPaddingBottom()}},{key:"getInputBoxHeight",value:function(e){if(!this.isInputShown())return 0;var t=parseInt("24px"),n=parseInt("16px"),i=this._mobileFlag?1:2,o=this.elementSendInput.style.height;this.setInputBoxHeight(this.initInputBoxHeight);var s=this.elementSendInput.scrollHeight;this.setInputBoxHeight(o);var a=e?i:(s-n)/t;return t*((a=(a=a<i?i:a)<5?a:5)-1)+42}},{key:"getPaddingBottom",value:function(){return this._poweredByFlag?parseInt("26px"):this.isInputShown()?parseInt("8px"):parseInt("0px")}},{key:"getSendInputFocusFlag",value:function(){return this._sendInputFocusFlag}},{key:"getInputType",value:function(){return"newline"}},{key:"changeOperatorMode",value:function(){this.elementImageBtn.classList.remove("hidden"),this._elementSubmitBtn.hasAttribute("disabled")&&(this._elementSubmitBtn.removeAttribute("disabled"),this._elementSubmitBtn.style.setProperty("cursor","pointer"),this._elementSubmitBtn.style.setProperty("background",this._submitBgColor)),this.elementSendInput.hasAttribute("disabled")&&(this.elementSendInput.removeAttribute("disabled"),this.elementSendInput.setAttribute("placeholder",this._inputPlaceholder),this.elementSendInput.style.setProperty("background",this._inputBgColor)),this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.add("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.add("hidden"),this._displayImageBtn||(this.elementSendInput.style.paddingLeft="12px")),this._setSuggestDisplayFlag(!1)}},{key:"changeUnOperatorMode",value:function(){this.elementImageBtn.classList.add("hidden"),this._displayImageBtn||(this.elementSendInput.style.paddingLeft="6px"),this._setSuggestDisplayFlag(!0)}},{key:"changeGptMode",value:function(){this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.add("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.add("hidden"),this.elementSendInput.style.paddingLeft="12px"),this._operatorFlag&&this.elementImageBtn.classList.add("hidden"),this._setSuggestDisplayFlag(!1)}},{key:"changeUnGptMode",value:function(){this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.remove("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.remove("hidden"),this.elementSendInput.style.paddingLeft="6px"),this._operatorFlag&&this.elementImageBtn.classList.remove("hidden"),this._setSuggestDisplayFlag(!0)}},{key:"setBtnText",value:function(e){e=e||this._inputButtonValue,this._elementSubmitBtn.setAttribute("value",e)}},{key:"setInputBoxHeight",value:function(e){this.elementChatSend.style.height=parseInt(e)+"px"}},{key:"setPlaceholderText",value:function(e,t){e=e||this._inputPlaceholder,t=t||this._lineBreakPlaceholder,this._mobileFlag||(e+="\n("+t+")"),this.elementSendInput.setAttribute("placeholder",e)}},{key:"setPaddingBottom",value:function(e){this.elementChatSend.style.paddingBottom=(this._poweredByFlag?parseInt("26px"):parseInt("0px"))+e+"px"}},{key:"setBottomStyleBottom",value:function(e){this._elementBottom.style.bottom=e}},{key:"enableInputForm",value:function(e){e=e||this._inputPlaceholder,this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.remove("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.remove("hidden"),this._elementSendBox.style.marginLeft=""),this.elementSendInput.style.setProperty("background-color",this._inputBgColor),this.elementSendInput.setAttribute("placeholder",e),this.elementSendInput.hasAttribute("disabled")&&this.elementSendInput.removeAttribute("disabled"),this._elementSubmitBtn.style.setProperty("background",this._submitBgColor),this._elementSubmitBtn.style.setProperty("cursor","pointer"),this._sendIcon?this._elementSendIcon.style.setProperty("fill",this._submitTextColor):this._elementSubmitBtn.style.setProperty("color",this._submitTextColor),this._elementSubmitBtn.hasAttribute("disabled")&&this._elementSubmitBtn.removeAttribute("disabled")}},{key:"disableInputForm",value:function(e){e=e||"",this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.add("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.add("hidden"),this._elementSendBox.style.marginLeft="8px"),this.elementSendInput.style.setProperty("background-color","#e0e0e0"),this.elementSendInput.setAttribute("placeholder",e),this.elementSendInput.setAttribute("disabled","disabled"),this._elementSubmitBtn.style.setProperty("background","#d0d0d0"),this._elementSubmitBtn.style.setProperty("cursor","auto"),this._sendIcon?this._elementSendIcon.style.setProperty("fill","#bbbbbb"):this._elementSubmitBtn.style.setProperty("color","#bbbbbb"),this._elementSubmitBtn.setAttribute("disabled","disabled")}},{key:"show",value:function(){"none"==this.elementChatSend.style.display&&(this.elementChatSend.style.display="inline-flex"),this._translateBtnFlag&&(this._elementSendBox.style.display="inline-block",this._elementSubmitBox.style.display="inline-block",this.elementChatSend.style.height=this.getInputBoxHeight()+"px",this.elementChatSend.style.paddingTop="8px"),this._displayInputBoxFlag||this.hideInput()}},{key:"isShown",value:function(){return"none"!=this.elementChatSend.style.display}},{key:"showInput",value:function(){if(!this._displayInputBoxFlag)return!1;this._elementSendBox.style.display="inline-block",this._elementSubmitBox.style.display="inline-block",this.elementChatSend.style.height=this.getInputBoxHeight()+"px",this.elementChatSend.style.paddingTop="8px",this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.remove("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.remove("hidden"))}},{key:"scrollInputBoxBottom",value:function(){this.elementSendInput.scrollTop=this.elementSendInput.scrollHeight}},{key:"hide",value:function(){"none"!=this.elementChatSend.style.display&&(this.elementChatSend.style.display="none")}},{key:"hideInput",value:function(){this._elementSendBox.style.display="none",this._elementSubmitBox.style.display="none",this.elementChatSend.style.height=0,this.elementChatSend.style.paddingTop=0,this._siteIn&&(this._menuEnabledFlag?this._elementMenuBtn.classList.add("hidden"):this._reloadBtnFlag&&this._elementReloadBtn.classList.add("hidden"))}},{key:"hideReloadBtn",value:function(){this._elementReloadBtn&&this._elementReloadBtn.classList.add("hidden"),this._elementBottomReloadBtn&&(this._elementBottomReloadBtn.style.display="none")}},{key:"isInputShown",value:function(){return"none"!=this._elementSendBox.style.display}},{key:"_html2dom",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}}]),e}()},791:function(e){"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._siteIn=t.siteIn||!1,this._mobileFlag=t.mobileFlag||!1,this._defaultIconFlag=t.defaultIconFlag||!1,this._modalFlag=t.modalFlag||!1,this._closeIconUse=t.closeIconUse||!1,this._defaultPcIconUrl=t.defaultPcIconUrl||!1,this._pcIconUrl=t.pcIconUrl||"",this._pcIconWidth=t.pcIconWidth||"",this._pcIconHeight=t.pcIconHeight,this._pcIconBalloonStatus=t.pcIconBalloonStatus||!1,this._pcIconBalloonMessage=t.pcIconBalloonMessage||"",this._spIconWidth=t.spIconWidth,this._spIconHeight=t.spIconHeight,this._closeIconSpSize=t.closeIconSpSize,this._spWaitImageOriginSize=t.spWaitImageOriginSize||!1,this._spIconUrl=t.spIconUrl,this._isCustomSizePopupIcon=t.isCustomSizePopupIcon||!1,this._clickIcon=t.clickIcon||function(){},this._clickCloseBtn=t.clickCloseBtn||function(){},this._keyupCloseBtn=t.keyupCloseBtn||function(){},this._loadPcImage=t.loadPcImage||function(){},this._errorPcImage=t.errorPcImage||function(){},this._loadSpImage=t.loadSpImage||function(){},this._errorSpImage=t.errorSpImage||function(){},this._loadIntervalSpImg=t.loadIntervalSpImg||function(){},this._clickBalloonCloseBtn=t.clickBalloonCloseBtn||function(){},this.initImgPopupPcSize=t.initImgPopupPcSize||function(){},this.displayPcPopupIcon=t.displayPcPopupIcon||function(){},this.setPopupIconPosition=t.setPopupIconPosition||function(){},this.hiddenPcPopupIcon=t.hiddenPcPopupIcon||function(){},this.hiddenBalloonElement=t.hiddenBalloonElement||function(){},this.mobilePopupSvg='<svg height="100%" style="enable-background:new 0 0 110 110;" version="1.0" viewBox="0 0 110 110" width="100%" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Artboard"/><g id="Multicolor"><circle cx="55" cy="55" r="55" style="fill:#25B7D3;"/><g><path d="M39,67c0,2.209,1.791,4,4,4h24l12,12V71h4c2.209,0,4-1.791,4-4V35c0-2.209-1.791-4-4-4H43    c-2.209,0-4,1.791-4,4V67z" style="fill:#6FDAF1;"/><path d="M71,59c0,2.209-1.791,4-4,4H43L31,75V63h-4c-2.209,0-4-1.791-4-4V27c0-2.209,1.791-4,4-4h40    c2.209,0,4,1.791,4,4V59z" style="fill:#F0F1F1;"/><path d="M70.335,24.798C69.62,23.716,68.395,23,67,23H27c-2.209,0-4,1.791-4,4v32c0,2.209,1.791,4,4,4h4    v1.134L70.335,24.798z" style="fill:#FFFFFF;"/><circle cx="35" cy="43" r="4" style="fill:#21B2D1;"/><circle cx="47" cy="43" r="4" style="fill:#21B2D1;"/><circle cx="59" cy="43" r="4" style="fill:#21B2D1;"/></g></g></svg>',this.iconCloseSvg='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>',this.ballonOpenedFlag=!1;var n=this;if(this._mobileFlag)this._elementContainer=document.createElement("div"),this._elementContainer.setAttribute("id","_ul-widget-btn"),this._elementContainer.style.setProperty("text-align","center"),this._elementContainer.role="button",this._elementContainer.tabIndex=0,this._elementContainer.setAttribute("aria-controls","_ul-widget"),this._elementContainer.setAttribute("aria-expanded",!1),this._elementContainer.addEventListener("click",(function(){n._clickIcon()})),this._elementContainer.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickIcon()})),!this._defaultIconFlag&&this._spIconUrl?(this._elementImgPopupIcon=new Image,this._elementImgPopupIcon.setAttribute("id","_ul-img-popup-icon"),this._elementImgPopupIcon.setAttribute("src",this._spIconUrl),this._elementImgPopupIcon.style.setProperty("width","auto"),this._elementImgPopupIcon.addEventListener("load",(function(e){n._loadSpImage(e)})),this._elementImgPopupIcon.addEventListener("error",(function(){n._errorSpImage()})),this._spWaitImageOriginSize?this._elementImgPopupIcon.style.setProperty("height","auto"):this._elementImgPopupIcon.style.setProperty("height","100%"),this._isCustomSizePopupIcon&&(this._elementImgPopupIcon.style.setProperty("width",this._spIconWidth),this._elementImgPopupIcon.style.setProperty("height",this._spIconHeight)),this._loadIntervalSpImg(),this._elementContainer.appendChild(this._elementImgPopupIcon)):this._elementContainer.appendChild(this._html2dom(this.mobilePopupSvg));else{if(!this._pcIconUrl&&!this._modalFlag)return!1;this._elementContainer=new Image,this._elementContainer.setAttribute("id","popupIcon"),this._elementContainer.setAttribute("src",this._pcIconUrl||this._defaultPcIconUrl),this._elementContainer.role="button",this._elementContainer.tabIndex=0,this._elementContainer.setAttribute("aria-controls","_ul-widget"),this._elementContainer.setAttribute("aria-expanded",!1),this._elementContainer.addEventListener("click",(function(){n._clickIcon()})),this._elementContainer.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickIcon()})),this._isCustomSizePopupIcon&&(this._elementContainer.style.setProperty("width",this._pcIconWidth),this._elementContainer.style.setProperty("height",this._pcIconHeight)),this._elementContainer.style.setProperty("display","none"),this._elementContainer.addEventListener("load",(function(e){n._loadPcImage(e)})),this._elementContainer.addEventListener("error",(function(){n._errorPcImage()}))}var i=""===n._spIconUrl||36!=n._closeIconSpSize?"default-icon":"";this._mobileFlag||!this._pcIconUrl&&!this._modalFlag||(i="use-popup-icon"),this._elementCloseBtn=document.createElement("div"),this._elementCloseBtn.setAttribute("id","closeBtn"),this._elementCloseBtn.setAttribute("class",i),this._elementCloseBtn.setAttribute("role","button"),this._elementCloseBtn.setAttribute("tabindex",0),this._elementCloseBtn.addEventListener("click",(function(e){n._clickCloseBtn()})),this._elementCloseBtn.addEventListener("keyup",(function(e){n._keyupCloseBtn(e)})),this._elementCloseBtn.appendChild(this._html2dom(this.iconCloseSvg)),this._pcIconBalloonStatus&&(this.ballonOpenedFlag=!0,this._elementPopupBalloon=document.createElement("div"),this._elementPopupBalloon.setAttribute("id","popupBalloon"),this._elementPopupBalloon.style.visibility="hidden",this._elementPopupBalloon.role="button",this._elementPopupBalloon.tabIndex=0,this._elementPopupBalloon.addEventListener("click",(function(e){n._clickIcon()})),this._elementPopupBalloon.addEventListener("keyup",(function(e){13===e.keyCode&&n._clickIcon()})),this._elementPopupBalloonMessage=document.createElement("div"),this._elementPopupBalloonMessage.setAttribute("id","popupBalloonMessage"),this._elementPopupBalloonMessage.innerHTML=this._pcIconBalloonMessage,this._elementPopupBalloonCloseBtn=document.createElement("div"),this._elementPopupBalloonCloseBtn.setAttribute("id","popupBalloonCloseBtn"),this._closeIconUse||(this._elementPopupBalloonCloseBtn.style.display="block"),this._elementPopupBalloonCloseBtn.appendChild(this._html2dom(this.iconCloseSvg)),this._elementPopupBalloonCloseBtn.role="button",this._elementPopupBalloonCloseBtn.tabIndex=0,this._elementPopupBalloonCloseBtn.addEventListener("click",(function(e){e.stopPropagation(),n._clickBalloonCloseBtn()})),this._elementPopupBalloonCloseBtn.addEventListener("keyup",(function(e){e.stopPropagation(),13===e.keyCode&&n._clickBalloonCloseBtn()})),this._elementPopupBalloonMessage.appendChild(this._elementPopupBalloonCloseBtn),this._elementPopupBalloon.appendChild(this._elementPopupBalloonMessage))}return t(e,[{key:"getCloseBtnElement",value:function(){return this._elementCloseBtn}},{key:"getPopupBalloonElement",value:function(){return this._elementPopupBalloon}},{key:"getElement",value:function(){return this._elementContainer}},{key:"getImgElement",value:function(){return this._mobileFlag?this._elementImgPopupIcon:this._elementContainer}},{key:"getType",value:function(){return"image"}},{key:"show",value:function(){var e=this;this.getImgElement().style.setProperty("display","block"),this._elementCloseBtn&&this._elementCloseBtn.classList.remove("hidden"),this._elementPopupBalloon&&setTimeout((function(){e._elementPopupBalloon.style.visibility="visible"}),550),this.displayPcPopupIcon()}},{key:"hidden",value:function(){this.getImgElement().style.setProperty("display","none"),this._elementCloseBtn&&this._elementCloseBtn.classList.add("hidden"),this.hiddenBalloonElement(),this.hiddenPcPopupIcon()}},{key:"setBalloonOpenedFlag",value:function(e){this.ballonOpenedFlag=e}},{key:"_html2dom",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}}]),e}()},332:function(e){"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._keywords=t.keywords||[],this._sendKeywords=t.sendKeywords||function(){},this._restartTalk=t.restartTalk||function(){},this.controlSlideBtn=t.controlSlideBtn||function(){},this._elementContainer=document.createElement("div"),this._elementContainer.setAttribute("id","v2QuickSearchMenu"),this._elementMenuItems=document.createElement("div"),this._elementMenuItems.setAttribute("id","v2QuickSearchMenuItems");var n=this;this._keywords.forEach((function(e){var t=document.createElement("div");t.setAttribute("class","quick-search-menu-item");var i=e.match(/^\{\{\[(.*)\]\([#|＃]restart\)\}\}$/);i?(t.textContent=i[1],t.addEventListener("click",(function(){n._restartTalk()}))):(t.textContent=e,t.addEventListener("click",(function(){n._sendKeywords(e)}))),n._elementMenuItems.appendChild(t)}));var i=null;this._elementMenuItems.addEventListener("scroll",(function(e){clearTimeout(i),i=setTimeout(n.controlSlideBtn,250)})),n._elementContainer.appendChild(n._elementMenuItems),n._slideNextBtn=document.createElement("div"),n._slideNextBtn.classList.add("slide-btn"),n._slideNextBtn.classList.add("next"),n._slideNextBtn.classList.add("hidden"),n._slideNextBtn.addEventListener("click",(function(){n._elementMenuItems.scrollLeft=n._elementMenuItems.scrollLeft+200}));var o=document.createElement("span");o.classList.add("slide-icon");var s=document.createElement("span");s.classList.add("slide-arrow"),s.classList.add("next-slide-arrow"),o.appendChild(s),n._slideNextBtn.appendChild(o),n._elementContainer.appendChild(n._slideNextBtn),n._slidePrevBtn=document.createElement("div"),n._slidePrevBtn.classList.add("slide-btn"),n._slidePrevBtn.classList.add("prev"),n._slidePrevBtn.classList.add("hidden"),n._slidePrevBtn.addEventListener("click",(function(){n._elementMenuItems.scrollLeft=n._elementMenuItems.scrollLeft-200}));var a=document.createElement("span");a.classList.add("slide-icon");var r=document.createElement("span");r.classList.add("slide-arrow"),r.classList.add("prev-slide-arrow"),a.appendChild(r),n._slidePrevBtn.appendChild(a),n._elementContainer.appendChild(n._slidePrevBtn)}return t(e,[{key:"show",value:function(){"none"===this._elementContainer.style.display&&(this._elementContainer.style.display="flex"),this.controlSlideBtn()}},{key:"hide",value:function(){"none"!=this._elementContainer.style.display&&(this._elementContainer.style.display="none")}},{key:"getHeight",value:function(){return parseInt("50px")}},{key:"getElement",value:function(){return this._elementContainer}},{key:"showNextBtn",value:function(){this._slideNextBtn.classList.remove("hidden")}},{key:"showPrevBtn",value:function(){this._slidePrevBtn.classList.remove("hidden")}},{key:"hideNextBtn",value:function(){this._slideNextBtn.classList.add("hidden")}},{key:"hidePrevBtn",value:function(){this._slidePrevBtn.classList.add("hidden")}},{key:"getMenuElement",value:function(){return this._elementMenuItems}},{key:"isShown",value:function(){return"none"!==this._elementContainer.style.display}},{key:"_html2dom",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}}]),e}()},110:function(e,t){"use strict";t.X=function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}},445:function(e,t,n){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.twitterText=n(102),this.openLinkNewTab=0!=e.openLinkNewTab,this.openLinkNoReferrer=e.openLinkNoReferrer||!1,this.mobileFlag=e.mobileFlag||!1,this.browserChrome=e.browserChrome||!1,this.replaceText=[]}i.prototype.backupText=function(e){var t="{{$$"+this.replaceText.length+"}}";return this.replaceText[this.replaceText.length]=e,t},i.prototype.backupTextDecode=function(e){var t=this;e=(e=e.replace(/\{\{\$\$/g,"")).replace(/\}\}/g,"");var n=t.replaceText[e];return(n=(n=n.replace(/\{\{/g,"")).replace(/\}\}/g,"")).replace(/\[(.*)\]\((.*)\)/g,(function(e,n,i){var o=t.openLinkNewTab?"_blank":"_parent",s=t.openLinkNoReferrer?"noreferrer nofollow noopener":"nofollow noopener";return t.createElementChatATag(n,i,o,s,"").outerHTML}))},i.prototype.convertToBotChatText=function(e){var t=e;return e=this.unescapeHTML(e),e=this.replaceSymbolToTag(e),t!==(e=this.escapeHTML(e))&&(e=this.unescapeTextLink(e),e=this.unescapeDecorates(e),e=this.unescapeImages(e),e=this.unescapeVideos(e),e=this.unescapeIframes(e),e=this.unescapeTable(e),e=this.unescapeBreaks(e),e=this.unescapeAmpersand(e)),e},i.prototype.convertToUserChatText=function(e){var t=e;return e=this.unescapeHTML(e),e=(e=this.replaceBreakSymbolToTag(e)).replace(/<span(.*?)>(.*?)<\/span>/g,(function(e,t,n){return n})),t!==(e=this.escapeHTML(e))&&(e=this.unescapeBreaks(e)),e},i.prototype.convertToSelectionText=function(e){var t=e;return e=this.unescapeHTML(e),e=this.replaceDecoratesToTag(e),e=this.replaceBreakSymbolToTag(e),t!==(e=this.escapeHTML(e))&&(e=this.unescapeDecorates(e),e=this.unescapeBreaks(e)),e},i.prototype.convertToNewLineUserChatText=function(e){var t=e;return e=this.unescapeHTML(e),e=(e=(e=this.replaceBreakSymbolToTag(e)).replace(/<span(.*?)>(.*?)<\/span>/g,(function(e,t,n){return n}))).replace(/\n/g,"<br>"),t!==(e=this.escapeHTML(e))&&(e=this.unescapeBreaks(e)),e},i.prototype.convertToSafeBreak=function(e){return e=this.replaceNewLineToTag(e),e=this.unescapeHTML(e),e=this.escapeHTML(e),this.unescapeBreaks(e)},i.prototype.convertToRelatedFaqsText=function(e){return e=this.replaceBrTag(e),e=this.removeImgTag(e),e=this.removeVideoTag(e),e=this.removeIframeTag(e),e=this.removeTableTag(e),this.convertToBotChatText(e)},i.prototype.createElementChatATag=function(e,t,n,i,o){e=e||"",n=n||"_blank",i=i||"nofollow noopener",o=o||"";var s=(t=t||"#").match(/^[#|＃][q|ｑ][=|＝](.+)/);if(s){var a=s[1].split("&id="),r=this.replaceBreakSymbolToTag(a[0]);if(a[1])var l=a[1];var c=this.html2dom('<div data-q="'+r+'">'+e+"</div>"),d=document.createElement("a");return d.setAttribute("href","javascript:void(0)"),d.setAttribute("data-q",c.dataset.q),l&&d.setAttribute("data-sid",l),d.textContent=c.textContent,d}if("#restart"==t){var u=this.html2dom('<div data-restart="1">'+e+"</div>"),p=document.createElement("a");return p.setAttribute("href","javascript:void(0)"),p.setAttribute("data-restart",u.dataset.restart),p.textContent=u.textContent,p}var h=this.html2dom('<a href="'+t+'" target="'+n+'" rel="'+i+'" style="'+o+'">'+e+"</a>"),g=document.createElement("a");return g.setAttribute("target",h.target),g.setAttribute("rel",h.rel),g.setAttribute("href",h.href),g.textContent=h.textContent,g.style.fontSize=h.style.fontSize,g.style.fontWeight=h.style.fontWeight,g.style.color=h.style.color,g.style.backgroundColor=h.style.backgroundColor,g.style.textDecoration=h.style.textDecoration,g.style.fontStyle=h.style.fontStyle,t.toLowerCase().match(/j\s*a\s*v\s*a\s*s\s*c\s*r\s*i\s*p\s*t\s*:/g)&&g.setAttribute("href","#"),t.toLowerCase().match(/^tel:/)&&!this.mobileFlag&&(g.style.setProperty("text-decoration","blink"),g.style.setProperty("cursor","auto"),g.style.setProperty("color","black"),g.setAttribute("onclick","event.preventDefault();")),t.toLowerCase().match(/^tel:/)&&this.mobileFlag&&this.browserChrome&&g.setAttribute("target",""),g},i.prototype.escapeHTML=function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML},i.prototype.extractDecorateStyle=function(e){var t=this,n=this.html2dom(e);if(!n)return e;if("IFRAME"===n.tagName){var i=(n.getAttribute("src")||"").match(new RegExp(["https?://www.youtube.com/embed/.*","https?://www.google.com/maps/embed\\?.*"].join("|")));if(!i)return"";var o=document.createElement("div");o.style.width=n.getAttribute("width")+"px",o.style.maxWidth="100%";var s=document.createElement("div");s.style.position="relative",s.style.width="100%",s.style.height="0",s.style.paddingTop="56.25%";var a=document.createElement("iframe");return a.setAttribute("src",i),a.setAttribute("frameborder","0"),n.getAttribute("width")&&a.setAttribute("width",n.getAttribute("width")),n.hasAttribute("allowfullscreen")&&a.setAttribute("allowfullscreen",""),a.style.position="absolute",a.style.width="100%",a.style.height="100%",a.style.top="0",a.style.left="0",a.allow="autoplay;",s.appendChild(a),o.appendChild(s),o.outerHTML}if("SPAN"===n.tagName){var r=document.createElement("span");return r.textContent=n.textContent,r.style.fontSize=n.style.fontSize,r.style.fontWeight=n.style.fontWeight,r.style.color=n.style.color,r.style.backgroundColor=n.style.backgroundColor,r.style.textDecoration=n.style.textDecoration,r.style.fontStyle=n.style.fontStyle,r.outerHTML}if("TABLE"===n.tagName){var l=document.createElement("table");return l.classList.add("table"),l.classList.add("table-bordered"),l.style.setProperty("margin-bottom","0px"),["width","height","color","backgroundColor","text-align"].forEach((function(e){l.style[e]=n.style[e]})),["table-striped"].forEach((function(e){n.classList.contains(e)&&l.classList.add(e)})),["thead","tbody","tfoot"].forEach((function(e){var i=n.getElementsByTagName(e)[0];if(i){var o=t.extractTableSectionsStyle(i);l.appendChild(o)}else if("tbody"==e){var s=document.createElement("tbody"),a=n.getElementsByTagName("tr");a.length>0&&(s.appendChild(a),o=t.extractTableSectionsStyle(s),l.appendChild(o))}})),l.outerHTML}return e},i.prototype.extractTableSectionsStyle=function(e){var t=e.tagName.toLowerCase(),n=document.createElement(t);["width","height","color","backgroundColor","text-align"].forEach((function(t){n.style[t]=e.style[t]}));var i=e.getElementsByTagName("tr");return Array.prototype.forEach.call(i,function(e){var t=this.extractRowStyle(e);n.appendChild(t)}.bind(this)),n},i.prototype.extractRowStyle=function(e){var t=document.createElement("tr");return["width","height","color","backgroundColor","text-align"].forEach((function(n){t.style[n]=e.style[n]})),["th","td"].forEach((function(n){var i=e.getElementsByTagName(n);Array.prototype.forEach.call(i,(function(e){var i=document.createElement(n);["width","height","color","backgroundColor","text-align"].forEach((function(t){i.style[t]=e.style[t]})),i.innerHTML=e.innerHTML.replace(/^\|/,""),t.appendChild(i)}))})),t},i.prototype.html2dom=function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild},i.prototype.removeTag=function(e){return e=e.replace(/<br \/>/g,"<br>"),e=this.replaceBreakSymbolToTag(e),(e=this.removeBrTag(e)).replace(/<span.*?>(.+?)<\/span>/g,"$1")},i.prototype.replaceSymbolToTag=function(e){var t=this;this.replaceText=[],e=e.replace(/\{\{(.*?)\}\}/g,(function(e){return e.match(/\{\{\[.*\]\(.*\)\}\}/g)?t.backupText(e):e})),e=this.replaceDecoratesToTag(e),e=this.replaceImagesToTag(e),e=this.replaceVideosToTag(e),e=this.replaceIframesToTag(e),e=this.replaceTableToTag(e),e=this.replaceBreakSymbolToTag(e);var n=this.openLinkNewTab?"_blank":"_parent",i=t.openLinkNoReferrer?"noreferrer nofollow noopener":"nofollow noopener";return e=(e=(e=e.replace(/(href=["'])http/g,(function(e,t){return t+"_h_t_t_p_"}))).replace(/(src=["'])http/g,(function(e,t){return t+"_h_t_t_p_"}))).replace(/(<a(?: .+?)?>)(.*?)(<\/a>)/g,(function(e,t,n,i){return""+t+(n=n.replace(/http/g,"_h_t_t_p_"))+i})),e=(e=this.twitterText.autoLinkUrlsCustom(e,{target:n,rel:i})).replace(/_h_t_t_p_/g,"http"),this.unescapeHTML(e)},i.prototype.replaceBreakSymbolToTag=function(e){return e.replace(/\|/g,"<br>")},i.prototype.replaceDecoratesToTag=function(e){return(e=(e=e.replace(/<spanstyle/g,"<span style")).replace(/<span style=(.*?)>/g,(function(e,t){return"<span style="+t.replace(/'|“|”/g,'"')+">"}))).replace(/<span(.*?)>(.*?)<\/span>/g,function(e){return this.extractDecorateStyle(e)}.bind(this))},i.prototype.replaceImagesToTag=function(e){return e.replace(/<img(.*?)>/g,function(e,t){var n=document.createElement("img"),i=t.match(/src\s*=\s*["'](.*?)["']/),o=t.match(/width\s*=\s*["'](.*?)["']/),s=t.match(/style\s*=\s*["'](.*?)["']/),a=t.match(/alt\s*=\s*["'](.*?)["']/);if(i&&(n.src=i[1]),o&&n.setAttribute("width",o[1]),s){var r=this.html2dom("<div>");r.setAttribute("style",s[1]),n.style.width=r.style.width}return n.alt=a?a[1]:"",n.style.maxWidth="100%",n.style.padding="10px 0",n.style.display="block",n.outerHTML}.bind(this))},i.prototype.replaceVideosToTag=function(e){return e.replace(/<video(.*?)>(.*?)<\/video>/g,function(e,t){var n=document.createElement("video"),i=t.match(/src\s*=\s*["'](.*?)["']/),o=t.match(/width\s*=\s*["'](.*?)["']/),s=t.match(/style\s*=\s*["'](.*?)["']/);if(i&&(n.src=i[1]),o&&n.setAttribute("width",o[1]),s){var a=this.html2dom("<div>");a.setAttribute("style",s[1]),n.style.width=a.style.width}return n.setAttribute("controls",!0),n.setAttribute("playsinline",!0),n.setAttribute("preload","metadata"),n.setAttribute("controlsList","nodownload"),n.style.maxWidth="100%",n.style.padding="10px 0",n.style.display="block",n.outerHTML}.bind(this))},i.prototype.replaceIframesToTag=function(e){return e.replace(/<iframe(.*?)>(.*?)<\/iframe>/g,function(e){return this.extractDecorateStyle(e)}.bind(this))},i.prototype.replaceTableToTag=function(e){return e.replace(/<table(.*?)>([\s\S]*?)<\/table>/g,function(e){return this.extractDecorateStyle(e)}.bind(this))},i.prototype.replaceNewLineToTag=function(e){return e.replace(/\n|\r|\r\n/g,"<br>")},i.prototype.removeImgTag=function(e){return e.replace(/<img[^>]*?>/g,"")},i.prototype.removeVideoTag=function(e){return e.replace(/<video .*><\/video>/g,"")},i.prototype.removeIframeTag=function(e){return e.replace(/<iframe .*><\/iframe>/g,"")},i.prototype.removeTableTag=function(e){return e.replace(/<table.*?>[\s\S]*?<\/table>/g,"")},i.prototype.removeBrTag=function(e){return e.replace(/<br>/g,"")},i.prototype.replaceBrTag=function(e){return e.replace(/<br>/g,"|")},i.prototype.unescapeHTML=function(e){var t=document.createElement("div");return t.innerHTML=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#13;").replace(/\n/g,"&#10;"),t.textContent||t.innerText},i.prototype.unescapeTextLink=function(e){var t=this;return(e=e.replace(/&lt;a\s.*?href=["|'](.*?)["|'].*?&gt;(.*?)&lt;\/a&gt;/g,(function(e,n,i){var o=t.openLinkNewTab?"_blank":"_parent",s=t.openLinkNoReferrer?"noreferrer nofollow noopener":"nofollow noopener",a=e.match(/&lt;a\s.*?style=["|'](.*?)["|'].*?&gt;.*?&lt;\/a&gt;/),r=a?a[1]:"";return t.createElementChatATag(i,n,o,s,r).outerHTML}))).replace(/\{\{(.*?)\}\}/g,(function(e,n){return e.match(/\{\{\$\$[0-9]+\}\}/)?t.backupTextDecode(e):n}))},i.prototype.unescapeDecorates=function(e){var t=this;return e.replace(/&lt;span(.*?)&gt;(.*?)&lt;\/span&gt;/g,(function(e,n,i){var o="<span"+n+">"+i+"</span>";return t.html2dom(o)?o:e}))},i.prototype.unescapeImages=function(e){return e.replace(/&lt;img(.*?)&gt;(.*?)/g,(function(e,t){return"<img"+t+">"}))},i.prototype.unescapeVideos=function(e){return e.replace(/&lt;video(.*?)&gt;(.*?)lt;\/video&gt;/g,(function(e,t){return"<video"+t+"></video>"}))},i.prototype.unescapeIframes=function(e){var t=this;return e.replace(/&lt;div(.*?)&gt;&lt;div(.*?)&gt;&lt;iframe(.*?)&gt;&lt;\/iframe&gt;&lt;\/div&gt;&lt;\/div&gt;/g,(function(e,n,i,o){var s="<div"+n+"><div"+i+"><iframe"+o+"></iframe></div></div>";return t.html2dom(s)?s:e}))},i.prototype.unescapeBreaks=function(e){return e.replace(/&lt;br(.*?)&gt;/g,(function(e,t){return"<br>"}))},i.prototype.unescapeAmpersand=function(e){return e.replace(/&amp;/g,"&")},i.prototype.unescapeTable=function(e){return e.replace(/&lt;table(.*?)&gt;(.*?)&lt;\/table&gt;/g,function(e,t,n){var i='<div class="table-container"><table'+t+">"+n+"</table></div>";return["thead","tbody","tfoot","tr","th","td"].forEach((function(e){var t=new RegExp("&lt;"+e+"(.*?)&gt;(.*?)&lt;/"+e+"&gt;","g");i=i.replace(t,(function(t,n,i){return"<"+e+n+">"+i+"</"+e+">"}))})),this.html2dom(i)?i:e}.bind(this))},e.exports=i},9:function(e,t){"use strict";t.blackOrWhite=function(e){return(299*parseInt(e.substr(1,2),16)+587*parseInt(e.substr(3,2),16)+114*parseInt(e.substr(5,2),16))/1e3<128?"#ffffff":"#333333"},t.copyObject=function(e){return Object.getOwnPropertyNames(e).reduce((function(t,n){var i=Object.getOwnPropertyDescriptor(e,n);return Object.defineProperty(t,n,i),t}),{})},t.checkTimezone=function(e,t){if((t*=-1)<(e*=-1)){var n=t;t=e,e=n}var i=(new Date).getTimezoneOffset();return e<=i&&i<=t},t.dateFormat=function(e,t){var n=new Date;if(e.toLocaleString().split(" ")[0]==n.toLocaleString().split(" ")[0])return t?"今日":"today";var i=e.getFullYear(),o=e.getMonth()+1,s=e.getDate(),a=e.getDay(),r=t?["日","月","火","水","木","金","土"]:["sun","mon","tue","wed","thu","fri","sat"];return i<n.getFullYear()?i+"/"+o+"/"+s+" ("+r[a]+")":o+"/"+s+" ("+r[a]+")"},t.getDevice=function(){var e=navigator.userAgent,t="pc";return e.indexOf("iPhone")>0||e.indexOf("iPod")>0||e.indexOf("Android")>0&&e.indexOf("Mobile")>0?t="sp":(e.indexOf("iPad")>0||e.indexOf("Android")>0)&&(t="tab"),t},t.getClosestElement=function(e,t,n){var i=n.querySelectorAll(t),o=e.parentElement,s=0,a=i.length;if("string"!=typeof t||""===t)return o;for(;o;){for(s=0;s<a;s++)if(i[s]===o)return o;o=o.parentElement}return null},t.extractText=function(e){return e?(new DOMParser).parseFromString(e,"text/html").body.textContent:""},t.truncate=function(e,t){return e.length<=t?e:e.substr(0,t)+"..."}},973:function(e,t,n){"use strict";var i;i="undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},e.exports=i},102:function(e,t){"use strict";var n,i,o;!function(){if(null==s)var s={};s.txt={},s.txt.regexen={};var a={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};function r(e,t){return t=t||"","string"!=typeof e&&(e.global&&t.indexOf("g")<0&&(t+="g"),e.ignoreCase&&t.indexOf("i")<0&&(t+="i"),e.multiline&&t.indexOf("m")<0&&(t+="m"),e=e.source),new RegExp(e.replace(/#\{(\w+)\}/g,(function(e,t){var n=s.txt.regexen[t]||"";return"string"!=typeof n&&(n=n.source),n})),t)}function l(e,t){return e.replace(/#\{(\w+)\}/g,(function(e,n){return t[n]||""}))}s.txt.htmlEscape=function(e){return e&&e.replace(/[&"'><]/g,(function(e){return a[e]}))},s.txt.regexSupplant=r,s.txt.stringSupplant=l,s.txt.regexen.spaces_group=/\x09-\x0D\x20\x85\xA0\u1680\u180E\u2000-\u200A\u2028\u2029\u202F\u205F\u3000/,s.txt.regexen.spaces=r(/[#{spaces_group}]/),s.txt.regexen.invalid_chars_group=/\uFFFE\uFEFF\uFFFF\u202A-\u202E/,s.txt.regexen.invalid_chars=r(/[#{invalid_chars_group}]/),s.txt.regexen.punct=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~\$/,s.txt.regexen.rtl_chars=/[\u0600-\u06FF]|[\u0750-\u077F]|[\u0590-\u05FF]|[\uFE70-\uFEFF]/gm,s.txt.regexen.non_bmp_code_pairs=/[\uD800-\uDBFF][\uDC00-\uDFFF]/gm,s.txt.regexen.latinAccentChars=/\xC0-\xD6\xD8-\xF6\xF8-\xFF\u0100-\u024F\u0253\u0254\u0256\u0257\u0259\u025B\u0263\u0268\u026F\u0272\u0289\u028B\u02BB\u0300-\u036F\u1E00-\u1EFF/,s.txt.regexen.bmpLetterAndMarks=/A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u065f\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06ef\u06fa-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07ca-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09f0\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a70-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u103f\u1050-\u108f\u109a-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16f1-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u180b-\u180d\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f\u1aa7\u1ab0-\u1abe\u1b00-\u1b4b\u1b6b-\u1b73\u1b80-\u1baf\u1bba-\u1bf3\u1c00-\u1c37\u1c4d-\u1c4f\u1c5a-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u20d0-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2183\u2184\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005\u3006\u302a-\u302f\u3031-\u3035\u303b\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua672\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6e5\ua6f0\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8e0-\ua8f7\ua8fb\ua90a-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf\ua9e0-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf870-\uf87f\uf882\uf884-\uf89f\uf8b8\uf8c1-\uf8d6\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc/,s.txt.regexen.astralLetterAndMarks=/\ud800[\udc00-\udc0b\udc0d-\udc26\udc28-\udc3a\udc3c\udc3d\udc3f-\udc4d\udc50-\udc5d\udc80-\udcfa\uddfd\ude80-\ude9c\udea0-\uded0\udee0\udf00-\udf1f\udf30-\udf40\udf42-\udf49\udf50-\udf7a\udf80-\udf9d\udfa0-\udfc3\udfc8-\udfcf]|\ud801[\udc00-\udc9d\udd00-\udd27\udd30-\udd63\ude00-\udf36\udf40-\udf55\udf60-\udf67]|\ud802[\udc00-\udc05\udc08\udc0a-\udc35\udc37\udc38\udc3c\udc3f-\udc55\udc60-\udc76\udc80-\udc9e\udd00-\udd15\udd20-\udd39\udd80-\uddb7\uddbe\uddbf\ude00-\ude03\ude05\ude06\ude0c-\ude13\ude15-\ude17\ude19-\ude33\ude38-\ude3a\ude3f\ude60-\ude7c\ude80-\ude9c\udec0-\udec7\udec9-\udee6\udf00-\udf35\udf40-\udf55\udf60-\udf72\udf80-\udf91]|\ud803[\udc00-\udc48]|\ud804[\udc00-\udc46\udc7f-\udcba\udcd0-\udce8\udd00-\udd34\udd50-\udd73\udd76\udd80-\uddc4\uddda\ude00-\ude11\ude13-\ude37\udeb0-\udeea\udf01-\udf03\udf05-\udf0c\udf0f\udf10\udf13-\udf28\udf2a-\udf30\udf32\udf33\udf35-\udf39\udf3c-\udf44\udf47\udf48\udf4b-\udf4d\udf57\udf5d-\udf63\udf66-\udf6c\udf70-\udf74]|\ud805[\udc80-\udcc5\udcc7\udd80-\uddb5\uddb8-\uddc0\ude00-\ude40\ude44\ude80-\udeb7]|\ud806[\udca0-\udcdf\udcff\udec0-\udef8]|\ud808[\udc00-\udf98]|\ud80c[\udc00-\udfff]|\ud80d[\udc00-\udc2e]|\ud81a[\udc00-\ude38\ude40-\ude5e\uded0-\udeed\udef0-\udef4\udf00-\udf36\udf40-\udf43\udf63-\udf77\udf7d-\udf8f]|\ud81b[\udf00-\udf44\udf50-\udf7e\udf8f-\udf9f]|\ud82c[\udc00\udc01]|\ud82f[\udc00-\udc6a\udc70-\udc7c\udc80-\udc88\udc90-\udc99\udc9d\udc9e]|\ud834[\udd65-\udd69\udd6d-\udd72\udd7b-\udd82\udd85-\udd8b\uddaa-\uddad\ude42-\ude44]|\ud835[\udc00-\udc54\udc56-\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd1e-\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd52-\udea5\udea8-\udec0\udec2-\udeda\udedc-\udefa\udefc-\udf14\udf16-\udf34\udf36-\udf4e\udf50-\udf6e\udf70-\udf88\udf8a-\udfa8\udfaa-\udfc2\udfc4-\udfcb]|\ud83a[\udc00-\udcc4\udcd0-\udcd6]|\ud83b[\ude00-\ude03\ude05-\ude1f\ude21\ude22\ude24\ude27\ude29-\ude32\ude34-\ude37\ude39\ude3b\ude42\ude47\ude49\ude4b\ude4d-\ude4f\ude51\ude52\ude54\ude57\ude59\ude5b\ude5d\ude5f\ude61\ude62\ude64\ude67-\ude6a\ude6c-\ude72\ude74-\ude77\ude79-\ude7c\ude7e\ude80-\ude89\ude8b-\ude9b\udea1-\udea3\udea5-\udea9\udeab-\udebb]|\ud840[\udc00-\udfff]|\ud841[\udc00-\udfff]|\ud842[\udc00-\udfff]|\ud843[\udc00-\udfff]|\ud844[\udc00-\udfff]|\ud845[\udc00-\udfff]|\ud846[\udc00-\udfff]|\ud847[\udc00-\udfff]|\ud848[\udc00-\udfff]|\ud849[\udc00-\udfff]|\ud84a[\udc00-\udfff]|\ud84b[\udc00-\udfff]|\ud84c[\udc00-\udfff]|\ud84d[\udc00-\udfff]|\ud84e[\udc00-\udfff]|\ud84f[\udc00-\udfff]|\ud850[\udc00-\udfff]|\ud851[\udc00-\udfff]|\ud852[\udc00-\udfff]|\ud853[\udc00-\udfff]|\ud854[\udc00-\udfff]|\ud855[\udc00-\udfff]|\ud856[\udc00-\udfff]|\ud857[\udc00-\udfff]|\ud858[\udc00-\udfff]|\ud859[\udc00-\udfff]|\ud85a[\udc00-\udfff]|\ud85b[\udc00-\udfff]|\ud85c[\udc00-\udfff]|\ud85d[\udc00-\udfff]|\ud85e[\udc00-\udfff]|\ud85f[\udc00-\udfff]|\ud860[\udc00-\udfff]|\ud861[\udc00-\udfff]|\ud862[\udc00-\udfff]|\ud863[\udc00-\udfff]|\ud864[\udc00-\udfff]|\ud865[\udc00-\udfff]|\ud866[\udc00-\udfff]|\ud867[\udc00-\udfff]|\ud868[\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|\ud86a[\udc00-\udfff]|\ud86b[\udc00-\udfff]|\ud86c[\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d]|\ud87e[\udc00-\ude1d]|\udb40[\udd00-\uddef]/,s.txt.regexen.bmpNumerals=/0-9\u0660-\u0669\u06f0-\u06f9\u07c0-\u07c9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0de6-\u0def\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\u1946-\u194f\u19d0-\u19d9\u1a80-\u1a89\u1a90-\u1a99\u1b50-\u1b59\u1bb0-\u1bb9\u1c40-\u1c49\u1c50-\u1c59\ua620-\ua629\ua8d0-\ua8d9\ua900-\ua909\ua9d0-\ua9d9\ua9f0-\ua9f9\uaa50-\uaa59\uabf0-\uabf9\uff10-\uff19/,s.txt.regexen.astralNumerals=/\ud801[\udca0-\udca9]|\ud804[\udc66-\udc6f\udcf0-\udcf9\udd36-\udd3f\uddd0-\uddd9\udef0-\udef9]|\ud805[\udcd0-\udcd9\ude50-\ude59\udec0-\udec9]|\ud806[\udce0-\udce9]|\ud81a[\ude60-\ude69\udf50-\udf59]|\ud835[\udfce-\udfff]/,s.txt.regexen.hashtagSpecialChars=/_\u200c\u200d\ua67e\u05be\u05f3\u05f4\uff5e\u301c\u309b\u309c\u30a0\u30fb\u3003\u0f0b\u0f0c\xb7/,s.txt.regexen.hashSigns=/[#＃]/,s.txt.regexen.hashtagAlpha=r(/(?:[#{bmpLetterAndMarks}]|(?=#{non_bmp_code_pairs})(?:#{astralLetterAndMarks}))/),s.txt.regexen.hashtagAlphaNumeric=r(/(?:[#{bmpLetterAndMarks}#{bmpNumerals}#{hashtagSpecialChars}]|(?=#{non_bmp_code_pairs})(?:#{astralLetterAndMarks}|#{astralNumerals}))/),s.txt.regexen.endHashtagMatch=r(/^(?:#{hashSigns}|:\/\/)/),s.txt.regexen.codePoint=/(?:[^\uD800-\uDFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF])/,s.txt.regexen.hashtagBoundary=r(/(?:^|\uFE0E|\uFE0F|$|(?!#{hashtagAlphaNumeric}|&)#{codePoint})/),s.txt.regexen.validHashtag=r(/(#{hashtagBoundary})(#{hashSigns})(?!\uFE0F|\u20E3)(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi),s.txt.regexen.validMentionPrecedingChars=/(?:^|[^a-zA-Z0-9_!#$%&*@＠]|(?:^|[^a-zA-Z0-9_+~.-])(?:rt|RT|rT|Rt):?)/,s.txt.regexen.atSigns=/[@＠]/,s.txt.regexen.validMentionOrList=r("(#{validMentionPrecedingChars})(#{atSigns})([a-zA-Z0-9_]{1,20})(/[a-zA-Z][a-zA-Z0-9_-]{0,24})?","g"),s.txt.regexen.validReply=r(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/),s.txt.regexen.endMentionMatch=r(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/),s.txt.regexen.validUrlPrecedingChars=r(/(?:[^A-Za-z0-9@＠$#＃#{invalid_chars_group}]|^)/),s.txt.regexen.invalidUrlWithoutProtocolPrecedingChars=/[-_.\/]$/,s.txt.regexen.invalidDomainChars=l("#{punct}#{spaces_group}#{invalid_chars_group}",s.txt.regexen),s.txt.regexen.validDomainChars=r(/[^#{invalidDomainChars}]/),s.txt.regexen.validSubdomain=r(/(?:(?:#{validDomainChars}(?:[_-]|#{validDomainChars})*)?#{validDomainChars}\.)/),s.txt.regexen.validDomainName=r(/(?:(?:#{validDomainChars}(?:-|#{validDomainChars})*)?#{validDomainChars}\.)/),s.txt.regexen.validGTLD=r(RegExp("(?:(?:삼성|닷컴|닷넷|香格里拉|餐厅|食品|飞利浦|電訊盈科|集团|通販|购物|谷歌|诺基亚|联通|网络|网站|网店|网址|组织机构|移动|珠宝|点看|游戏|淡马锡|机构|書籍|时尚|新闻|政府|政务|手表|手机|我爱你|慈善|微博|广东|工行|家電|娱乐|天主教|大拿|大众汽车|在线|嘉里大酒店|嘉里|商标|商店|商城|公益|公司|八卦|健康|信息|佛山|企业|中文网|中信|世界|ポイント|ファッション|セール|ストア|コム|グーグル|クラウド|みんな|คอม|संगठन|नेट|कॉम|همراه|موقع|موبايلي|كوم|كاثوليك|عرب|شبكة|بيتك|بازار|العليان|ارامكو|اتصالات|ابوظبي|קום|сайт|рус|орг|онлайн|москва|ком|католик|дети|zuerich|zone|zippo|zip|zero|zara|zappos|yun|youtube|you|yokohama|yoga|yodobashi|yandex|yamaxun|yahoo|yachts|xyz|xxx|xperia|xin|xihuan|xfinity|xerox|xbox|wtf|wtc|wow|world|works|work|woodside|wolterskluwer|wme|winners|wine|windows|win|williamhill|wiki|wien|whoswho|weir|weibo|wedding|wed|website|weber|webcam|weatherchannel|weather|watches|watch|warman|wanggou|wang|walter|walmart|wales|vuelos|voyage|voto|voting|vote|volvo|volkswagen|vodka|vlaanderen|vivo|viva|vistaprint|vista|vision|visa|virgin|vip|vin|villas|viking|vig|video|viajes|vet|versicherung|vermögensberatung|vermögensberater|verisign|ventures|vegas|vanguard|vana|vacations|ups|uol|uno|university|unicom|uconnect|ubs|ubank|tvs|tushu|tunes|tui|tube|trv|trust|travelersinsurance|travelers|travelchannel|travel|training|trading|trade|toys|toyota|town|tours|total|toshiba|toray|top|tools|tokyo|today|tmall|tkmaxx|tjx|tjmaxx|tirol|tires|tips|tiffany|tienda|tickets|tiaa|theatre|theater|thd|teva|tennis|temasek|telefonica|telecity|tel|technology|tech|team|tdk|tci|taxi|tax|tattoo|tatar|tatamotors|target|taobao|talk|taipei|tab|systems|symantec|sydney|swiss|swiftcover|swatch|suzuki|surgery|surf|support|supply|supplies|sucks|style|study|studio|stream|store|storage|stockholm|stcgroup|stc|statoil|statefarm|statebank|starhub|star|staples|stada|srt|srl|spreadbetting|spot|spiegel|space|soy|sony|song|solutions|solar|sohu|software|softbank|social|soccer|sncf|smile|smart|sling|skype|sky|skin|ski|site|singles|sina|silk|shriram|showtime|show|shouji|shopping|shop|shoes|shiksha|shia|shell|shaw|sharp|shangrila|sfr|sexy|sex|sew|seven|ses|services|sener|select|seek|security|secure|seat|search|scot|scor|scjohnson|science|schwarz|schule|school|scholarships|schmidt|schaeffler|scb|sca|sbs|sbi|saxo|save|sas|sarl|sapo|sap|sanofi|sandvikcoromant|sandvik|samsung|samsclub|salon|sale|sakura|safety|safe|saarland|ryukyu|rwe|run|ruhr|rugby|rsvp|room|rogers|rodeo|rocks|rocher|rmit|rip|rio|ril|rightathome|ricoh|richardli|rich|rexroth|reviews|review|restaurant|rest|republican|report|repair|rentals|rent|ren|reliance|reit|reisen|reise|rehab|redumbrella|redstone|red|recipes|realty|realtor|realestate|read|raid|radio|racing|qvc|quest|quebec|qpon|pwc|pub|prudential|pru|protection|property|properties|promo|progressive|prof|productions|prod|pro|prime|press|praxi|pramerica|post|porn|politie|poker|pohl|pnc|plus|plumbing|playstation|play|place|pizza|pioneer|pink|ping|pin|pid|pictures|pictet|pics|piaget|physio|photos|photography|photo|phone|philips|phd|pharmacy|pfizer|pet|pccw|pay|passagens|party|parts|partners|pars|paris|panerai|panasonic|pamperedchef|page|ovh|ott|otsuka|osaka|origins|orientexpress|organic|org|orange|oracle|open|ooo|onyourside|online|onl|ong|one|omega|ollo|oldnavy|olayangroup|olayan|okinawa|office|off|observer|obi|nyc|ntt|nrw|nra|nowtv|nowruz|now|norton|northwesternmutual|nokia|nissay|nissan|ninja|nikon|nike|nico|nhk|ngo|nfl|nexus|nextdirect|next|news|newholland|new|neustar|network|netflix|netbank|net|nec|nba|navy|natura|nationwide|name|nagoya|nadex|nab|mutuelle|mutual|museum|mtr|mtpc|mtn|msd|movistar|movie|mov|motorcycles|moto|moscow|mortgage|mormon|mopar|montblanc|monster|money|monash|mom|moi|moe|moda|mobily|mobile|mobi|mma|mls|mlb|mitsubishi|mit|mint|mini|mil|microsoft|miami|metlife|merckmsd|meo|menu|men|memorial|meme|melbourne|meet|media|med|mckinsey|mcdonalds|mcd|mba|mattel|maserati|marshalls|marriott|markets|marketing|market|map|mango|management|man|makeup|maison|maif|madrid|macys|luxury|luxe|lupin|lundbeck|ltda|ltd|lplfinancial|lpl|love|lotto|lotte|london|lol|loft|locus|locker|loans|loan|lixil|living|live|lipsy|link|linde|lincoln|limo|limited|lilly|like|lighting|lifestyle|lifeinsurance|life|lidl|liaison|lgbt|lexus|lego|legal|lefrak|leclerc|lease|lds|lawyer|law|latrobe|latino|lat|lasalle|lanxess|landrover|land|lancome|lancia|lancaster|lamer|lamborghini|ladbrokes|lacaixa|kyoto|kuokgroup|kred|krd|kpn|kpmg|kosher|komatsu|koeln|kiwi|kitchen|kindle|kinder|kim|kia|kfh|kerryproperties|kerrylogistics|kerryhotels|kddi|kaufen|juniper|juegos|jprs|jpmorgan|joy|jot|joburg|jobs|jnj|jmp|jll|jlc|jio|jewelry|jetzt|jeep|jcp|jcb|java|jaguar|iwc|iveco|itv|itau|istanbul|ist|ismaili|iselect|irish|ipiranga|investments|intuit|international|intel|int|insure|insurance|institute|ink|ing|info|infiniti|industries|immobilien|immo|imdb|imamat|ikano|iinet|ifm|ieee|icu|ice|icbc|ibm|hyundai|hyatt|hughes|htc|hsbc|how|house|hotmail|hotels|hoteles|hot|hosting|host|hospital|horse|honeywell|honda|homesense|homes|homegoods|homedepot|holiday|holdings|hockey|hkt|hiv|hitachi|hisamitsu|hiphop|hgtv|hermes|here|helsinki|help|healthcare|health|hdfcbank|hdfc|hbo|haus|hangout|hamburg|hair|guru|guitars|guide|guge|gucci|guardian|group|grocery|gripe|green|gratis|graphics|grainger|gov|got|gop|google|goog|goodyear|goodhands|goo|golf|goldpoint|gold|godaddy|gmx|gmo|gmbh|gmail|globo|global|gle|glass|glade|giving|gives|gifts|gift|ggee|george|genting|gent|gea|gdn|gbiz|garden|gap|games|game|gallup|gallo|gallery|gal|fyi|futbol|furniture|fund|fun|fujixerox|fujitsu|ftr|frontier|frontdoor|frogans|frl|fresenius|free|fox|foundation|forum|forsale|forex|ford|football|foodnetwork|food|foo|fly|flsmidth|flowers|florist|flir|flights|flickr|fitness|fit|fishing|fish|firmdale|firestone|fire|financial|finance|final|film|fido|fidelity|fiat|ferrero|ferrari|feedback|fedex|fast|fashion|farmers|farm|fans|fan|family|faith|fairwinds|fail|fage|extraspace|express|exposed|expert|exchange|everbank|events|eus|eurovision|etisalat|esurance|estate|esq|erni|ericsson|equipment|epson|epost|enterprises|engineering|engineer|energy|emerck|email|education|edu|edeka|eco|eat|earth|dvr|dvag|durban|dupont|duns|dunlop|duck|dubai|dtv|drive|download|dot|doosan|domains|doha|dog|dodge|doctor|docs|dnp|diy|dish|discover|discount|directory|direct|digital|diet|diamonds|dhl|dev|design|desi|dentist|dental|democrat|delta|deloitte|dell|delivery|degree|deals|dealer|deal|dds|dclk|day|datsun|dating|date|data|dance|dad|dabur|cyou|cymru|cuisinella|csc|cruises|cruise|crs|crown|cricket|creditunion|creditcard|credit|courses|coupons|coupon|country|corsica|coop|cool|cookingchannel|cooking|contractors|contact|consulting|construction|condos|comsec|computer|compare|company|community|commbank|comcast|com|cologne|college|coffee|codes|coach|clubmed|club|cloud|clothing|clinique|clinic|click|cleaning|claims|cityeats|city|citic|citi|citadel|cisco|circle|cipriani|church|chrysler|chrome|christmas|chloe|chintai|cheap|chat|chase|channel|chanel|cfd|cfa|cern|ceo|center|ceb|cbs|cbre|cbn|cba|catholic|catering|cat|casino|cash|caseih|case|casa|cartier|cars|careers|career|care|cards|caravan|car|capitalone|capital|capetown|canon|cancerresearch|camp|camera|cam|calvinklein|call|cal|cafe|cab|bzh|buzz|buy|business|builders|build|bugatti|budapest|brussels|brother|broker|broadway|bridgestone|bradesco|box|boutique|bot|boston|bostik|bosch|boots|booking|book|boo|bond|bom|bofa|boehringer|boats|bnpparibas|bnl|bmw|bms|blue|bloomberg|blog|blockbuster|blanco|blackfriday|black|biz|bio|bingo|bing|bike|bid|bible|bharti|bet|bestbuy|best|berlin|bentley|beer|beauty|beats|bcn|bcg|bbva|bbt|bbc|bayern|bauhaus|basketball|baseball|bargains|barefoot|barclays|barclaycard|barcelona|bar|bank|band|bananarepublic|banamex|baidu|baby|azure|axa|aws|avianca|autos|auto|author|auspost|audio|audible|audi|auction|attorney|athleta|associates|asia|asda|arte|art|arpa|army|archi|aramco|arab|aquarelle|apple|app|apartments|aol|anz|anquan|android|analytics|amsterdam|amica|amfam|amex|americanfamily|americanexpress|alstom|alsace|ally|allstate|allfinanz|alipay|alibaba|alfaromeo|akdn|airtel|airforce|airbus|aigo|aig|agency|agakhan|africa|afl|afamilycompany|aetna|aero|aeg|adult|ads|adac|actor|active|aco|accountants|accountant|accenture|academy|abudhabi|abogado|able|abc|abbvie|abbott|abb|abarth|aarp|aaa|onion)(?=[^0-9a-zA-Z@]|$))")),s.txt.regexen.validCCTLD=r(RegExp("(?:(?:한국|香港|澳門|新加坡|台灣|台湾|中國|中国|გე|ไทย|ලංකා|ഭാരതം|ಭಾರತ|భారత్|சிங்கப்பூர்|இலங்கை|இந்தியா|ଭାରତ|ભારત|ਭਾਰਤ|ভাৰত|ভারত|বাংলা|भारोत|भारतम्|भारत|ڀارت|پاکستان|مليسيا|مصر|قطر|فلسطين|عمان|عراق|سورية|سودان|تونس|بھارت|بارت|ایران|امارات|المغرب|السعودية|الجزائر|الاردن|հայ|қаз|укр|срб|рф|мон|мкд|ею|бел|бг|ελ|zw|zm|za|yt|ye|ws|wf|vu|vn|vi|vg|ve|vc|va|uz|uy|us|um|uk|ug|ua|tz|tw|tv|tt|tr|tp|to|tn|tm|tl|tk|tj|th|tg|tf|td|tc|sz|sy|sx|sv|su|st|ss|sr|so|sn|sm|sl|sk|sj|si|sh|sg|se|sd|sc|sb|sa|rw|ru|rs|ro|re|qa|py|pw|pt|ps|pr|pn|pm|pl|pk|ph|pg|pf|pe|pa|om|nz|nu|nr|np|no|nl|ni|ng|nf|ne|nc|na|mz|my|mx|mw|mv|mu|mt|ms|mr|mq|mp|mo|mn|mm|ml|mk|mh|mg|mf|me|md|mc|ma|ly|lv|lu|lt|ls|lr|lk|li|lc|lb|la|kz|ky|kw|kr|kp|kn|km|ki|kh|kg|ke|jp|jo|jm|je|it|is|ir|iq|io|in|im|il|ie|id|hu|ht|hr|hn|hm|hk|gy|gw|gu|gt|gs|gr|gq|gp|gn|gm|gl|gi|gh|gg|gf|ge|gd|gb|ga|fr|fo|fm|fk|fj|fi|eu|et|es|er|eh|eg|ee|ec|dz|do|dm|dk|dj|de|cz|cy|cx|cw|cv|cu|cr|co|cn|cm|cl|ck|ci|ch|cg|cf|cd|cc|ca|bz|by|bw|bv|bt|bs|br|bq|bo|bn|bm|bl|bj|bi|bh|bg|bf|be|bd|bb|ba|az|ax|aw|au|at|as|ar|aq|ao|an|am|al|ai|ag|af|ae|ad|ac)(?=[^0-9a-zA-Z@]|$))")),s.txt.regexen.validPunycode=/(?:xn--[0-9a-z]+)/,s.txt.regexen.validSpecialCCTLD=/(?:(?:co|tv)(?=[^0-9a-zA-Z@]|$))/,s.txt.regexen.validDomain=r(/(?:#{validSubdomain}*#{validDomainName}(?:#{validGTLD}|#{validCCTLD}|#{validPunycode}))/),s.txt.regexen.validAsciiDomain=r(/(?:(?:[\-a-z0-9#{latinAccentChars}]+)\.)+(?:#{validGTLD}|#{validCCTLD}|#{validPunycode})/gi),s.txt.regexen.invalidShortDomain=r(/^#{validDomainName}#{validCCTLD}$/i),s.txt.regexen.validSpecialShortDomain=r(/^#{validDomainName}#{validSpecialCCTLD}$/i),s.txt.regexen.validPortNumber=/[0-9]+/,s.txt.regexen.cyrillicLettersAndMarks=/\u0400-\u04FF/,s.txt.regexen.validGeneralUrlPathChars=r(/[a-z#{cyrillicLettersAndMarks}0-9!\*';:=\+,\.\$\/%#\[\]\-_~@\|&#{latinAccentChars}]/i),s.txt.regexen.validUrlBalancedParens=r("\\((?:#{validGeneralUrlPathChars}+|(?:#{validGeneralUrlPathChars}*\\(#{validGeneralUrlPathChars}+\\)#{validGeneralUrlPathChars}*))\\)","i"),s.txt.regexen.validUrlPathEndingChars=r(/[\+\-a-z#{cyrillicLettersAndMarks}0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i),s.txt.regexen.validUrlPath=r("(?:(?:#{validGeneralUrlPathChars}*(?:#{validUrlBalancedParens}#{validGeneralUrlPathChars}*)*#{validUrlPathEndingChars})|(?:@#{validGeneralUrlPathChars}+/))","i"),s.txt.regexen.validUrlQueryChars=/[a-z0-9!?\*'@\(\);:&=\+\$\/%#\[\]\-_\.,~|]/i,s.txt.regexen.validUrlQueryEndingChars=/[a-z0-9_&=#\/]/i,s.txt.regexen.extractUrl=r("((#{validUrlPrecedingChars})((https?:\\/\\/)?(#{validDomain})(?::(#{validPortNumber}))?(\\/#{validUrlPath}*)?(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?))","gi"),s.txt.regexen.validTcoUrl=/^https?:\/\/t\.co\/[a-z0-9]+/i,s.txt.regexen.urlHasProtocol=/^https?:\/\//i,s.txt.regexen.urlHasHttps=/^https:\/\//i,s.txt.regexen.cashtag=/[a-z]{1,6}(?:[._][a-z]{1,2})?/i,s.txt.regexen.validCashtag=r("(^|#{spaces})(\\$)(#{cashtag})(?=$|\\s|[#{punct}])","gi"),s.txt.regexen.validateUrlUnreserved=/[a-z\u0400-\u04FF0-9\-._~]/i,s.txt.regexen.validateUrlPctEncoded=/(?:%[0-9a-f]{2})/i,s.txt.regexen.validateUrlSubDelims=/[!$&'()*+,;=]/i,s.txt.regexen.validateUrlPchar=r("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|[:|@])","i"),s.txt.regexen.validateUrlScheme=/(?:[a-z][a-z0-9+\-.]*)/i,s.txt.regexen.validateUrlUserinfo=r("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|:)*","i"),s.txt.regexen.validateUrlDecOctet=/(?:[0-9]|(?:[1-9][0-9])|(?:1[0-9]{2})|(?:2[0-4][0-9])|(?:25[0-5]))/i,s.txt.regexen.validateUrlIpv4=r(/(?:#{validateUrlDecOctet}(?:\.#{validateUrlDecOctet}){3})/i),s.txt.regexen.validateUrlIpv6=/(?:\[[a-f0-9:\.]+\])/i,s.txt.regexen.validateUrlIp=r("(?:#{validateUrlIpv4}|#{validateUrlIpv6})","i"),s.txt.regexen.validateUrlSubDomainSegment=/(?:[a-z0-9](?:[a-z0-9_\-]*[a-z0-9])?)/i,s.txt.regexen.validateUrlDomainSegment=/(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)/i,s.txt.regexen.validateUrlDomainTld=/(?:[a-z](?:[a-z0-9\-]*[a-z0-9])?)/i,s.txt.regexen.validateUrlDomain=r(/(?:(?:#{validateUrlSubDomainSegment}\.)*(?:#{validateUrlDomainSegment}\.)#{validateUrlDomainTld})/i),s.txt.regexen.validateUrlHost=r("(?:#{validateUrlIp}|#{validateUrlDomain})","i"),s.txt.regexen.validateUrlUnicodeSubDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9_\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,s.txt.regexen.validateUrlUnicodeDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,s.txt.regexen.validateUrlUnicodeDomainTld=/(?:(?:[a-z]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,s.txt.regexen.validateUrlUnicodeDomain=r(/(?:(?:#{validateUrlUnicodeSubDomainSegment}\.)*(?:#{validateUrlUnicodeDomainSegment}\.)#{validateUrlUnicodeDomainTld})/i),s.txt.regexen.validateUrlUnicodeHost=r("(?:#{validateUrlIp}|#{validateUrlUnicodeDomain})","i"),s.txt.regexen.validateUrlPort=/[0-9]{1,5}/,s.txt.regexen.validateUrlUnicodeAuthority=r("(?:(#{validateUrlUserinfo})@)?(#{validateUrlUnicodeHost})(?::(#{validateUrlPort}))?","i"),s.txt.regexen.validateUrlAuthority=r("(?:(#{validateUrlUserinfo})@)?(#{validateUrlHost})(?::(#{validateUrlPort}))?","i"),s.txt.regexen.validateUrlPath=r(/(\/#{validateUrlPchar}*)*/i),s.txt.regexen.validateUrlQuery=r(/(#{validateUrlPchar}|\/|\?)*/i),s.txt.regexen.validateUrlFragment=r(/(#{validateUrlPchar}|\/|\?)*/i),s.txt.regexen.validateUrlUnencoded=r("^(?:([^:/?#]+):\\/\\/)?([^/?#]*)([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$","i");var c={urlClass:!0,listClass:!0,usernameClass:!0,hashtagClass:!0,cashtagClass:!0,usernameUrlBase:!0,listUrlBase:!0,hashtagUrlBase:!0,cashtagUrlBase:!0,usernameUrlBlock:!0,listUrlBlock:!0,hashtagUrlBlock:!0,linkUrlBlock:!0,usernameIncludeSymbol:!0,suppressLists:!0,suppressNoFollow:!0,targetBlank:!0,suppressDataScreenName:!0,urlEntities:!0,symbolTag:!0,textWithSymbolTag:!0,urlTarget:!0,invisibleTagAttrs:!0,linkAttributeBlock:!0,linkTextBlock:!0,htmlEscapeNonEntities:!0},d={disabled:!0,readonly:!0,multiple:!0,checked:!0};function u(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}s.txt.tagAttrs=function(e){var t="";for(var n in e){var i=e[n];d[n]&&(i=i?n:null),null!=i&&(t+=" "+s.txt.htmlEscape(n)+'="'+s.txt.htmlEscape(i.toString())+'"')}return t},s.txt.linkToText=function(e,t,n,i){return i.suppressNoFollow||(n.rel="nofollow"),i.linkAttributeBlock&&i.linkAttributeBlock(e,n),i.linkTextBlock&&(t=i.linkTextBlock(e,t)),l("<a#{attr}>#{text}</a>",{text:t,attr:s.txt.tagAttrs(n)})},s.txt.linkToTextWithSymbol=function(e,t,n,i,o){var a=o.symbolTag?"<"+o.symbolTag+">"+t+"</"+o.symbolTag+">":t;n=s.txt.htmlEscape(n);var r=o.textWithSymbolTag?"<"+o.textWithSymbolTag+">"+n+"</"+o.textWithSymbolTag+">":n;return o.usernameIncludeSymbol||!t.match(s.txt.regexen.atSigns)?s.txt.linkToText(e,a+r,i,o):a+s.txt.linkToText(e,r,i,o)},s.txt.linkToHashtag=function(e,t,n){var i=t.substring(e.indices[0],e.indices[0]+1),o=s.txt.htmlEscape(e.hashtag),a=u(n.htmlAttrs||{});return a.href=n.hashtagUrlBase+o,a.title="#"+o,a.class=n.hashtagClass,o.charAt(0).match(s.txt.regexen.rtl_chars)&&(a.class+=" rtl"),n.targetBlank&&(a.target="_blank"),s.txt.linkToTextWithSymbol(e,i,o,a,n)},s.txt.linkToCashtag=function(e,t,n){var i=s.txt.htmlEscape(e.cashtag),o=u(n.htmlAttrs||{});return o.href=n.cashtagUrlBase+i,o.title="$"+i,o.class=n.cashtagClass,n.targetBlank&&(o.target="_blank"),s.txt.linkToTextWithSymbol(e,"$",i,o,n)},s.txt.linkToMentionAndList=function(e,t,n){var i=t.substring(e.indices[0],e.indices[0]+1),o=s.txt.htmlEscape(e.screenName),a=s.txt.htmlEscape(e.listSlug),r=e.listSlug&&!n.suppressLists,l=u(n.htmlAttrs||{});return l.class=r?n.listClass:n.usernameClass,l.href=r?n.listUrlBase+o+a:n.usernameUrlBase+o,r||n.suppressDataScreenName||(l["data-screen-name"]=o),n.targetBlank&&(l.target="_blank"),s.txt.linkToTextWithSymbol(e,i,r?o+a:o,l,n)},s.txt.linkToUrl=function(e,t,n){var i=e.url,o=i,a=s.txt.htmlEscape(o),r=n.urlEntities&&n.urlEntities[i]||e;r.display_url&&(a=s.txt.linkTextWithEntity(r,n));var l=u(n.htmlAttrs||{});return i.match(s.txt.regexen.urlHasProtocol)||(i="http://"+i),l.href=i,n.targetBlank&&(l.target="_blank"),n.urlClass&&(l.class=n.urlClass),n.urlTarget&&(l.target=n.urlTarget),!n.title&&r.display_url&&(l.title=r.expanded_url),s.txt.linkToText(e,a,l,n)},s.txt.linkTextWithEntity=function(e,t){var n=e.display_url,i=e.expanded_url,o=n.replace(/…/g,"");if(-1!=i.indexOf(o)){var a=i.indexOf(o),r={displayUrlSansEllipses:o,beforeDisplayUrl:i.substr(0,a),afterDisplayUrl:i.substr(a+o.length),precedingEllipsis:n.match(/^…/)?"…":"",followingEllipsis:n.match(/…$/)?"…":""};for(var c in r)r.hasOwnProperty(c)&&(r[c]=s.txt.htmlEscape(r[c]));return r.invisible=t.invisibleTagAttrs,l("<span class='tco-ellipsis'>#{precedingEllipsis}<span #{invisible}>&nbsp;</span></span><span #{invisible}>#{beforeDisplayUrl}</span><span class='js-display-url'>#{displayUrlSansEllipses}</span><span #{invisible}>#{afterDisplayUrl}</span><span class='tco-ellipsis'><span #{invisible}>&nbsp;</span>#{followingEllipsis}</span>",r)}return n},s.txt.autoLinkEntities=function(e,t,n){var i,o;if((n=u(n||{})).hashtagClass=n.hashtagClass||"tweet-url hashtag",n.hashtagUrlBase=n.hashtagUrlBase||"https://twitter.com/#!/search?q=%23",n.cashtagClass=n.cashtagClass||"tweet-url cashtag",n.cashtagUrlBase=n.cashtagUrlBase||"https://twitter.com/#!/search?q=%24",n.listClass=n.listClass||"tweet-url list-slug",n.usernameClass=n.usernameClass||"tweet-url username",n.usernameUrlBase=n.usernameUrlBase||"https://twitter.com/",n.listUrlBase=n.listUrlBase||"https://twitter.com/",n.htmlAttrs=s.txt.extractHtmlAttrsFromOptions(n),n.invisibleTagAttrs=n.invisibleTagAttrs||"style='position:absolute;left:-9999px;'",n.urlEntities){for(i={},c=0,o=n.urlEntities.length;c<o;c++)i[n.urlEntities[c].url]=n.urlEntities[c];n.urlEntities=i}var a="",r=0;t.sort((function(e,t){return e.indices[0]-t.indices[0]}));for(var l=n.htmlEscapeNonEntities?s.txt.htmlEscape:function(e){return e},c=0;c<t.length;c++){var d=t[c];a+=l(e.substring(r,d.indices[0])),d.url?a+=s.txt.linkToUrl(d,e,n):d.hashtag?a+=s.txt.linkToHashtag(d,e,n):d.screenName?a+=s.txt.linkToMentionAndList(d,e,n):d.cashtag&&(a+=s.txt.linkToCashtag(d,e,n)),r=d.indices[1]}return a+l(e.substring(r,e.length))},s.txt.autoLinkWithJSON=function(e,t,n){if(t.user_mentions)for(var i=0;i<t.user_mentions.length;i++)t.user_mentions[i].screenName=t.user_mentions[i].screen_name;if(t.hashtags)for(i=0;i<t.hashtags.length;i++)t.hashtags[i].hashtag=t.hashtags[i].text;if(t.symbols)for(i=0;i<t.symbols.length;i++)t.symbols[i].cashtag=t.symbols[i].text;var o=[];for(var a in t)o=o.concat(t[a]);return s.txt.modifyIndicesFromUnicodeToUTF16(e,o),s.txt.autoLinkEntities(e,o,n)},s.txt.extractHtmlAttrsFromOptions=function(e){var t={};for(var n in e){var i=e[n];c[n]||(d[n]&&(i=i?n:null),null!=i&&(t[n]=i))}return t},s.txt.autoLink=function(e,t){var n=s.txt.extractEntitiesWithIndices(e,{extractUrlsWithoutProtocol:!1});return s.txt.autoLinkEntities(e,n,t)},s.txt.autoLinkUsernamesOrLists=function(e,t){var n=s.txt.extractMentionsOrListsWithIndices(e);return s.txt.autoLinkEntities(e,n,t)},s.txt.autoLinkHashtags=function(e,t){var n=s.txt.extractHashtagsWithIndices(e);return s.txt.autoLinkEntities(e,n,t)},s.txt.autoLinkCashtags=function(e,t){var n=s.txt.extractCashtagsWithIndices(e);return s.txt.autoLinkEntities(e,n,t)},s.txt.autoLinkUrlsCustom=function(e,t){var n=s.txt.extractUrlsWithIndices(e,{extractUrlsWithoutProtocol:!1});return s.txt.autoLinkEntities(e,n,t)},s.txt.removeOverlappingEntities=function(e){e.sort((function(e,t){return e.indices[0]-t.indices[0]}));for(var t=e[0],n=1;n<e.length;n++)t.indices[1]>e[n].indices[0]?(e.splice(n,1),n--):t=e[n]},s.txt.extractEntitiesWithIndices=function(e,t){var n=s.txt.extractUrlsWithIndices(e,t).concat(s.txt.extractMentionsOrListsWithIndices(e)).concat(s.txt.extractHashtagsWithIndices(e,{checkUrlOverlap:!1})).concat(s.txt.extractCashtagsWithIndices(e));return 0==n.length?[]:(s.txt.removeOverlappingEntities(n),n)},s.txt.extractMentions=function(e){for(var t=[],n=s.txt.extractMentionsWithIndices(e),i=0;i<n.length;i++){var o=n[i].screenName;t.push(o)}return t},s.txt.extractMentionsWithIndices=function(e){for(var t,n=[],i=s.txt.extractMentionsOrListsWithIndices(e),o=0;o<i.length;o++)""==(t=i[o]).listSlug&&n.push({screenName:t.screenName,indices:t.indices});return n},s.txt.extractMentionsOrListsWithIndices=function(e){if(!e||!e.match(s.txt.regexen.atSigns))return[];var t=[];return e.replace(s.txt.regexen.validMentionOrList,(function(e,n,i,o,a,r,l){if(!l.slice(r+e.length).match(s.txt.regexen.endMentionMatch)){a=a||"";var c=r+n.length,d=c+o.length+a.length+1;t.push({screenName:o,listSlug:a,indices:[c,d]})}})),t},s.txt.extractReplies=function(e){if(!e)return null;var t=e.match(s.txt.regexen.validReply);return!t||RegExp.rightContext.match(s.txt.regexen.endMentionMatch)?null:t[1]},s.txt.extractUrls=function(e,t){for(var n=[],i=s.txt.extractUrlsWithIndices(e,t),o=0;o<i.length;o++)n.push(i[o].url);return n},s.txt.extractUrlsWithIndices=function(e,t){if(t||(t={extractUrlsWithoutProtocol:!0}),!e||(t.extractUrlsWithoutProtocol?!e.match(/\./):!e.match(/:/)))return[];for(var n=[];s.txt.regexen.extractUrl.exec(e);){var i=RegExp.$2,o=RegExp.$3,a=RegExp.$4,r=RegExp.$5,l=RegExp.$7,c=s.txt.regexen.extractUrl.lastIndex,d=c-o.length;if(a)o.match(s.txt.regexen.validTcoUrl)&&(o=RegExp.lastMatch,c=d+o.length),n.push({url:o,indices:[d,c]});else{if(!t.extractUrlsWithoutProtocol||i.match(s.txt.regexen.invalidUrlWithoutProtocolPrecedingChars))continue;var u=null,p=0;if(r.replace(s.txt.regexen.validAsciiDomain,(function(e){var t=r.indexOf(e,p);p=t+e.length,u={url:e,indices:[d+t,d+p]},(l||e.match(s.txt.regexen.validSpecialShortDomain)||!e.match(s.txt.regexen.invalidShortDomain))&&n.push(u)})),null==u)continue;l&&(u.url=o.replace(r,u.url),u.indices[1]=c)}}return n},s.txt.extractHashtags=function(e){for(var t=[],n=s.txt.extractHashtagsWithIndices(e),i=0;i<n.length;i++)t.push(n[i].hashtag);return t},s.txt.extractHashtagsWithIndices=function(e,t){if(t||(t={checkUrlOverlap:!0}),!e||!e.match(s.txt.regexen.hashSigns))return[];var n=[];if(e.replace(s.txt.regexen.validHashtag,(function(e,t,i,o,a,r){if(!r.slice(a+e.length).match(s.txt.regexen.endHashtagMatch)){var l=a+t.length,c=l+o.length+1;n.push({hashtag:o,indices:[l,c]})}})),t.checkUrlOverlap){var i=s.txt.extractUrlsWithIndices(e);if(i.length>0){var o=n.concat(i);s.txt.removeOverlappingEntities(o),n=[];for(var a=0;a<o.length;a++)o[a].hashtag&&n.push(o[a])}}return n},s.txt.extractCashtags=function(e){for(var t=[],n=s.txt.extractCashtagsWithIndices(e),i=0;i<n.length;i++)t.push(n[i].cashtag);return t},s.txt.extractCashtagsWithIndices=function(e){if(!e||-1==e.indexOf("$"))return[];var t=[];return e.replace(s.txt.regexen.validCashtag,(function(e,n,i,o,s,a){var r=s+n.length,l=r+o.length+1;t.push({cashtag:o,indices:[r,l]})})),t},s.txt.modifyIndicesFromUnicodeToUTF16=function(e,t){s.txt.convertUnicodeIndices(e,t,!1)},s.txt.modifyIndicesFromUTF16ToUnicode=function(e,t){s.txt.convertUnicodeIndices(e,t,!0)},s.txt.getUnicodeTextLength=function(e){return e.replace(s.txt.regexen.non_bmp_code_pairs," ").length},s.txt.convertUnicodeIndices=function(e,t,n){if(0!=t.length){var i=0,o=0;t.sort((function(e,t){return e.indices[0]-t.indices[0]}));for(var s=0,a=t[0];i<e.length;){if(a.indices[0]==(n?i:o)){var r=a.indices[1]-a.indices[0];if(a.indices[0]=n?o:i,a.indices[1]=a.indices[0]+r,++s==t.length)break;a=t[s]}var l=e.charCodeAt(i);55296<=l&&l<=56319&&i<e.length-1&&56320<=(l=e.charCodeAt(i+1))&&l<=57343&&i++,o++,i++}}},s.txt.splitTags=function(e){for(var t,n,i=e.split("<"),o=[],s=0;s<i.length;s+=1)if(n=i[s]){t=n.split(">");for(var a=0;a<t.length;a+=1)o.push(t[a])}else o.push("");return o},s.txt.hitHighlight=function(e,t,n){if(n=n||{},0===(t=t||[]).length)return e;var i,o,a,r,l,c,d,u=n.tag||"em",p=["<"+u+">","</"+u+">"],h=s.txt.splitTags(e),g="",m=0,_=h[0],f=0,y=0,v=!1,b=_,x=[];for(i=0;i<t.length;i+=1)for(o=0;o<t[i].length;o+=1)x.push(t[i][o]);for(a=0;a<x.length;a+=1){for(r=x[a],l=p[a%2],c=!1;null!=_&&r>=f+_.length;)g+=b.slice(y),v&&r===f+b.length&&(g+=l,c=!0),h[m+1]&&(g+="<"+h[m+1]+">"),f+=b.length,y=0,b=_=h[m+=2],v=!1;c||null==_?c||(c=!0,g+=l):(d=r-f,g+=b.slice(y,d)+l,y=d,v=a%2==0)}if(null!=_)for(y<b.length&&(g+=b.slice(y)),a=m+1;a<h.length;a+=1)g+=a%2==0?h[a]:"<"+h[a]+">";return g},s.txt.getTweetLength=function(e,t){t||(t={short_url_length:23,short_url_length_https:23});var n=s.txt.getUnicodeTextLength(e),i=s.txt.extractUrlsWithIndices(e);s.txt.modifyIndicesFromUTF16ToUnicode(e,i);for(var o=0;o<i.length;o++)n+=i[o].indices[0]-i[o].indices[1],i[o].url.toLowerCase().match(s.txt.regexen.urlHasHttps)?n+=t.short_url_length_https:n+=t.short_url_length;return n},s.txt.isInvalidTweet=function(e){return e?s.txt.getTweetLength(e)>140?"too_long":!!s.txt.hasInvalidCharacters(e)&&"invalid_characters":"empty"},s.txt.hasInvalidCharacters=function(e){return s.txt.regexen.invalid_chars.test(e)},s.txt.isValidTweetText=function(e){return!s.txt.isInvalidTweet(e)},s.txt.isValidUsername=function(e){if(!e)return!1;var t=s.txt.extractMentions(e);return 1===t.length&&t[0]===e.slice(1)};var p=r(/^#{validMentionOrList}$/);function h(e,t,n){return n?!e||e.match(t)&&RegExp["$&"]===e:"string"==typeof e&&e.match(t)&&RegExp["$&"]===e}if(s.txt.isValidList=function(e){var t=e.match(p);return!(!t||""!=t[1]||!t[4])},s.txt.isValidHashtag=function(e){if(!e)return!1;var t=s.txt.extractHashtags(e);return 1===t.length&&t[0]===e.slice(1)},s.txt.isValidUrl=function(e,t,n){if(null==t&&(t=!0),null==n&&(n=!0),!e)return!1;var i=e.match(s.txt.regexen.validateUrlUnencoded);if(!i||i[0]!==e)return!1;var o=i[1],a=i[2],r=i[3],l=i[4],c=i[5];return!!((!n||h(o,s.txt.regexen.validateUrlScheme)&&o.match(/^https?$/i))&&h(r,s.txt.regexen.validateUrlPath)&&h(l,s.txt.regexen.validateUrlQuery,!0)&&h(c,s.txt.regexen.validateUrlFragment,!0))&&(t&&h(a,s.txt.regexen.validateUrlUnicodeAuthority)||!t&&h(a,s.txt.regexen.validateUrlAuthority))},e.exports&&(e.exports=s.txt),i=[],n=s.txt,void 0===(o="function"==typeof n?n.apply(t,i):n)||(e.exports=o),"undefined"!=typeof window)if(window.twttr)for(var g in s)window.twttr[g]=s[g];else window.twttr=s}()},972:function(e,t,n){e=n.nmd(e);var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var o={function:!0,object:!0},s=o[i(t)]&&t&&!t.nodeType&&t,a=o["undefined"==typeof window?"undefined":i(window)]&&window||this,r=s&&o[i(e)]&&e&&!e.nodeType&&"object"==(void 0===n.g?"undefined":i(n.g))&&n.g;function l(e,t){e||(e=a.Object()),t||(t=a.Object());var n=e.Number||a.Number,s=e.String||a.String,r=e.Object||a.Object,c=e.Date||a.Date,d=e.SyntaxError||a.SyntaxError,u=e.TypeError||a.TypeError,p=e.Math||a.Math,h=e.JSON||a.JSON;"object"==(void 0===h?"undefined":i(h))&&h&&(t.stringify=h.stringify,t.parse=h.parse);var g,m=r.prototype,_=m.toString,f=m.hasOwnProperty;function y(e,t){try{e()}catch(e){t&&t()}}var v=new c(-0xc782b5b800cec);function b(e){if(null!=b[e])return b[e];var i;if("bug-string-char-index"==e)i="a"!="a"[0];else if("json"==e)i=b("json-stringify")&&b("date-serialization")&&b("json-parse");else if("date-serialization"==e){if(i=b("json-stringify")&&v){var o=t.stringify;y((function(){i='"-271821-04-20T00:00:00.000Z"'==o(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==o(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==o(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==o(new c(-1))}))}}else{var a,r='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var l="function"==typeof(o=t.stringify);l&&((a=function(){return 1}).toJSON=a,y((function(){l="0"===o(0)&&"0"===o(new n)&&'""'==o(new s)&&o(_)===g&&o(g)===g&&o()===g&&"1"===o(a)&&"[1]"==o([a])&&"[null]"==o([g])&&"null"==o(null)&&"[null,null,null]"==o([g,_,null])&&o({a:[a,!0,!1,null,"\0\b\n\f\r\t"]})==r&&"1"===o(null,a)&&"[\n 1,\n 2\n]"==o([1,2],null,1)}),(function(){l=!1}))),i=l}if("json-parse"==e){var d,u=t.parse;"function"==typeof u&&y((function(){0!==u("0")||u(!1)||(a=u(r),(d=5==a.a.length&&1===a.a[0])&&(y((function(){d=!u('"\t"')})),d&&y((function(){d=1!==u("01")})),d&&y((function(){d=1!==u("1.")}))))}),(function(){d=!1})),i=d}}return b[e]=!!i}if(y((function(){v=-109252==v.getUTCFullYear()&&0===v.getUTCMonth()&&1===v.getUTCDate()&&10==v.getUTCHours()&&37==v.getUTCMinutes()&&6==v.getUTCSeconds()&&708==v.getUTCMilliseconds()})),b["bug-string-char-index"]=b["date-serialization"]=b.json=b["json-stringify"]=b["json-parse"]=null,!b("json")){var x="[object Function]",w="[object Number]",C="[object String]",k="[object Array]",I=b("bug-string-char-index"),B=function(e,t){var n,s,a,r=0;for(a in(n=function(){this.valueOf=0}).prototype.valueOf=0,s=new n)f.call(s,a)&&r++;return n=s=null,r?B=function(e,t){var n,i,o=_.call(e)==x;for(n in e)o&&"prototype"==n||!f.call(e,n)||(i="constructor"===n)||t(n);(i||f.call(e,n="constructor"))&&t(n)}:(s=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],B=function(e,t){var n,a,r=_.call(e)==x,l=!r&&"function"!=typeof e.constructor&&o[i(e.hasOwnProperty)]&&e.hasOwnProperty||f;for(n in e)r&&"prototype"==n||!l.call(e,n)||t(n);for(a=s.length;n=s[--a];)l.call(e,n)&&t(n)}),B(e,t)};if(!b("json-stringify")&&!b("date-serialization")){var E={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},S=function(e,t){return("000000"+(t||0)).slice(-e)},T=function(e){var t,n,i,o,s,a,r,l,c;if(v)t=function(e){n=e.getUTCFullYear(),i=e.getUTCMonth(),o=e.getUTCDate(),a=e.getUTCHours(),r=e.getUTCMinutes(),l=e.getUTCSeconds(),c=e.getUTCMilliseconds()};else{var d=p.floor,u=[0,31,59,90,120,151,181,212,243,273,304,334],h=function(e,t){return u[t]+365*(e-1970)+d((e-1969+(t=+(t>1)))/4)-d((e-1901+t)/100)+d((e-1601+t)/400)};t=function(e){for(o=d(e/864e5),n=d(o/365.2425)+1970-1;h(n+1,0)<=o;n++);for(i=d((o-h(n,0))/30.42);h(n,i+1)<=o;i++);o=1+o-h(n,i),a=d((s=(e%864e5+864e5)%864e5)/36e5)%24,r=d(s/6e4)%60,l=d(s/1e3)%60,c=s%1e3}}return T=function(e){return e>-1/0&&e<1/0?(t(e),e=(n<=0||n>=1e4?(n<0?"-":"+")+S(6,n<0?-n:n):S(4,n))+"-"+S(2,i+1)+"-"+S(2,o)+"T"+S(2,a)+":"+S(2,r)+":"+S(2,l)+"."+S(3,c)+"Z",n=i=o=a=r=l=c=null):e=null,e},T(e)};if(b("json-stringify")&&!b("date-serialization")){var L=function(e){return T(this)},P=t.stringify;t.stringify=function(e,t,n){var i=c.prototype.toJSON;c.prototype.toJSON=L;var o=P(e,t,n);return c.prototype.toJSON=i,o}}else{var A=function(e){var t=e.charCodeAt(0);return E[t]||"\\u00"+S(2,t.toString(16))},F=/[\x00-\x1f\x22\x5c]/g,M=function(e){return F.lastIndex=0,'"'+(F.test(e)?e.replace(F,A):e)+'"'},O=function e(t,n,o,s,a,r,l){var d,p,h,m,f,v,b,x,I;if(y((function(){d=n[t]})),"object"==(void 0===d?"undefined":i(d))&&d&&(d.getUTCFullYear&&"[object Date]"==_.call(d)&&d.toJSON===c.prototype.toJSON?d=T(d):"function"==typeof d.toJSON&&(d=d.toJSON(t))),o&&(d=o.call(n,t,d)),d==g)return d===g?d:"null";switch("object"==(p=void 0===d?"undefined":i(d))&&(h=_.call(d)),h||p){case"boolean":case"[object Boolean]":return""+d;case"number":case w:return d>-1/0&&d<1/0?""+d:"null";case"string":case C:return M(""+d)}if("object"==(void 0===d?"undefined":i(d))){for(b=l.length;b--;)if(l[b]===d)throw u();if(l.push(d),m=[],x=r,r+=a,h==k){for(v=0,b=d.length;v<b;v++)f=e(v,d,o,s,a,r,l),m.push(f===g?"null":f);I=m.length?a?"[\n"+r+m.join(",\n"+r)+"\n"+x+"]":"["+m.join(",")+"]":"[]"}else B(s||d,(function(t){var n=e(t,d,o,s,a,r,l);n!==g&&m.push(M(t)+":"+(a?" ":"")+n)})),I=m.length?a?"{\n"+r+m.join(",\n"+r)+"\n"+x+"}":"{"+m.join(",")+"}":"{}";return l.pop(),I}};t.stringify=function(e,t,n){var s,a,r,l;if(o[void 0===t?"undefined":i(t)]&&t)if((l=_.call(t))==x)a=t;else if(l==k){r={};for(var c,d=0,u=t.length;d<u;)c=t[d++],"[object String]"!=(l=_.call(c))&&"[object Number]"!=l||(r[c]=1)}if(n)if((l=_.call(n))==w){if((n-=n%1)>0)for(n>10&&(n=10),s="";s.length<n;)s+=" "}else l==C&&(s=n.length<=10?n:n.slice(0,10));return O("",((c={})[""]=e,c),a,r,s,"",[])}}}if(!b("json-parse")){var H,z,R=s.fromCharCode,W={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},U=function(){throw H=z=null,d()},q=function(){for(var e,t,n,i,o,s=z,a=s.length;H<a;)switch(o=s.charCodeAt(H)){case 9:case 10:case 13:case 32:H++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=I?s.charAt(H):s[H],H++,e;case 34:for(e="@",H++;H<a;)if((o=s.charCodeAt(H))<32)U();else if(92==o)switch(o=s.charCodeAt(++H)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=W[o],H++;break;case 117:for(t=++H,n=H+4;H<n;H++)(o=s.charCodeAt(H))>=48&&o<=57||o>=97&&o<=102||o>=65&&o<=70||U();e+=R("0x"+s.slice(t,H));break;default:U()}else{if(34==o)break;for(o=s.charCodeAt(H),t=H;o>=32&&92!=o&&34!=o;)o=s.charCodeAt(++H);e+=s.slice(t,H)}if(34==s.charCodeAt(H))return H++,e;U();default:if(t=H,45==o&&(i=!0,o=s.charCodeAt(++H)),o>=48&&o<=57){for(48==o&&(o=s.charCodeAt(H+1))>=48&&o<=57&&U(),i=!1;H<a&&(o=s.charCodeAt(H))>=48&&o<=57;H++);if(46==s.charCodeAt(H)){for(n=++H;n<a&&!((o=s.charCodeAt(n))<48||o>57);n++);n==H&&U(),H=n}if(101==(o=s.charCodeAt(H))||69==o){for(43!=(o=s.charCodeAt(++H))&&45!=o||H++,n=H;n<a&&!((o=s.charCodeAt(n))<48||o>57);n++);n==H&&U(),H=n}return+s.slice(t,H)}i&&U();var r=s.slice(H,H+4);if("true"==r)return H+=4,!0;if("fals"==r&&101==s.charCodeAt(H+4))return H+=5,!1;if("null"==r)return H+=4,null;U()}return"$"},D=function e(t){var n,i;if("$"==t&&U(),"string"==typeof t){if("@"==(I?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(n=[];"]"!=(t=q());)i?","==t?"]"==(t=q())&&U():U():i=!0,","==t&&U(),n.push(e(t));return n}if("{"==t){for(n={};"}"!=(t=q());)i?","==t?"}"==(t=q())&&U():U():i=!0,","!=t&&"string"==typeof t&&"@"==(I?t.charAt(0):t[0])&&":"==q()||U(),n[t.slice(1)]=e(q());return n}U()}return t},N=function(e,t,n){var i=j(e,t,n);i===g?delete e[t]:e[t]=i},j=function(e,t,n){var o,s=e[t];if("object"==(void 0===s?"undefined":i(s))&&s)if(_.call(s)==k)for(o=s.length;o--;)N(_,B,s);else B(s,(function(e){N(s,e,n)}));return n.call(e,t,s)};t.parse=function(e,t){var n,i;return H=0,z=""+e,n=D(q()),"$"!=q()&&U(),H=z=null,t&&_.call(t)==x?j(((i={})[""]=n,i),"",t):n}}}return t.runInContext=l,t}if(!r||r.global!==r&&r.window!==r&&r.self!==r||(a=r),s)l(a,s);else{var c=a.JSON,d=a.JSON3,u=!1,p=l(a,a.JSON3={noConflict:function(){return u||(u=!0,a.JSON=c,a.JSON3=d,c=d=null),p}});a.JSON={parse:p.parse,stringify:p.stringify}}}).call(void 0)}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={id:i,loaded:!1,exports:{}};return e[i](s,s.exports,n),s.loaded=!0,s.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){"use strict";var e=window.ULObject,t=[];if(e in window&&"q"in window[e])for(var i=0;i<window[e].q.length;i++)t[i]=window[e].q[i];var o=n(300);window[e]=new o;var s=window[e];for(i=0;i<t.length;i++)window[e].push(t[i]);window[e]=function(){return s.push(arguments)},window.ULAIWidget=o}()}();